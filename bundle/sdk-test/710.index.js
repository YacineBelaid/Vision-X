(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[710],{710:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AcceptMessage:()=>P,AcceptObserver:()=>E,ConnectMessage:()=>O,ConnectMessageObserver:()=>S,HandshakeMessage:()=>A,HandshakeObserver:()=>C,IncomingMessageType:()=>w,MP_SDK:()=>f,OutgoingMessageType:()=>p,RejectMessage:()=>D,RejectObserver:()=>I,connect:()=>M,version:()=>k});class n{constructor(e){this.messageReceiver=e}notify(e,t){this.messageReceiver.onMessageReceived(e,t)}}class r{constructor(){this.values={}}add(e,t){this.getValuesAtKey(e).push(t)}remove(e,t){const s=this.values[e];if(s){const e=s.indexOf(t);e>-1&&s.splice(e,1)}}removeKey(e){delete this.values[e]}getValuesAtKey(e){const t=this.values[e]||[];return this.values[e]=t,t}valuesPerKey(e){return this.getValuesAtKey(e).length}find(e,t){return this.values[e]&&this.values[e].find(t)}get keys(){return Object.keys(this.values)}hasKey(e){return e in this.values}has(e,t){return this.hasKey(e)&&this.values[e].includes(t)}*[Symbol.iterator](){for(const e in this.values)for(const t of this.values[e])yield[e,t]}}class i{listen(){}stopListening(){}send(){throw Error("The sdk has been disconnected and can't make any new calls")}}class o{constructor(e,t,s){this.sourceId=e,this.targetId=t,this.messageBridge=s,this.observers=new r}static toFilteredMessenger(e,t,s){const n=new c(e.sourceId,e.targetId,e,t);for(const t of s)for(const s of e.observers.getValuesAtKey(t))n.addObserver(s);return n}init(){const e=new class{constructor(e){this.messenger=e}onMessageReceived(e,t){this.messenger.onMessageReceived(e,t)}}(this),t=new n(e);this.messageBridge.listen(t)}dispose(){this.messageBridge.stopListening(),this.messageBridge=new i}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e){const t=this.sourceId,s=this.targetId;this.messageBridge.send(Object.assign(Object.assign({},e),{fromId:t,toId:s,timestamp:Date.now()}))}onMessageReceived(e,t){if(!this.filterMessageId(e))return;const s=e.type,n=this.observers.getValuesAtKey(s);if(n)for(const s of n){const n=e.payload||e;s.notify(n,t,e.timestamp)}}filterMessageId(e){const t=e.toId,s=e.fromId;return t instanceof Array?t.indexOf(this.sourceId)>-1:(void 0===t||t===this.sourceId)&&s===this.targetId}}class c extends o{constructor(e,t,s,n){super(e,t,new i),this.messenger=s,this.sendFilter=n,this.errorBridge=new i}send(e){this.sendFilter.includes(e.type)?this.messenger.send(e):this.errorBridge.send()}}class a{constructor(e,t){this.sourceId=e,this.listenerBridge=t,this.observers=new r}init(){const e=new class{constructor(e){this.messenger=e}onMessageReceived(e,t){this.messenger.onMessageReceived(e,t)}}(this),t=new n(e);this.listenerBridge.listen(t)}dispose(){this.listenerBridge.stopListening()}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e,t,s,n){s.send(Object.assign(Object.assign({},e),{fromId:this.sourceId,toId:t,timestamp:Date.now()}),n)}onMessageReceived(e,t){const s=e.type,n=this.observers.getValuesAtKey(s);if(n)for(const s of n){const n=e.payload||e;s.notify(n,t,e.timestamp)}}}class h{constructor(e){this.targetWindow=e,this.messageObserver=null,this.onMessage=e=>{if(this.messageObserver){const t=e.data;this.messageObserver.notify(Object.assign({},t),{id:t.fromId,origin:e.origin,source:e.source},e.data.timestamp)}}}listen(e){this.messageObserver||(this.messageObserver=e,this.targetWindow.addEventListener("message",this.onMessage))}stopListening(){this.targetWindow.removeEventListener("message",this.onMessage),this.messageObserver=null}}class d{constructor(e,t="*"){this.targetWindow=e,this.targetOrigin=t}send(e,t){this.targetWindow.postMessage(e,this.targetOrigin)}}class l{constructor(e,t,s="*"){this.sourceWindow=e,this.listener=new h(e),this.sender=new d(t,s)}listen(e){this.listener.listen(e)}stopListening(){this.listener.stopListening()}send(e){this.sender.send(e,this.sourceWindow)}}class u{constructor(e,t,s,n,r="*"){this.sourceId=e,this.sourceWindow=t,this.targetId=s,this.targetWindow=n,this.targetOrigin=r}createMessenger(){const e=new l(this.sourceWindow,this.targetWindow,this.targetOrigin);return new o(this.sourceId,this.targetId,e)}}var g=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};class v{constructor(){this.libraryCache=new Map}load(e,t){const s=this.libraryCache.get(e)||new m(e,t);return this.libraryCache.set(e,s),s.library}}class m{constructor(e,t){this._libraryPromise=new Promise(((e,t)=>{this.libraryResolver=e,this.libraryRejecter=t})),this.fetch(e,t)}fetch(e,t){return g(this,void 0,void 0,(function*(){let s;try{const t=new Request(e),n=new URL(t.url);if(!n.hostname.endsWith(window.location.hostname)&&!n.host.endsWith("matterport.com")&&!n.host.endsWith("matterportvr.cn"))return void this.libraryRejecter(`Request made for ${n.href} does not have the same origin as the request origin ${window.location.origin}`);s=yield fetch(new Request(e,{}))}catch(e){return void this.libraryRejecter(e)}if(!s.ok)return void this.libraryRejecter("Script not found.");const n={},r=yield s.text();if(new Function(r).call(n),t&&t in window){const e=window[t]||{};Object.assign(n,e),delete window[t]}this.libraryResolver(n)}))}get library(){return this._libraryPromise}}var f,p,w,y,b=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};!function(e){const t=new v;e.connect=function(e,s,n){return b(this,void 0,void 0,(function*(){let r;try{r=yield e.connect()}finally{e.cancelConnecting()}const i=yield function(e){return b(this,void 0,void 0,(function*(){if(!e)throw new Error("Unabled to load the sdk");try{const s=yield t.load(e,"sdk-client");if(s&&s.SdkBuilder&&"function"==typeof s.SdkBuilder)return s.SdkBuilder}catch(e){}throw Error(`Could not load the sdk from ${e}`)}))}(r.scriptUrl),o=s.getFactory(r);return function(e,t,s,n){return new t(s,e).build(n)}(n,i,o,r.serializedInterface)}))}}(f||(f={})),function(e){e.CONNECT="postmessage.connect"}(p||(p={})),function(e){e.HANDSHAKE="postmessage.handshake",e.ACCEPT="postmessage.accept",e.REJECT="postmessage.reject"}(w||(w={}));class O{constructor(e,t={}){this.type=p.CONNECT,this.payload={bootstrapVersion:e,options:{auth:t.auth,provider:t.provider,sdkType:t.sdkType}}}}class C{constructor(e){this.receiver=e,this.messageType=w.HANDSHAKE}notify(e,t,s){this.receiver.handshake()}}class E{constructor(e){this.receiver=e,this.messageType=w.ACCEPT}notify(e,t,s){const{sourceId:n,scriptUrl:r,targetId:i,targetOrigin:o}=e,c=e.interface;this.receiver.accept(n,r,c,i,o)}}class I{constructor(e){this.receiver=e,this.messageType=w.REJECT}notify(e,t,s){this.receiver.reject(e.reason)}}!function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.HANDSHAKE=2]="HANDSHAKE",e[e.CONNECTED=3]="CONNECTED",e[e.REJECTED=4]="REJECTED"}(y||(y={}));class N{constructor(e,t,s){this.messenger=e,this.target=t,this.source=s,this.connectionState=y.IDLE,this.connectionPoll=void 0;const n=new class{constructor(e){this.connector=e}handshake(){this.connector.handshake()}accept(e,t,s,n,r){this.connector.accept(e,t,s,n,r)}reject(e){this.connector.reject(e)}}(this);this.handshakeObserver=new C(n),this.acceptObserver=new E(n),this.rejectObserver=new I(n),this.connectionPromise=new Promise(((e,t)=>{this.resolveConnection=e,this.rejectConnection=t}))}connect(e,t={}){return this.connectionState===y.IDLE&&(this.connectionState=y.CONNECTING,this.messenger.addObserver(this.handshakeObserver),this.messenger.addObserver(this.acceptObserver),this.messenger.addObserver(this.rejectObserver),this.connectionPoll=window.setInterval((()=>{this.messenger.send(new O(e,t),-1,this.target,this.source)}),500)),this.connectionPromise}cancelConnecting(){this.connectionState<y.CONNECTED&&(this.stopConnectPolling(),this.rejectConnection("User manually cancelled connection"))}handshake(){this.connectionState<y.HANDSHAKE&&(this.connectionState=y.HANDSHAKE,this.stopConnectPolling(),this.messenger.removeObserver(this.handshakeObserver))}accept(e,t,s,n,r){this.connectionState<y.CONNECTED&&(this.connectionState=y.CONNECTED,this.messenger.removeObserver(this.handshakeObserver),this.messenger.removeObserver(this.acceptObserver),this.messenger.removeObserver(this.rejectObserver),this.stopConnectPolling(),this.resolveConnection({sourceId:e,targetId:n,targetOrigin:r,scriptUrl:t,serializedInterface:s}))}reject(e){this.connectionState<y.CONNECTED&&(this.connectionState=y.REJECTED,this.messenger.removeObserver(this.handshakeObserver),this.messenger.removeObserver(this.acceptObserver),this.messenger.removeObserver(this.rejectObserver),this.stopConnectPolling(),this.rejectConnection(e))}stopConnectPolling(){clearInterval(this.connectionPoll),this.connectionPoll=void 0}}var T=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};const k="3.0";function M(e,t={}){return T(this,void 0,void 0,(function*(){const s=(n=e).contentWindow?n.contentWindow:null;var n;if(!s)return Promise.reject("invalid window");const r=Math.floor(1e6*Math.random()),i=new h(window),o=new d(s),c=new a(r,i);c.init();const l=new N(c,o,window);return f.connect(new R(l,c,t),new j(s),window)}))}class R{constructor(e,t,s){this.connector=e,this.postMessage=t,this.options=s}connect(){return this.connector.connect(k,this.options)}cancelConnecting(){this.postMessage.dispose()}}class j{constructor(e){this.target=e}getFactory(e){return new u(e.sourceId,window,e.targetId,this.target,e.targetOrigin)}}class A{constructor(){this.type=w.HANDSHAKE,this.payload={}}}class P{constructor(e,t,s,n,r){this.type=w.ACCEPT,this.payload={scriptUrl:e,interface:t,sourceId:s,targetId:n,targetOrigin:r},this.interface=t}}class D{constructor(e){this.type=w.REJECT,this.payload={reason:e},this.reason=e}}class S{constructor(e){this.receiver=e,this.messageType=p.CONNECT}notify(e,t){this.receiver.onConnectionReceived(e,t)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9NZXNzZW5nZXIvQnJpZGdlT2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvdXRpbC9EaWN0QXJyYXkvRGljdEFycmF5LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9tZXNzZW5nZXJzL2Vycm9ybWVzc2FnZS9FcnJvck1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvTWVzc2VuZ2VyL01lc3Nlbmdlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9NZXNzZW5nZXIvVW5kaXJlY3RlZE1lc3Nlbmdlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9wb3N0bWVzc2FnZS9VbmRpcmVjdGVkUG9zdE1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvcG9zdG1lc3NhZ2UvUG9zdE1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvcG9zdG1lc3NhZ2UvUG9zdE1lc3NhZ2VGYWN0b3J5LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL2R5bmFtaWMtbGliLWxvYWRlci9EeW5hbWljTGliTG9hZGVyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01QX1NESy50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlVHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvQ29ubmVjdG9yL2luZGV4LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VzL0Nvbm5lY3RNZXNzYWdlLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VPYnNlcnZlcnMvSGFuZHNoYWtlT2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvTWVzc2FnZU9ic2VydmVycy9BY2NlcHRPYnNlcnZlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlT2JzZXJ2ZXJzL1JlamVjdE9ic2VydmVyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9tZXNzZW5nZXJzL01lc3Nlbmdlci9JTWVzc2VuZ2VyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VzL0hhbmRzaGFrZU1lc3NhZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvTWVzc2FnZXMvQWNjZXB0TWVzc2FnZS50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlcy9SZWplY3RNZXNzYWdlLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VPYnNlcnZlcnMvQ29ubmVjdE9ic2VydmVyLnRzIl0sIm5hbWVzIjpbIkJyaWRnZU9ic2VydmVyIiwibWVzc2FnZVJlY2VpdmVyIiwibWVzc2FnZSIsImNsaWVudEluZm8iLCJ0aGlzIiwib25NZXNzYWdlUmVjZWl2ZWQiLCJEaWN0QXJyYXkiLCJ2YWx1ZXMiLCJrZXkiLCJ2YWx1ZSIsImdldFZhbHVlc0F0S2V5IiwicHVzaCIsInZhbHVlc0F0S2V5IiwiaWR4IiwiaW5kZXhPZiIsInNwbGljZSIsImxlbmd0aCIsInZhbEZpbmRlciIsImZpbmQiLCJPYmplY3QiLCJrZXlzIiwidmFsIiwiaGFzS2V5IiwiaW5jbHVkZXMiLCJTeW1ib2wiLCJpdGVyYXRvciIsIkVycm9yTWVzc2FnZUJyaWRnZSIsIkVycm9yIiwic291cmNlSWQiLCJ0YXJnZXRJZCIsIm1lc3NhZ2VCcmlkZ2UiLCJvYnNlcnZlcnMiLCJtZXNzZW5nZXIiLCJzZW5kRmlsdGVyIiwicmVjdkZpbHRlciIsImZpbHRlcmVkTWVzc2VuZ2VyIiwiRmlsdGVyZWRNZXNzZW5nZXIiLCJtc2dUeXBlIiwib2JzZXJ2ZXIiLCJhZGRPYnNlcnZlciIsIm1lc3NlbmdlckZhY2FkZSIsImJyaWRnZU9ic2VydmVyIiwibGlzdGVuIiwic3RvcExpc3RlbmluZyIsIm8iLCJhZGQiLCJtZXNzYWdlVHlwZSIsInJlbW92ZSIsImZyb21JZCIsInRvSWQiLCJzZW5kIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsImZpbHRlck1lc3NhZ2VJZCIsInR5cGUiLCJtZXNzYWdlT2JzZXJ2ZXJzIiwicGF5bG9hZCIsIm5vdGlmeSIsIkFycmF5IiwidW5kZWZpbmVkIiwic3VwZXIiLCJlcnJvckJyaWRnZSIsIlVuZGlyZWN0ZWRNZXNzZW5nZXIiLCJsaXN0ZW5lckJyaWRnZSIsInRhcmdldCIsInNvdXJjZSIsIlBvc3RNZXNzYWdlTGlzdGVuZXIiLCJ0YXJnZXRXaW5kb3ciLCJtZXNzYWdlT2JzZXJ2ZXIiLCJvbk1lc3NhZ2UiLCJldmVudCIsImRhdGEiLCJpZCIsIm9yaWdpbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9zdE1lc3NhZ2VTZW5kZXIiLCJ0YXJnZXRPcmlnaW4iLCJfc291cmNlIiwicG9zdE1lc3NhZ2UiLCJQb3N0TWVzc2FnZUJyaWRnZSIsInNvdXJjZVdpbmRvdyIsImxpc3RlbmVyIiwic2VuZGVyIiwiUG9zdE1lc3NhZ2VGYWN0b3J5IiwicG9zdE1lc3NhZ2VCcmlkZ2UiLCJEeW5hbWljTGliTG9hZGVyIiwibGlicmFyeUNhY2hlIiwiTWFwIiwicGF0aCIsIndpbmRvd0tleSIsInNjcmlwdEZldGNoZXIiLCJnZXQiLCJTY3JpcHRGZXRjaGVyIiwic2V0IiwibGlicmFyeSIsIl9saWJyYXJ5UHJvbWlzZSIsIlByb21pc2UiLCJyZXMiLCJyZWoiLCJsaWJyYXJ5UmVzb2x2ZXIiLCJsaWJyYXJ5UmVqZWN0ZXIiLCJmZXRjaCIsInJlc3BvbnNlIiwicmVxdWVzdCIsIlJlcXVlc3QiLCJyZXF1ZXN0VXJsIiwiVVJMIiwidXJsIiwiaG9zdG5hbWUiLCJlbmRzV2l0aCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdCIsImhyZWYiLCJlIiwib2siLCJsaWIiLCJ0ZXh0IiwiRnVuY3Rpb24iLCJjYWxsIiwibGliT2JqZWN0IiwiYXNzaWduIiwiTVBfU0RLIiwiT3V0Z29pbmdNZXNzYWdlVHlwZSIsIkluY29taW5nTWVzc2FnZVR5cGUiLCJDb25uZWN0aW9uU3RhdGUiLCJsaWJMb2FkZXIiLCJjb25uZWN0IiwiY29ubmVjdG9yIiwiZmFjdG9yeUZldGNoZXIiLCJ3aW5kb3dDb250ZXh0IiwiY29ubmVjdFJlc3BvbnNlIiwiY2FuY2VsQ29ubmVjdGluZyIsImJ1aWxkZXIiLCJzZGtDbGllbnQiLCJsb2FkIiwiU2RrQnVpbGRlciIsImZldGNoU2NyaXB0Iiwic2NyaXB0VXJsIiwibWVzc2VuZ2VyRmFjdG9yeSIsImdldEZhY3RvcnkiLCJzZGtCdWlsZGVyIiwic2VyaWFsaXplZEludGVyZmFjZSIsImJ1aWxkIiwiYnVpbGRJbnRlcmZhY2UiLCJDb25uZWN0TWVzc2FnZSIsImJvb3RzdHJhcFZlcnNpb24iLCJvcHRpb25zIiwiQ09OTkVDVCIsImF1dGgiLCJwcm92aWRlciIsInNka1R5cGUiLCJIYW5kc2hha2VPYnNlcnZlciIsInJlY2VpdmVyIiwiSEFORFNIQUtFIiwiX2hhbmRzaGFrZSIsIl9jbGllbnRJbmZvIiwiX3RpbWVzdGFtcCIsImhhbmRzaGFrZSIsIkFjY2VwdE9ic2VydmVyIiwiQUNDRVBUIiwiYWNjZXB0IiwiaW50ZXJmYWNlIiwiUmVqZWN0T2JzZXJ2ZXIiLCJSRUpFQ1QiLCJyZWplY3QiLCJyZWFzb24iLCJDb25uZWN0b3IiLCJjb25uZWN0aW9uU3RhdGUiLCJJRExFIiwiY29ubmVjdGlvblBvbGwiLCJjb25uZWN0b3JGYWNhZGUiLCJoYW5kc2hha2VPYnNlcnZlciIsImFjY2VwdE9ic2VydmVyIiwicmVqZWN0T2JzZXJ2ZXIiLCJjb25uZWN0aW9uUHJvbWlzZSIsInJlc29sdmVDb25uZWN0aW9uIiwicmVqZWN0Q29ubmVjdGlvbiIsInZlcnNpb24iLCJDT05ORUNUSU5HIiwic2V0SW50ZXJ2YWwiLCJDT05ORUNURUQiLCJzdG9wQ29ubmVjdFBvbGxpbmciLCJyZW1vdmVPYnNlcnZlciIsIlJFSkVDVEVEIiwiY2xlYXJJbnRlcnZhbCIsImVsZW1lbnQiLCJjb250ZW50V2luZG93IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicG9zdE1lc3NhZ2VMaXN0ZW5lciIsInBvc3RNZXNhZ2VTZW5kZXIiLCJpbml0IiwiRW1iZWRDb25uZWN0b3IiLCJFbWJlZE1lc3NlbmdlckZhY3RvcnlGZXRjaGVyIiwiZGlzcG9zZSIsIkhhbmRzaGFrZU1lc3NhZ2UiLCJBY2NlcHRNZXNzYWdlIiwiY2xpZW50SW50ZXJmYWNlIiwiUmVqZWN0TWVzc2FnZSIsIkNvbm5lY3RNZXNzYWdlT2JzZXJ2ZXIiLCJvbkNvbm5lY3Rpb25SZWNlaXZlZCJdLCJtYXBwaW5ncyI6ImtZQVdPLE1BQU1BLEVBQ1gsWUFBb0JDLEdBQUEsS0FBQUEsa0JBQ2IsT0FBT0MsRUFBdUVDLEdBQ25GQyxLQUFLSCxnQkFBZ0JJLGtCQUFrQkgsRUFBU0MsSUNYN0MsTUFBTUcsRUFBYixjQUNVLEtBQUFDLE9BQXVDLEdBUXhDLElBQUlDLEVBQVFDLEdBQ0dMLEtBQUtNLGVBQWVGLEdBQzVCRyxLQUFLRixHQVNaLE9BQU9ELEVBQVFDLEdBQ3BCLE1BQU1HLEVBQWNSLEtBQUtHLE9BQU9DLEdBQ2hDLEdBQUlJLEVBQWEsQ0FDZixNQUFNQyxFQUFNRCxFQUFZRSxRQUFRTCxHQUM1QkksR0FBTyxHQUNURCxFQUFZRyxPQUFPRixFQUFLLElBU3ZCLFVBQVVMLFVBQ1JKLEtBQUtHLE9BQU9DLEdBU2QsZUFBZUEsR0FDcEIsTUFBTUksRUFB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LE9BQU8sSUFBSWhELEVBQW1CZ0QsRUFBZ0J6RyxTQUFVb0YsT0FBUXFCLEVBQWdCeEcsU0FBVXpCLEtBQUs2RCxPQUFRb0UsRUFBZ0J2RCxlQy9DcEgsTUFBTXlILEVBSVgsY0FIZ0IsS0FBQWhKLEtBQU91RSxFQUFvQjhCLFVBSXpDeEosS0FBS3FELFFBQVUsSUNMWixNQUFNK0ksRUFPWCxZQUFZNUQsRUFBbUI2RCxFQUEwQzdLLEVBQWtCQyxFQUFrQmlELEdBTjdGLEtBQUF2QixLQUFPdUUsRUFBb0JvQyxPQU96QzlKLEtBQUtxRCxRQUFVLENBQ2JtRixZQUNBd0IsVUFBV3FDLEVBQ1g3SyxXQUNBQyxXQUNBaUQsZ0JBRUYxRSxLQUFLZ0ssVUFBWXFDLEdDZmQsTUFBTUMsRUFNWCxZQUFZbEMsR0FMSSxLQUFBakgsS0FBT3VFLEVBQW9Cd0MsT0FNekNsSyxLQUFLcUQsUUFBVSxDQUNiK0csVUFFRnBLLEtBQUtvSyxPQUFTQSxHQ0NYLE1BQU1tQyxFQUVYLFlBQW9CaEQsR0FBQSxLQUFBQSxXQURKLEtBQUE3RyxZQUFjK0UsRUFBb0J5QixRQUczQyxPQUFPckIsRUFBeUI5SCxHQUNyQ0MsS0FBS3VKLFNBQVNpRCxxQkFBcUIzRSxFQUFTOUgiLCJmaWxlIjoiNzEwLmluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBJT2JzZXJ2ZXIsIElCcmlkZ2VNZXNzYWdlIH0gZnJvbSAnLi9JTWVzc2VuZ2VyJztcbmltcG9ydCB0eXBlIHsgSW5kZXhLZXkgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IENsaWVudEluZm8gfSBmcm9tICcuLic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NhZ2VSZWNlaXZlcjxJbmNvbWluZ0RhdGFNYXBUPiB7XG4gIG9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbyk6IHZvaWQ7XG59XG5cbi8qKlxuICogQW4gb2JzZXJ2ZXIgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIGJpbmRpbmcgYW4gSU1lc3NlbmdlciB0byBhbiBJTWVzc2VuZ2VyQnJpZGdlXG4gKi9cbmV4cG9ydCBjbGFzcyBCcmlkZ2VPYnNlcnZlcjxJbmNvbWluZ0RhdGFNYXBUPiBpbXBsZW1lbnRzIElPYnNlcnZlcjxbSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBDbGllbnRJbmZvXT4ge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lc3NhZ2VSZWNlaXZlcjogSU1lc3NhZ2VSZWNlaXZlcjxJbmNvbWluZ0RhdGFNYXBUPikgeyB9XG4gIHB1YmxpYyBub3RpZnkobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKTogdm9pZCB7XG4gICAgdGhpcy5tZXNzYWdlUmVjZWl2ZXIub25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZSwgY2xpZW50SW5mbyk7XG4gIH1cbn1cbiIsIi8qKlxuICogQSBkaWN0aW9uYXJ5IGxpa2Ugb2JqZWN0IG9mIGFycmF5c1xuICovXG5leHBvcnQgY2xhc3MgRGljdEFycmF5PEsgZXh0ZW5kcyBzdHJpbmcgfCBudW1iZXIsIFY+IHtcbiAgcHJpdmF0ZSB2YWx1ZXM6IFJlY29yZDxzdHJpbmcgfCBudW1iZXIsIFZbXT4gPSB7fTtcblxuICAvKipcbiAgICogQWRkIGFuIGVudHJ5IHRvIHRoZSBhcnJheSBhdCBga2V5YFxuICAgKlxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKiBAcGFyYW0ge1Z9IHZhbHVlXG4gICAqL1xuICBwdWJsaWMgYWRkKGtleTogSywgdmFsdWU6IFYpOiB2b2lkIHtcbiAgICBjb25zdCB2YWx1ZXNBdEtleSA9IHRoaXMuZ2V0VmFsdWVzQXRLZXkoa2V5KTtcbiAgICB2YWx1ZXNBdEtleS5wdXNoKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYW4gZW50cnkgZnJvbSB0aGUgYXJyYXkgYXQgYGtleWBcbiAgICpcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICogQHBhcmFtIHtWfSB2YWx1ZVxuICAgKi9cbiAgcHVibGljIHJlbW92ZShrZXk6IEssIHZhbHVlOiBWKTogdm9pZCB7XG4gICAgY29uc3QgdmFsdWVzQXRLZXkgPSB0aGlzLnZhbHVlc1trZXldO1xuICAgIGlmICh2YWx1ZXNBdEtleSkge1xuICAgICAgY29uc3QgaWR4ID0gdmFsdWVzQXRLZXkuaW5kZXhPZih2YWx1ZSk7XG4gICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgdmFsdWVzQXRLZXkuc3BsaWNlKGlkeCwgMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbGwgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCBga2V5YFxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKi9cbiAgcHVibGljIHJlbW92ZUtleShrZXk6IEspOiB2b2lkIHtcbiAgICBkZWxldGUgdGhpcy52YWx1ZXNba2V5XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGFycmF5IG9mIHZhbHVlcyBhdCBga2V5YFxuICAgKiBXaWxsIGFsd2F5cyByZXR1cm4gYXQgbGVhc3QgYW4gZW1wdHkgYXJyYXlcbiAgICpcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICovXG4gIHB1YmxpYyBnZXRWYWx1ZXNBdEtleShrZXk6IEspOiBWW10ge1xuICAgIGNvbnN0IHZhbHVlc0F0S2V5ID0gdGhpcy52YWx1ZXNba2V5XSB8fCBbXTtcbiAgICB0aGlzLnZhbHVlc1trZXldID0gdmFsdWVzQXRLZXk7XG4gICAgcmV0dXJuIHZhbHVlc0F0S2V5IGFzIFZbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGNvdW50IG9mIHZhbHVlcyBhdCBga2V5YFxuICAgKlxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKi9cbiAgcHVibGljIHZhbHVlc1BlcktleShrZXk6IEspOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmdldFZhbHVlc0F0S2V5KGtleSkubGVuZ3RoO1xuICB9XG5cbiAgcHVibGljIGZpbmQoa2V5OiBLLCB2YWxGaW5kZXI6ICh2YWw6IFYpID0+IGJvb2xlYW4pOiBWIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZXNba2V5XSAmJiB0aGlzLnZhbHVlc1trZXldLmZpbmQodmFsRmluZGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gaXRlcmF0b3Igb3ZlciB0aGUga2V5cyBpbiB0aGlzIGBEaWN0QXJyYXlgXG4gICAqL1xuICBwdWJsaWMgZ2V0IGtleXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnZhbHVlcyk7XG4gIH1cblxuICAvKipcbiAgICogVGVzdCBpZiBga2V5YCBpcyBpbiB0aGlzIGBEaWN0QXJyYXlgXG4gICAqIEBwYXJhbSB7S30ga2V5XG4gICAqL1xuICBwdWJsaWMgaGFzS2V5KGtleTogSyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBrZXkgaW4gdGhpcy52YWx1ZXM7XG4gIH1cblxuICAvKipcbiAgICogVGVzdCBpZiBhIGtleS12YWx1ZSBwYWlyIGlzIGluIHRoaXMgYERpY3RBcnJheWBcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICogQHBhcmFtIHtWfSB2YWxcbiAgICovXG4gIHB1YmxpYyBoYXMoa2V5OiBLLCB2YWw6IFYpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5oYXNLZXkoa2V5KSAmJiB0aGlzLnZhbHVlc1trZXldLmluY2x1ZGVzKHZhbCk7XG4gIH1cblxuICAvKipcbiAgICogSXRlcmF0ZSBvdmVyIGFsbCB2YWx1ZXMgaW4gdGhpcyBgRGljdEFycmF5YFxuICAgKi9cbiAgcHVibGljICpbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYWJsZUl0ZXJhdG9yPFtzdHJpbmcsIFZdPiB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy52YWx1ZXMpIHtcbiAgICAgIGZvciAoY29uc3QgdmFsIG9mIHRoaXMudmFsdWVzW2tleV0pIHtcbiAgICAgICAgeWllbGQgW2tleSwgdmFsXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckJyaWRnZSB9IGZyb20gJy4uL01lc3Nlbmdlci9JTWVzc2VuZ2VyJztcblxuLyoqXG4gKiBBY3RzIGFzIGEgTWVzc2VuZ2VyQnJpZGdlIGJ1dCB0aHJvd3MgZXJyb3JzIG9uIGFsbCBvdXRnb2luZyBjYWxscyBhbmQgbm8tb3BzIGFueSBpbmNvbWluZyBtZXNzYWdlc1xuICovXG5leHBvcnQgY2xhc3MgRXJyb3JNZXNzYWdlQnJpZGdlIGltcGxlbWVudHMgSU1lc3NlbmdlckJyaWRnZTx1bmtub3duLCB1bmtub3duPiB7XG4gIC8qKlxuICAgKiBOby1vcCBsaXN0ZW5lclxuICAgKi9cbiAgcHVibGljIGxpc3RlbigpOiB2b2lkIHt9XG5cbiAgLyoqXG4gICAqIE5vLW9wIHN0b3AgcmVjZWl2aW5nIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzdG9wTGlzdGVuaW5nKCk6IHZvaWQge31cblxuICAvKipcbiAgICogVGhyb3cgZXJyb3JzIHdoZW4gYXR0ZW1wdGluZyB0byBzZW5kIG1lc3NhZ2VzXG4gICAqL1xuICBwdWJsaWMgc2VuZCgpOiBuZXZlciB7XG4gICAgdGhyb3cgRXJyb3IoJ1RoZSBzZGsgaGFzIGJlZW4gZGlzY29ubmVjdGVkIGFuZCBjYW5cXCd0IG1ha2UgYW55IG5ldyBjYWxscycpO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7XG4gIElNZXNzZW5nZXIsIElNZXNzZW5nZXJCcmlkZ2UsXG4gIElNZXNzYWdlLCBJTWVzc2FnZU9ic2VydmVyLCBJQnJpZGdlTWVzc2FnZSxcbiAgQ2xpZW50SW5mbyxcbn0gZnJvbSAnLi9JTWVzc2VuZ2VyJztcbmltcG9ydCB7IEJyaWRnZU9ic2VydmVyIH0gZnJvbSAnLi9CcmlkZ2VPYnNlcnZlcic7XG5pbXBvcnQgeyBEaWN0QXJyYXkgfSBmcm9tICdAbXAvdXRpbC1kaWN0YXJyYXknO1xuaW1wb3J0IHR5cGUgeyBJbmRleEtleSB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IEVycm9yTWVzc2FnZUJyaWRnZSB9IGZyb20gJy4uL2Vycm9ybWVzc2FnZS9FcnJvck1lc3NhZ2VCcmlkZ2UnO1xuXG4vKipcbiAqIEEgYmktZGlyZWN0aW9uYWwgY29tbXVuaWNhdG9yIHRoYXQgY2FuXG4gKiAtIHJlY2VpdmUgbWVzc2FnZSBvZiB0eXBlIGBrZXlvZiBJbmNvbWluZ0RhdGFNYXBUYCB2aWEgb2JzZXJ2ZXJzXG4gKiAtIHNlbmQgbWVzc2FnZXMgb2YgdHlwZSBga2V5b2YgT3V0Z29pbmdEYXRhTWFwVGBcbiAqIC0gZmlsdGVycyBpbmNvbWluZyBtZXNzYWdlcyBiYXNlZCBvbiB0aGUgaWQgb2YgdGhlIGNsaWVudCBhbmQgdGhlIG1lc3NhZ2UncyB0YXJnZXRcbiAqXG4gKiBUaGUgdW5kZXJseWluZyBjb21tdW5pY2F0aW9uIG1lY2hhbmlzbXMgYXJlIGRlZmluZWQgYnkgYW4gSU1lc3NlbmdlckJyaWRnZSBwcm92aWRlZCBieSB0aGUgY3JlYXRvclxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXNzZW5nZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFQsXG4+IGltcGxlbWVudHMgSU1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiB7XG5cbiAgcHJpdmF0ZSBvYnNlcnZlcnM6IERpY3RBcnJheTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4+ID0gbmV3IERpY3RBcnJheSgpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc291cmNlSWQ6IG51bWJlciwgcHJpdmF0ZSB0YXJnZXRJZDogbnVtYmVyLCBwcml2YXRlIG1lc3NhZ2VCcmlkZ2U6IElNZXNzZW5nZXJCcmlkZ2U8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4pIHsgfVxuXG4gIC8qKlxuICAgKiBDbG9uZSB0aGlzIE1lc3NlbmdlciBhcyBhbiBJTWVzc2VuZ2VyIHRoYXQgd2lsbCBvbmx5IHNlbmQgYW5kIHJlY2VpdmUgY2VydGFpbiB0eXBlcyBvZiBtZXNzYWdlc1xuICAgKiBAcGFyYW0gbWVzc2VuZ2VyXG4gICAqIEBwYXJhbSBzZW5kRmlsdGVyXG4gICAqIEBwYXJhbSByZWN2RmlsdGVyXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHRvRmlsdGVyZWRNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4oXG4gICAgbWVzc2VuZ2VyOiBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sXG4gICAgc2VuZEZpbHRlcjogQXJyYXk8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4+LFxuICAgIHJlY3ZGaWx0ZXI6IEFycmF5PEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+PixcbiAgKTogSU1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiB7XG4gICAgY29uc3QgZmlsdGVyZWRNZXNzZW5nZXIgPSBuZXcgRmlsdGVyZWRNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4obWVzc2VuZ2VyLnNvdXJjZUlkLCBtZXNzZW5nZXIudGFyZ2V0SWQsIG1lc3Nlbmdlciwgc2VuZEZpbHRlcik7XG4gICAgZm9yIChjb25zdCBtc2dUeXBlIG9mIHJlY3ZGaWx0ZXIpIHtcbiAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgbWVzc2VuZ2VyLm9ic2VydmVycy5nZXRWYWx1ZXNBdEtleShtc2dUeXBlKSkge1xuICAgICAgICBmaWx0ZXJlZE1lc3Nlbmdlci5hZGRPYnNlcnZlcihvYnNlcnZlcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlcmVkTWVzc2VuZ2VyO1xuICB9XG4gIC8qKlxuICAgKiBTdGFydCBsaXN0ZW5pbmcgZm9yIGFueSBpbmNvbWluZyBtZXNzYWdlcyB2aWEgdGhlIGBtZXNzYWdlQnJpZGdlYFxuICAgKi9cbiAgcHVibGljIGluaXQoKTogdm9pZCB7XG4gICAgY2xhc3MgTWVzc2VuZ2VyRmFjYWRlIHtcbiAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVzc2VuZ2VyOiBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4pIHt9XG4gICAgICBwdWJsaWMgb25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKSB7XG4gICAgICAgIHRoaXMubWVzc2VuZ2VyLm9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2UsIGNsaWVudEluZm8pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NlbmdlckZhY2FkZSA9IG5ldyBNZXNzZW5nZXJGYWNhZGUodGhpcyk7XG4gICAgY29uc3QgYnJpZGdlT2JzZXJ2ZXIgPSBuZXcgQnJpZGdlT2JzZXJ2ZXIobWVzc2VuZ2VyRmFjYWRlKTtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2UubGlzdGVuKGJyaWRnZU9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGxpc3RlbmluZyBmb3IgbWVzc2FnZXMgYW5kIGNsZWFuIHVwIHRoaXMgTWVzc2VuZ2VyXG4gICAqL1xuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2Uuc3RvcExpc3RlbmluZygpO1xuICAgIHRoaXMubWVzc2FnZUJyaWRnZSA9IG5ldyBFcnJvck1lc3NhZ2VCcmlkZ2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnNlcnZlIGluY29taW5nIG1lc3NhZ2VzXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIGFkZE9ic2VydmVyKG86IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgdGhpcy5vYnNlcnZlcnMuYWRkKG8ubWVzc2FnZVR5cGUsIG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgYW4gb2JzZXJ2ZXIgZnJvbSByZWNlaXZpbmcgbWVzc2FnZXNcbiAgICpcbiAgICogQHBhcmFtIG9ic2VydmVyXG4gICAqL1xuICBwdWJsaWMgcmVtb3ZlT2JzZXJ2ZXIobzogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICB0aGlzLm9ic2VydmVycy5yZW1vdmUoby5tZXNzYWdlVHlwZSwgbyk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhIGBtZXNzYWdlYCB0byB0aGUgYHRhcmdldGAgb2YgdGhlIGBJTWVzc2VuZ2VyQnJpZGdlYFxuICAgKlxuICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgKi9cbiAgcHVibGljIHNlbmQobWVzc2FnZTogSU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgY29uc3QgZnJvbUlkID0gdGhpcy5zb3VyY2VJZDtcbiAgICBjb25zdCB0b0lkID0gdGhpcy50YXJnZXRJZDtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2Uuc2VuZCh7XG4gICAgICAuLi5tZXNzYWdlLFxuICAgICAgZnJvbUlkLFxuICAgICAgdG9JZCxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOb3RpZnkgYWxsIG9ic2VydmVycyBvZiBgbWVzc2FnZS50eXBlYCBvZiB0aGUgaW5jb21pbmcgYG1lc3NhZ2VgIGFmdGVyIGFueSBmaWx0ZXJpbmcgb3V0IG1lc3NhZ2VzIG5vdCBtZWFudCBmb3IgdGhpcyBNZXNzZW5nZXJcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHByaXZhdGUgb25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKSB7XG4gICAgaWYgKCF0aGlzLmZpbHRlck1lc3NhZ2VJZChtZXNzYWdlKSkgcmV0dXJuO1xuXG4gICAgY29uc3QgbWVzc2FnZVR5cGUgPSBtZXNzYWdlLnR5cGU7XG4gICAgY29uc3QgbWVzc2FnZU9ic2VydmVycyA9IHRoaXMub2JzZXJ2ZXJzLmdldFZhbHVlc0F0S2V5KG1lc3NhZ2VUeXBlKTtcbiAgICBpZiAobWVzc2FnZU9ic2VydmVycykge1xuICAgICAgZm9yIChjb25zdCBvYnNlcnZlciBvZiBtZXNzYWdlT2JzZXJ2ZXJzKSB7XG4gICAgICAgIC8vIFRPRE8gKHNkayAxLnggc3VwcG9ydCk6IFNESyBib290c3RyYXAgMS54IHB1dCB0aGUgcGF5bG9hZCBhdCB0aGUgcm9vdCBvZiB0aGUgbWVzc2FnZSwgbm90IHVuZGVyIHRoZSBgcGF5bG9hZGAgcHJvcGVydHlcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IG1lc3NhZ2UucGF5bG9hZCB8fCBtZXNzYWdlIGFzIHVua25vd24gYXMgSW5jb21pbmdEYXRhTWFwVFtFeGNsdWRlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIHN5bWJvbD5dO1xuICAgICAgICBvYnNlcnZlci5ub3RpZnkocGF5bG9hZCwgY2xpZW50SW5mbywgbWVzc2FnZS50aW1lc3RhbXApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgd2hldGhlciBgbWVzc2FnZWAgaXMgbWVhbnQgZm9yIHRoaXMgTWVzc2VuZ2VyIGFuZCBjb21lcyBmcm9tIGEga25vd24gdGFyZ2V0XG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqL1xuICBwcml2YXRlIGZpbHRlck1lc3NhZ2VJZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiBib29sZWFuIHtcbiAgICBjb25zdCB0b0lkID0gbWVzc2FnZS50b0lkO1xuICAgIGNvbnN0IGZyb21JZCA9IG1lc3NhZ2UuZnJvbUlkO1xuICAgIGlmICh0b0lkIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgIHJldHVybiB0b0lkLmluZGV4T2YodGhpcy5zb3VyY2VJZCkgPiAtMTtcbiAgICB9XG5cbiAgICAvLyBUT0RPIChzZGsgMS54IHN1cHBvcnQpOiBTREsgYm9vdHN0cmFwIDEueCBoYWQgYHRvSWRgIGFzIHVuZGVmaW5lZCBmb3IgbWVzc2FnZXNcbiAgICByZXR1cm4gKHRvSWQgPT09IHVuZGVmaW5lZCB8fCB0b0lkID09PSB0aGlzLnNvdXJjZUlkKSAmJiBmcm9tSWQgPT09IHRoaXMudGFyZ2V0SWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBBIGRlY29yYXRlZCBJTWVzc2VuZ2VyIHRoYXQgb25seSBzZW5kcyBtZXNzYWdlcyBmcm9tIGEgcHJlZGVmaW5lZCBzZXQgb2YgbWVzc2FnZSB0eXBlcyBhbmQgZXJyb3JzIG9uIG90aGVycy5cbiAqL1xuY2xhc3MgRmlsdGVyZWRNZXNzZW5nZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFRcbj4gZXh0ZW5kcyBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICBwcml2YXRlIGVycm9yQnJpZGdlOiBFcnJvck1lc3NhZ2VCcmlkZ2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgc291cmNlSWQ6IG51bWJlcixcbiAgICB0YXJnZXRJZDogbnVtYmVyLFxuICAgIHByaXZhdGUgbWVzc2VuZ2VyOiBJTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+LFxuICAgIHByaXZhdGUgc2VuZEZpbHRlcjogQXJyYXk8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4+LFxuICApIHtcbiAgICAvLyBUT0RPIChAbXAvc2RrKTogc29tZXRoaW5nIGFib3V0IHRoZSB0c2NvbmZpZyBpbiBAbXAvc2RrIHJlcXVpcmVzIGBzdXBlcmAgdG8gYmUgY2FsbGVkIGZpcnN0IHNvIHRoZSBgbmV3IEVycm9yTWVzc2FnZUJyaWRnZWAgY2FuJ3QgYmUgc2hhcmVkXG4gICAgc3VwZXIoc291cmNlSWQsIHRhcmdldElkLCBuZXcgRXJyb3JNZXNzYWdlQnJpZGdlKCkpO1xuICAgIHRoaXMuZXJyb3JCcmlkZ2UgPSBuZXcgRXJyb3JNZXNzYWdlQnJpZGdlKCk7XG4gIH1cblxuICBwdWJsaWMgc2VuZChtZXNzYWdlOiBJTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zZW5kRmlsdGVyLmluY2x1ZGVzKG1lc3NhZ2UudHlwZSkpIHtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLnNlbmQobWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZXJyb3JCcmlkZ2Uuc2VuZCgpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUge1xuICBJVW5kaXJlY3RlZE1lc3NlbmdlciwgSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lciwgSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXIsXG4gIElNZXNzYWdlLCBJTWVzc2FnZU9ic2VydmVyLCBJQnJpZGdlTWVzc2FnZSxcbiAgQ2xpZW50SW5mbyxcbn0gZnJvbSAnLi9JTWVzc2VuZ2VyJztcbmltcG9ydCB7IEJyaWRnZU9ic2VydmVyIH0gZnJvbSAnLi9CcmlkZ2VPYnNlcnZlcic7XG5pbXBvcnQgeyBEaWN0QXJyYXkgfSBmcm9tICdAbXAvdXRpbC1kaWN0YXJyYXknO1xuaW1wb3J0IHR5cGUgeyBJbmRleEtleSB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqXG4gKiBBIGJpLWRpcmVjdGlvbmFsIGNvbW11bmljYXRvciB0aGF0IGNhblxuICogLSBvcGVubHkgcmVjZWl2ZSBtZXNzYWdlcyBvZiB0eXBlIGBrZXlvZiBJbmNvbWluZ0RhdGFNYXBUYCB2aWEgb2JzZXJ2ZXJzIGZyb20gdW5zcGVjaWZpZWQgc291cmNlc1xuICogLSBzZW5kIG1lc3NhZ2VzIG9mIHR5cGUgYGtleW9mIE91dGdvaW5nRGF0YU1hcFRgIHRvIHRhcmdldHMgc3BlY2lmaWVkIHdoZW4gc2VuZGluZ1xuICpcbiAqICoqRGlmZmVycyBmcm9tIGEgc3RhbmRhcmQgYElNZXNzZW5nZXJgIGluIHRoYXQgaXQgZG9lc24ndCBrbm93IGl0J3MgY29tbXVuaWNhdGlvbiB0YXJnZXQgYXQgY29uc3RydWN0aW9uIHRpbWUqKlxuICpcbiAqIFRoZSB1bmRlcmx5aW5nIGNvbW11bmljYXRpb24gbWVjaGFuaXNtcyBhcmUgZGVmaW5lZCBieSBhbiBgSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lcmAgcHJvdmlkZWQgaW4gdGhlIGNvbnN0cnVjdG9yXG4gKiBhbmQgYnkgdGhlIGBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcmAgcHJvdmlkZWQgaW4gc2VuZFxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBVbmRpcmVjdGVkTWVzc2VuZ2VyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuICBTb3VyY2VULFxuPiBpbXBsZW1lbnRzIElVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQsIFNvdXJjZVQ+IHtcblxuICBwcml2YXRlIG9ic2VydmVyczogRGljdEFycmF5PEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPj4gPSBuZXcgRGljdEFycmF5KCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzb3VyY2VJZDogbnVtYmVyLCBwcml2YXRlIGxpc3RlbmVyQnJpZGdlOiBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPEluY29taW5nRGF0YU1hcFQ+KSB7IH1cblxuICAvKipcbiAgICogU3RhcnQgbGlzdGVuaW5nIGZvciBhbnkgaW5jb21pbmcgbWVzc2FnZXMgdmlhIHRoZSBgbGlzdGVuZXJCcmlkZ2VgXG4gICAqL1xuICBwdWJsaWMgaW5pdCgpOiB2b2lkIHtcbiAgICBjbGFzcyBVbmRpcmVjdGVkRmFjYWRlIHtcbiAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVzc2VuZ2VyOiBVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQsIFNvdXJjZVQ+KSB7fVxuICAgICAgcHVibGljIG9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbykge1xuICAgICAgICB0aGlzLm1lc3Nlbmdlci5vbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlLCBjbGllbnRJbmZvKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBtZXNzZW5nZXJGYWNhZGUgPSBuZXcgVW5kaXJlY3RlZEZhY2FkZSh0aGlzKTtcbiAgICBjb25zdCBicmlkZ2VPYnNlcnZlciA9IG5ldyBCcmlkZ2VPYnNlcnZlcihtZXNzZW5nZXJGYWNhZGUpO1xuICAgIHRoaXMubGlzdGVuZXJCcmlkZ2UubGlzdGVuKGJyaWRnZU9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGxpc3RlbmluZyBmb3IgbWVzc2FnZXMgYW5kIGNsZWFuIHVwIHRoaXMgVW5kaXJlY3RlZE1lc3NlbmdlclxuICAgKi9cbiAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lckJyaWRnZS5zdG9wTGlzdGVuaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogT2JzZXJ2ZSBpbmNvbWluZyBtZXNzYWdlc1xuICAgKlxuICAgKiBAcGFyYW0gb2JzZXJ2ZXJcbiAgICovXG4gIHB1YmxpYyBhZGRPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICB0aGlzLm9ic2VydmVycy5hZGQob2JzZXJ2ZXIubWVzc2FnZVR5cGUsIG9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGFuIG9ic2VydmVyIGZyb20gcmVjZWl2aW5nIG1lc3NhZ2VzXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIHJlbW92ZU9ic2VydmVyKG9ic2VydmVyOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQge1xuICAgIHRoaXMub2JzZXJ2ZXJzLnJlbW92ZShvYnNlcnZlci5tZXNzYWdlVHlwZSwgb2JzZXJ2ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgYSBgbWVzc2FnZWAgdG8gdGhlIGB0YXJnZXRgXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqIEBwYXJhbSB0YXJnZXRJZFxuICAgKiBAcGFyYW0gdGFyZ2V0XG4gICAqL1xuICBwdWJsaWMgc2VuZChcbiAgICBtZXNzYWdlOiBJTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4sXG4gICAgdGFyZ2V0SWQ6IG51bWJlcixcbiAgICB0YXJnZXQ6IElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPE91dGdvaW5nRGF0YU1hcFQsIHVua25vd24+LFxuICAgIHNvdXJjZTogU291cmNlVCxcbiAgKTogdm9pZCB7XG4gICAgdGFyZ2V0LnNlbmQoe1xuICAgICAgLi4ubWVzc2FnZSxcbiAgICAgIGZyb21JZDogdGhpcy5zb3VyY2VJZCxcbiAgICAgIHRvSWQ6IHRhcmdldElkLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICAvKipcbiAgICogTm90aWZ5IGFsbCBvYnNlcnZlcnMgb2YgYG1lc3NhZ2UudHlwZWAgb2YgdGhlIGluY29taW5nIGBtZXNzYWdlYFxuICAgKlxuICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgKi9cbiAgcHJpdmF0ZSBvbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4sIGNsaWVudEluZm86IENsaWVudEluZm8pOiB2b2lkIHtcbiAgICBjb25zdCBtZXNzYWdlVHlwZSA9IG1lc3NhZ2UudHlwZTtcbiAgICBjb25zdCBtZXNzYWdlT2JzZXJ2ZXJzID0gdGhpcy5vYnNlcnZlcnMuZ2V0VmFsdWVzQXRLZXkobWVzc2FnZVR5cGUpO1xuICAgIGlmIChtZXNzYWdlT2JzZXJ2ZXJzKSB7XG4gICAgICBmb3IgKGNvbnN0IG9ic2VydmVyIG9mIG1lc3NhZ2VPYnNlcnZlcnMpIHtcbiAgICAgICAgLy8gVE9ETyAoc2RrIDEueCBzdXBwb3J0KTogU0RLIEJvb3N0cmFwIDEueCBwdXQgdGhlIHBheWxvYWQgYXQgdGhlIHJvb3Qgb2YgdGhlIG1lc3NhZ2VcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IG1lc3NhZ2UucGF5bG9hZCB8fCBtZXNzYWdlIGFzIHVua25vd24gYXMgSW5jb21pbmdEYXRhTWFwVFtFeGNsdWRlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIHN5bWJvbD5dO1xuICAgICAgICBvYnNlcnZlci5ub3RpZnkocGF5bG9hZCwgY2xpZW50SW5mbywgbWVzc2FnZS50aW1lc3RhbXApO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBQb3N0TWVzc2FnZUNsaWVudEluZm8gfSBmcm9tICcuL1Bvc3RNZXNzYWdlQ2xpZW50SW5mbyc7XG5pbXBvcnQgdHlwZSB7IElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyLCBJT2JzZXJ2ZXIsIElCcmlkZ2VNZXNzYWdlLCBJTWVzc2FnZSB9IGZyb20gJy4uL01lc3Nlbmdlci9JTWVzc2VuZ2VyJztcblxuLyoqXG4gKiBCcmlkZ2VzIGFuZCBhYnN0cmFjdHMgYSB3aW5kb3cgYW5kIGl0cyBhZGRFdmVudExpc3RlbmVyIGZ1bmN0aW9uIHRvIHJlY2VpdmUgYG1lc3NhZ2VgIGV2ZW50c1xuICpcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgY2xhc3MgUG9zdE1lc3NhZ2VMaXN0ZW5lcjxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbj4gaW1wbGVtZW50cyBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPEluY29taW5nRGF0YU1hcFQ+IHtcbiAgcHJpdmF0ZSBtZXNzYWdlT2JzZXJ2ZXI6IElPYnNlcnZlcjxbSU1lc3NhZ2U8a2V5b2YgSW5jb21pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sIFBvc3RNZXNzYWdlQ2xpZW50SW5mbywgbnVtYmVyXT4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBvbk1lc3NhZ2U6IChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdGFyZ2V0V2luZG93OiBXaW5kb3cpIHtcbiAgICAvLyBzZXQgdXAgYSBjYWxsYmFjayB0byB1c2UgaW4gYHdpbmRvdy5hZGRFdmVudExpc3RlbmVyYCB0aGF0IHdpbGwgdHJpZ2dlciB0aGUgcmVnaXN0ZXJlZCBvYnNlcnZlcnNcbiAgICB0aGlzLm9uTWVzc2FnZSA9IChldmVudDogTWVzc2FnZUV2ZW50PElCcmlkZ2VNZXNzYWdlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+PikgPT4ge1xuICAgICAgaWYgKHRoaXMubWVzc2FnZU9ic2VydmVyKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBldmVudC5kYXRhO1xuICAgICAgICB0aGlzLm1lc3NhZ2VPYnNlcnZlci5ub3RpZnkoe1xuICAgICAgICAgIC8vIFRoaXMgc3ByZWFkIGlzIGtlcHQgZm9yIGJhY2t3YXJkIGNvbXBhdGlsaXR5IHdpdGggbWVzc2VuZ2VycyBjb21waWxlZCBpbnRvIG9sZGVyIHNkayBib290c3RyYXBzLi4uIHN1Y2tzXG4gICAgICAgICAgLi4ubWVzc2FnZSxcbiAgICAgICAgfSwge1xuICAgICAgICAgIGlkOiBtZXNzYWdlLmZyb21JZCxcbiAgICAgICAgICBvcmlnaW46IGV2ZW50Lm9yaWdpbixcbiAgICAgICAgICBzb3VyY2U6IGV2ZW50LnNvdXJjZSBhcyBXaW5kb3csXG4gICAgICAgIH0sIGV2ZW50LmRhdGEudGltZXN0YW1wKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHJlY2VpdmluZyBtZXNzYWdlIGV2ZW50cyBmcm9tIHBvc3RNZXNzYWdlXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIGxpc3RlbihvYnNlcnZlcjogSU9ic2VydmVyPFtJTWVzc2FnZTxrZXlvZiBJbmNvbWluZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiwgUG9zdE1lc3NhZ2VDbGllbnRJbmZvXT4pOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMubWVzc2FnZU9ic2VydmVyKSB7XG4gICAgICB0aGlzLm1lc3NhZ2VPYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy50YXJnZXRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25NZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3RvcCByZWNlaXZpbmcgbWVzc2FnZSBldmVudHMgZnJvbSBwb3N0TWVzc2FnZVxuICAgKi9cbiAgcHVibGljIHN0b3BMaXN0ZW5pbmcoKTogdm9pZCB7XG4gICAgdGhpcy50YXJnZXRXaW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25NZXNzYWdlKTtcbiAgICB0aGlzLm1lc3NhZ2VPYnNlcnZlciA9IG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBCcmlkZ2VzIGFuZCBhYnN0cmFjdHMgYSB3aW5kb3cgYW5kIGl0cyBwb3N0TWVzc2FnZSBmdW5jdGlvbiB0byBzZW5kIG1lc3NhZ2VzXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBjbGFzcyBQb3N0TWVzc2FnZVNlbmRlcjxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbj4gaW1wbGVtZW50cyBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcjxPdXRnb2luZ0RhdGFNYXBULCBXaW5kb3c+IHtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRhcmdldFdpbmRvdzogV2luZG93LCBwcml2YXRlIHRhcmdldE9yaWdpbjogc3RyaW5nID0gJyonKSB7IH1cblxuICAvKipcbiAgICogU2VuZCBhIG1lc3NhZ2Ugb3ZlciBwb3N0TWVzc2FnZSB0byB0aGUgYHRhcmdldFdpbmRvd2BcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzZW5kKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPGtleW9mIE91dGdvaW5nRGF0YU1hcFQsIE91dGdvaW5nRGF0YU1hcFQ+LCBfc291cmNlOiBXaW5kb3cpOiB2b2lkIHtcbiAgICB0aGlzLnRhcmdldFdpbmRvdy5wb3N0TWVzc2FnZShtZXNzYWdlLCB0aGlzLnRhcmdldE9yaWdpbik7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckJyaWRnZSwgSU1lc3NhZ2UsIElPYnNlcnZlciwgSUJyaWRnZU1lc3NhZ2UsIElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyIH0gZnJvbSAnLi4vTWVzc2VuZ2VyL0lNZXNzZW5nZXInO1xuaW1wb3J0IHsgUG9zdE1lc3NhZ2VMaXN0ZW5lciwgUG9zdE1lc3NhZ2VTZW5kZXIgfSBmcm9tICcuL1VuZGlyZWN0ZWRQb3N0TWVzc2FnZUJyaWRnZSc7XG5pbXBvcnQgdHlwZSB7IEluZGV4S2V5IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEJyaWRnZXMgYW5kIHNldHMgdXAgYSBkaXJlY3QgY2hhbm5lbCBiZXR3ZWVuIHR3byBXaW5kb3dzIHVzaW5nIHBvc3RNZXNzYWdlXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGNsYXNzIFBvc3RNZXNzYWdlQnJpZGdlPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuPiBpbXBsZW1lbnRzIElNZXNzZW5nZXJCcmlkZ2U8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICBwcml2YXRlIGxpc3RlbmVyOiBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPEluY29taW5nRGF0YU1hcFQ+O1xuICBwcml2YXRlIHNlbmRlcjogSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXI8T3V0Z29pbmdEYXRhTWFwVCwgV2luZG93PjtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvdXJjZVdpbmRvdzogV2luZG93LCB0YXJnZXRXaW5kb3c6IFdpbmRvdywgdGFyZ2V0T3JpZ2luOiBzdHJpbmcgPSAnKicpIHtcbiAgICB0aGlzLmxpc3RlbmVyID0gbmV3IFBvc3RNZXNzYWdlTGlzdGVuZXIoc291cmNlV2luZG93KTtcbiAgICB0aGlzLnNlbmRlciA9IG5ldyBQb3N0TWVzc2FnZVNlbmRlcih0YXJnZXRXaW5kb3csIHRhcmdldE9yaWdpbik7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgcmVjZWl2aW5nIG1lc3NhZ2UgZXZlbnRzIGZyb20gcG9zdE1lc3NhZ2VcbiAgICpcbiAgICogQHBhcmFtIG9ic2VydmVyXG4gICAqL1xuICBwdWJsaWMgbGlzdGVuKG9ic2VydmVyOiBJT2JzZXJ2ZXI8W0lNZXNzYWdlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+XT4pOiB2b2lkIHtcbiAgICB0aGlzLmxpc3RlbmVyLmxpc3RlbihvYnNlcnZlcik7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCByZWNlaXZpbmcgbWVzc2FnZSBldmVudHMgZnJvbSBwb3N0TWVzc2FnZVxuICAgKi9cbiAgcHVibGljIHN0b3BMaXN0ZW5pbmcoKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lci5zdG9wTGlzdGVuaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhIG1lc3NhZ2Ugb3ZlciBwb3N0TWVzc2FnZSB0byB0aGUgYHRhcmdldFdpbmRvd2BcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzZW5kKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPik6IHZvaWQge1xuICAgIHRoaXMuc2VuZGVyLnNlbmQobWVzc2FnZSwgdGhpcy5zb3VyY2VXaW5kb3cpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBNZXNzZW5nZXIgfSBmcm9tICcuLi9NZXNzZW5nZXIvTWVzc2VuZ2VyJztcbmltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckZhY3RvcnksIElNZXNzZW5nZXIgfSBmcm9tICcuLi9NZXNzZW5nZXIvSU1lc3Nlbmdlcic7XG5pbXBvcnQgeyBQb3N0TWVzc2FnZUJyaWRnZSB9IGZyb20gJy4vUG9zdE1lc3NhZ2VCcmlkZ2UnO1xuXG4vKipcbiAqIEEgc2ltcGxlIGZhY3RvcnkgdG8gY3JlYXRlIFBvc3RNZXNzYWdlIHRvIGhpZGUgYXdheSB0aGUgZGV0YWlscyBvZiBpZHMgYW5kIHNvdXJjZS9hcmdldCBXaW5kb3cgaW5mb3JtYXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIFBvc3RNZXNzYWdlRmFjdG9yeTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiBpbXBsZW1lbnRzIElNZXNzZW5nZXJGYWN0b3J5PE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+ICB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc291cmNlSWQ6IG51bWJlciwgcHJpdmF0ZSBzb3VyY2VXaW5kb3c6IFdpbmRvdyxcbiAgICBwcml2YXRlIHRhcmdldElkOiBudW1iZXIsIHByaXZhdGUgdGFyZ2V0V2luZG93OiBXaW5kb3csIHByaXZhdGUgdGFyZ2V0T3JpZ2luOiBzdHJpbmcgPSAnKicpIHsgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBQb3N0TWVzc2FnZSBjaGFubmVsXG4gICAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSB0aGUgbmV3bHkgY3JlYXRlZCBJTWVzc2VuZ2VyXG4gICAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSB0aGUgbmV3bHkgY3JlYXRlZCBJTWVzc2VuZ2VyXG4gICAqL1xuICBwdWJsaWMgY3JlYXRlTWVzc2VuZ2VyKCk6IElNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICAgIGNvbnN0IHBvc3RNZXNzYWdlQnJpZGdlID0gbmV3IFBvc3RNZXNzYWdlQnJpZGdlPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KHRoaXMuc291cmNlV2luZG93LCB0aGlzLnRhcmdldFdpbmRvdywgdGhpcy50YXJnZXRPcmlnaW4pO1xuICAgIGNvbnN0IG1lc3NlbmdlciA9IG5ldyBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4odGhpcy5zb3VyY2VJZCwgdGhpcy50YXJnZXRJZCwgcG9zdE1lc3NhZ2VCcmlkZ2UpO1xuICAgIHJldHVybiBtZXNzZW5nZXI7XG4gIH1cbn1cbiIsIi8qKlxyXG4gKiBBIGxvYWRlciBmb3IgZmV0Y2hpbmcgcmVtb3RlIHNjcmlwdHNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBEeW5hbWljTGliTG9hZGVyIHtcclxuICBwcml2YXRlIGxpYnJhcnlDYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBTY3JpcHRGZXRjaGVyPHVua25vd24+PigpO1xyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhIGxpYnJhcnkgZnJvbSBgcGF0aGBcclxuICAgKlxyXG4gICAqIEBwYXJhbSBwYXRoXHJcbiAgICogQHBhcmFtIHdpbmRvd0tleSBJZiBXZWJwYWNrIGJ1aWx0IHRoZSBsaWJyYXJ5IHVzaW5nIGBsaWJyYXJ5VGFyZ2V0OiAnd2luZG93J2AsIHRoaXMgaXMgdGhlIGBsaWJyYXJ5YCBwYXJhbSBpbiB0aGUgd2VicGFjayBjb25maWdcclxuICAgKi9cclxuICBwdWJsaWMgbG9hZDxUPihwYXRoOiBzdHJpbmcsIHdpbmRvd0tleT86IHN0cmluZyk6IFByb21pc2U8VD4ge1xyXG4gICAgY29uc3Qgc2NyaXB0RmV0Y2hlciA9IHRoaXMubGlicmFyeUNhY2hlLmdldChwYXRoKSBhcyBTY3JpcHRGZXRjaGVyPFQ+IHx8IG5ldyBTY3JpcHRGZXRjaGVyPFQ+KHBhdGgsIHdpbmRvd0tleSk7XHJcbiAgICB0aGlzLmxpYnJhcnlDYWNoZS5zZXQocGF0aCwgc2NyaXB0RmV0Y2hlcik7XHJcblxyXG4gICAgcmV0dXJuIHNjcmlwdEZldGNoZXIubGlicmFyeTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGZXRjaGVzIGEgc2NyaXB0XHJcbiAqL1xyXG5jbGFzcyBTY3JpcHRGZXRjaGVyPFQ+IHtcclxuICBwcml2YXRlIGxpYnJhcnlSZXNvbHZlciE6IChsaWI6IFQpID0+IHZvaWQ7XHJcbiAgcHJpdmF0ZSBsaWJyYXJ5UmVqZWN0ZXIhOiAoZXJyOiBzdHJpbmcpID0+IHZvaWQ7XHJcbiAgcHJpdmF0ZSBfbGlicmFyeVByb21pc2U6IFByb21pc2U8VD47XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBhdGg6IHN0cmluZywgd2luZG93S2V5Pzogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl9saWJyYXJ5UHJvbWlzZSA9IG5ldyBQcm9taXNlPFQ+KChyZXMsIHJlaikgPT4ge1xyXG4gICAgICB0aGlzLmxpYnJhcnlSZXNvbHZlciA9IHJlcztcclxuICAgICAgdGhpcy5saWJyYXJ5UmVqZWN0ZXIgPSByZWo7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuZmV0Y2gocGF0aCwgd2luZG93S2V5KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2gocGF0aDogc3RyaW5nLCB3aW5kb3dLZXk/OiBzdHJpbmcpIHtcclxuICAgIGxldCByZXNwb25zZTogUmVzcG9uc2U7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QocGF0aCk7XHJcbiAgICAgIGNvbnN0IHJlcXVlc3RVcmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcclxuICAgICAgaWYgKCFyZXF1ZXN0VXJsLmhvc3RuYW1lLmVuZHNXaXRoKHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSkgJiZcclxuICAgICAgICAgICFyZXF1ZXN0VXJsLmhvc3QuZW5kc1dpdGgoJ21hdHRlcnBvcnQuY29tJykgJiZcclxuICAgICAgICAgICFyZXF1ZXN0VXJsLmhvc3QuZW5kc1dpdGgoJ21hdHRlcnBvcnR2ci5jbicpKSB7XHJcbiAgICAgICAgdGhpcy5saWJyYXJ5UmVqZWN0ZXIoYFJlcXVlc3QgbWFkZSBmb3IgJHtyZXF1ZXN0VXJsLmhyZWZ9IGRvZXMgbm90IGhhdmUgdGhlIHNhbWUgb3JpZ2luIGFzIHRoZSByZXF1ZXN0IG9yaWdpbiAke3dpbmRvdy5sb2NhdGlvbi5vcmlnaW59YCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoKG5ldyBSZXF1ZXN0KHBhdGgsIHtcclxuICAgICAgICAvLyBUT0RPOiBpdCB3b3VsZCBiZSBuaWNlIGlmICdzYW1lLXNpdGUnIHdhcyBzdXBwb3J0ZWQgYnV0IGl0IGlzbid0O1xyXG4gICAgICAgIC8vIC4uLiBzaW5jZSB0aGUgU2hvd2Nhc2UgaWZyYW1lIHdpbGwgYmUgYXQgcWEzLiBvciBteS4gc3ViZG9tYWlucywgc2FtZS1vcmlnaW4gd2lsbCBicmVhayBmb3Igc3RhdGljLm1hdHRlcnBvcnQgZmV0Y2hlcy5cclxuICAgICAgICAvLyBtb2RlOiAnc2FtZS1vcmlnaW4nLFxyXG4gICAgICB9KSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHRoaXMubGlicmFyeVJlamVjdGVyKGUpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICB0aGlzLmxpYnJhcnlSZWplY3RlcignU2NyaXB0IG5vdCBmb3VuZC4nKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGV4ZWN1dGUgdGhlIHJlcHNvbnNlICh3aGljaCBpcyB0aGUgbGlicmFyeSdzIHRleHQpIGFuZCBhdHRhY2ggdGhlIHJlc3VsdCB0byB0aGUgYGxpYmAgb2JqZWN0XHJcbiAgICBjb25zdCBsaWIgPSB7fSBhcyBUO1xyXG4gICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcclxuICAgIG5ldyBGdW5jdGlvbih0ZXh0KS5jYWxsKGxpYik7XHJcblxyXG4gICAgLy8gaWYgdGhlIGB3aW5kb3dLZXlgIGFyZyB3YXMgcHJvdmlkZWQgYW5kIHRoZSBsaWJyYXJ5J3MgY29udGVudHMgd2VyZSBhdHRhY2hlZCB0byB0aGUgd2luZG93LCBhc3NpZ24gdGhhdCB0byB0aGUgYGxpYmAgb2JqZWN0XHJcbiAgICBpZiAod2luZG93S2V5ICYmIHdpbmRvd0tleSBpbiB3aW5kb3cpIHtcclxuICAgICAgY29uc3QgbGliT2JqZWN0ID0gd2luZG93W3dpbmRvd0tleSBhcyBrZXlvZiBXaW5kb3ddIHx8IHt9O1xyXG4gICAgICBPYmplY3QuYXNzaWduKGxpYiwgbGliT2JqZWN0KTtcclxuICAgICAgZGVsZXRlIHdpbmRvd1t3aW5kb3dLZXkgYXMga2V5b2YgV2luZG93XTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmxpYnJhcnlSZXNvbHZlcihsaWIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQSBwcm9taXNlIG9mIHRoZSBsaWJyYXJ5IGJlaW5nIGxvYWRlZFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXQgbGlicmFyeSgpOiBQcm9taXNlPFQ+IHtcclxuICAgIHJldHVybiB0aGlzLl9saWJyYXJ5UHJvbWlzZTtcclxuICB9XHJcblxyXG59XHJcbiIsImltcG9ydCB0eXBlIHsgQ29ubmVjdFJlc3BvbnNlIH0gZnJvbSAnLi9Db25uZWN0b3InO1xuaW1wb3J0IHR5cGUgeyBJTWVzc2VuZ2VyRmFjdG9yeSB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5cbmltcG9ydCB0eXBlIHsgTXBTZGsgfSBmcm9tICdAc2RrL3R5cGVzJztcbmltcG9ydCB7IER5bmFtaWNMaWJMb2FkZXIgfSBmcm9tICdkeW5hbWljLWxpYi1sb2FkZXInO1xuXG50eXBlIERpY3Q8VCA9IHVua25vd24+ID0gUmVjb3JkPHN0cmluZywgVCB8IHVuZGVmaW5lZD47XG5cbi8vIGRlY2xhcmUgY2xhc3MgaXMgbGlrZSBkZWZpbmluZyBhbiBpbnRlcmZhY2UsIGJ1dCBpdCBjYW4gaGF2ZSBhIGNvbnN0cnVjdG9yXG4vLyBpdCdzIHNpbWlsYXIgdG8gYGV4dGVybmAsIHdoZXJlIHRoaXMgY2xhc3MgaXMgZnVsbHkgZGVmaW5lZCBhbmQgaW1wbGVtZW50ZWQgZWxzZXdoZXJlXG5kZWNsYXJlIGNsYXNzIFNka0J1aWxkZXI8T3V0Z29pbmdEYXRhTWFwVCA9IHVua25vd24sIEluY29taW5nRGF0YU1hcFQgPSB1bmtub3duPiB7XG4gIGNvbnN0cnVjdG9yKG1lc3NlbmdlckZhY3Rvcnk6IElNZXNzZW5nZXJGYWN0b3J5PE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+LCB3aW5kb3dDb250ZXh0OiBXaW5kb3cpO1xuICBwdWJsaWMgYnVpbGQoc2VyaWFsaXplZEludGVyZmFjZTogRGljdCk6IE1wU2RrO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElTZGtDb25uZWN0b3I8VCBleHRlbmRzIENvbm5lY3RSZXNwb25zZT4ge1xuICBjb25uZWN0KCk6IFByb21pc2U8VD47XG4gIGNhbmNlbENvbm5lY3RpbmcoKTogdm9pZDtcbn1cblxuZXhwb3J0IHR5cGUgTWVzc2VuZ2VyRmFjdG9yeUZldGNoZXI8Q29ubmVjdFJlc3BvbnNlVCBleHRlbmRzIENvbm5lY3RSZXNwb25zZSwgT3V1dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwPiA9IHtcbiAgZ2V0RmFjdG9yeShjb25uZWN0UmVzcG9uc2U6IENvbm5lY3RSZXNwb25zZVQpOiBJTWVzc2VuZ2VyRmFjdG9yeTxPdXV0Z29pbmdEYXRhTWFwLCBJbmNvbWluZ0RhdGFNYXA+O1xufTtcblxuZXhwb3J0IG5hbWVzcGFjZSBNUF9TREsge1xuICBjb25zdCBsaWJMb2FkZXIgPSBuZXcgRHluYW1pY0xpYkxvYWRlcigpO1xuICBleHBvcnQgYXN5bmMgZnVuY3Rpb24gY29ubmVjdDxUIGV4dGVuZHMgQ29ubmVjdFJlc3BvbnNlID0gQ29ubmVjdFJlc3BvbnNlLCBPdXRnb2luZ0RhdGFNYXAgPSB1bmtub3duLCBJbmNvbWluZ0RhdGFNYXAgPSB1bmtub3duPihcbiAgICBjb25uZWN0b3I6IElTZGtDb25uZWN0b3I8VD4sXG4gICAgZmFjdG9yeUZldGNoZXI6IE1lc3NlbmdlckZhY3RvcnlGZXRjaGVyPFQsIE91dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwPixcbiAgICB3aW5kb3dDb250ZXh0OiBXaW5kb3csXG4gICk6IFByb21pc2U8TXBTZGs+IHtcbiAgICBsZXQgY29ubmVjdFJlc3BvbnNlOiBUO1xuICAgIHRyeSB7XG4gICAgICBjb25uZWN0UmVzcG9uc2UgPSBhd2FpdCBjb25uZWN0b3IuY29ubmVjdCgpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBhZnRlciBhIGNvbm5lY3Rpb24gaXMgc3VjY2Vzc2Z1bCBvciBub3QsIHNodXRkb3duIHRoZSBjb25uZWN0b3IgYW5kIGl0cyBwb3N0bWVzc2FnZSByZWNlaXZpbmcgbWVzc2FnZXNcbiAgICAgIGNvbm5lY3Rvci5jYW5jZWxDb25uZWN0aW5nKCk7XG4gICAgfVxuXG4gICAgLy8gZmV0Y2ggYW5kIGJ1aWxkIHRoZSBjbGllbnQgaW50ZXJmYWNlXG4gICAgY29uc3QgYnVpbGRlciA9IGF3YWl0IGZldGNoU2NyaXB0KGNvbm5lY3RSZXNwb25zZS5zY3JpcHRVcmwpO1xuICAgIC8vIHNldCB1cCBhIGZhY3Rvcnkgc28gdGhhdCB0aGUgY2xpZW50IGNhbiBjcmVhdGUgTWVzc2VuZ2VyIGNoYW5uZWxzXG4gICAgY29uc3QgbWVzc2VuZ2VyRmFjdG9yeSA9IGZhY3RvcnlGZXRjaGVyLmdldEZhY3RvcnkoY29ubmVjdFJlc3BvbnNlKTtcbiAgICAvLyBidWlsZCBhbmQgcmV0dXJuIHRoZSBjbGllbnQgaW50ZXJmYWNlIHRvIHRoZSB1c2VyXG4gICAgcmV0dXJuIGJ1aWxkSW50ZXJmYWNlKHdpbmRvd0NvbnRleHQsIGJ1aWxkZXIsIG1lc3NlbmdlckZhY3RvcnksIGNvbm5lY3RSZXNwb25zZS5zZXJpYWxpemVkSW50ZXJmYWNlKTtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGZldGNoU2NyaXB0KHVybD86IHN0cmluZyk6IFByb21pc2U8dHlwZW9mIFNka0J1aWxkZXI+IHtcbiAgICBpZiAoIXVybCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGVkIHRvIGxvYWQgdGhlIHNkaycpO1xuICAgIH1cblxuICAgIC8vIGZldGNoIGFuZCBjYWNoZSB0aGUgcHJvbWlzZSBmb3IgdGhlIHJlcXVlc3RlZCBzY3JpcHRcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2RrQ2xpZW50ID0gYXdhaXQgbGliTG9hZGVyLmxvYWQ8e1Nka0J1aWxkZXI6IHR5cGVvZiBTZGtCdWlsZGVyfT4odXJsLCAnc2RrLWNsaWVudCcpO1xuICAgICAgaWYgKHNka0NsaWVudCAmJiBzZGtDbGllbnQuU2RrQnVpbGRlciAmJiB0eXBlb2Ygc2RrQ2xpZW50LlNka0J1aWxkZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHNka0NsaWVudC5TZGtCdWlsZGVyO1xuICAgICAgfVxuICAgIH0gY2F0Y2gge1xuICAgICAgLy8gY2F0Y2ggYWxsIGFuZCBcImlnbm9yZVwiLCBzaW5jZSB3ZSdsbCB0aHJvdyBzaG9ydGx5IGFueXdheVxuICAgIH1cbiAgICB0aHJvdyBFcnJvcihgQ291bGQgbm90IGxvYWQgdGhlIHNkayBmcm9tICR7dXJsfWApO1xuICB9XG5cbiAgZnVuY3Rpb24gYnVpbGRJbnRlcmZhY2U8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4oXG4gICAgd2luZG93Q29udGV4dDogV2luZG93LFxuICAgIHNka0J1aWxkZXI6IHR5cGVvZiBTZGtCdWlsZGVyLFxuICAgIG1lc3NlbmdlckZhY3Rvcnk6IElNZXNzZW5nZXJGYWN0b3J5PE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+LFxuICAgIHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3QsXG4gICk6IFJldHVyblR5cGU8U2RrQnVpbGRlclsnYnVpbGQnXT4ge1xuICAgIHJldHVybiBuZXcgc2RrQnVpbGRlcihtZXNzZW5nZXJGYWN0b3J5LCB3aW5kb3dDb250ZXh0KS5idWlsZChzZXJpYWxpemVkSW50ZXJmYWNlKTtcbiAgfVxufVxuIiwiLy8gLS0tLS0tLS0tLS0tLS0tLS0gT3V0Z29pbmcgTWVzc2FnZXMgLS0tLS0tLS0tLS0tLS0tLS0gLy9cbmV4cG9ydCBlbnVtIE91dGdvaW5nTWVzc2FnZVR5cGUge1xuICBDT05ORUNUID0gJ3Bvc3RtZXNzYWdlLmNvbm5lY3QnLFxufVxuXG4vKipcbiAqIFRoZSBkYXRhIHBheWxvYWQgb2YgYSBDb25uZWN0IG1lc3NhZ2VcbiAqL1xuZXhwb3J0IHR5cGUgQ29ubmVjdFBheWxvYWQgPSB7XG4gIC8qKiBUaGUgdmVyc2lvbiBvZiB0aGUgc2RrIGJvb3RzdHJhcCBhdHRlbXB0aW5nIHRvIGNvbm5lY3QgKi9cbiAgYm9vdHN0cmFwVmVyc2lvbjogc3RyaW5nO1xuICBvcHRpb25zOiB7XG4gICAgLyoqIEFuIGF1dGggdG9rZW4gKi9cbiAgICBhdXRoPzogc3RyaW5nO1xuXG4gICAgLyoqIHByb3ZpZGVyIG5hbWUgKi9cbiAgICBwcm92aWRlcj86IHN0cmluZztcblxuICAgIHNka1R5cGU/OiBzdHJpbmc7XG4gIH0sXG4gIC8vIFRPRE8gKHNkayk6IHNkayBib290c3RyYXAgdjIueCBwYXNzZWQgdGhlIGFwcGxpY2F0aW9uS2V5OyByZW1vdmUgdGhpcyB3aGVuIHRob3NlIHZlcnNpb25zIGFyZSBubyBsb25nZXIgc3VwcG9ydGVkXG4gIGFwcGxpY2F0aW9uS2V5Pzogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBBIG1hcCBiZXR3ZWVuIHRoZSBvdXRnb2luZyBtZXNzYWdlcyB0eXBlcyBhbmQgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoZSBtZXNzYWdlXG4gKi9cbmV4cG9ydCB0eXBlIE91dGdvaW5nRGF0YU1hcCA9IHtcbiAgW091dGdvaW5nTWVzc2FnZVR5cGUuQ09OTkVDVF06IENvbm5lY3RQYXlsb2FkLFxufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0gSW5jb21pbmcgTWVzc2FnZXMgLS0tLS0tLS0tLS0tLS0tLS0gLy9cbmV4cG9ydCBlbnVtIEluY29taW5nTWVzc2FnZVR5cGUge1xuICBIQU5EU0hBS0UgPSAncG9zdG1lc3NhZ2UuaGFuZHNoYWtlJyxcbiAgQUNDRVBUICAgID0gJ3Bvc3RtZXNzYWdlLmFjY2VwdCcsXG4gIFJFSkVDVCAgICA9ICdwb3N0bWVzc2FnZS5yZWplY3QnLFxufVxuXG4vKipcbiAqIFRoZSBkYXRhIG9mIGEgbWVzc2FnZSBzaWduYWxsaW5nIHRoYXQgdGhlIGNvbm5lY3Rpb24gd2FzIChtb3N0bHkpIGFjY2VwdGVkIGJ1dCBoYXNuJ3QgYmVlbiBmaW5hbGl6ZWQgeWV0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSGFuZHNoYWtlUGF5bG9hZCB7XG4gIC8qKiBETyBOT1QgVVNFOiBQbGFjZWhvbGRlciB0byBtYWtlIHRoaXMgdHlwZSB1bmlxdWUgZnJvbSBvdGhlciBtZXNzYWdlIERhdGEgdHlwZXMgKi9cbiAgdW51c2VkPzogJ2hhbmRzaGFrZS5kYXRhJztcbn1cblxuLyoqXG4gKiBUaGUgZGF0YSBvZiBhIG1lc3NhZ2Ugc2lnbmFsbGluZyB0aGUgY29ubmVjdGlvbiB0byB0aGUgaG9zdCB3YXMgYWNjZXB0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBY2NlcHRQYXlsb2FkIHtcbiAgLyoqIFRoZSBpZCB0aGF0IHdhcyBhc3NpZ25lZCB0byB0aGllIGNsaWVudCBiZWhpbmQgdGhpcyBjb25uZWN0aW9uICovXG4gIHNvdXJjZUlkOiBudW1iZXI7XG4gIC8qKiBUaGUgcmVtb3RlIHVybCBvZiB0aGUgY2xpZW50IHNjcmlwdCB0byBiZSBkeW5hbWljYWxseSBsb2FkZWQgKi9cbiAgc2NyaXB0VXJsOiBzdHJpbmc7XG4gIC8qKiBUaGUgc2VyaWFsaXplZCBpbnRlcmZhY2UgdGhhdCB0aGUgaG9zdCBzdXBwb3J0cyAqL1xuICBpbnRlcmZhY2U6IFJlY29yZDxzdHJpbmcsIHVua25vd24gfCB1bmRlZmluZWQ+O1xuICAvKiogVGhlIGlkIG9mIHRoZSBob3N0IHRoYXQgYWNjZXB0ZWQgdGhlIGNvbm5lY3Rpb24gKi9cbiAgdGFyZ2V0SWQ6IG51bWJlcjtcbiAgLyoqIFRoZSBvcmlnaW4gb2YgdGhlIGhvc3QgdGhhdCBhY2NlcHRlZCB0aGUgY29ubmVjdGlvbiAqL1xuICB0YXJnZXRPcmlnaW46IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgZGF0YSBvZiBhIG1lc3NhZ2Ugc2lnbmFsbGluZyB0aGF0IHRoZSBjb25uZWN0aW9uIHdhcyByZWplY3RlZCBvciBmYWlsZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZWplY3RQYXlsb2FkIHtcbiAgLyoqIFRoZSBlcnJvciBtZXNzYWdlIHdoeSBjb25uZWN0aW5nIGZhaWxlZCAqL1xuICByZWFzb246IHN0cmluZztcbn1cblxuLyoqXG4gKiBBIG1hcCBiZXR3ZWVuIHRoZSBpbmNvbWluZyBtZXNzYWdlcyB0eXBlcyBhbmQgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoZSBtZXNzYWdlXG4gKi9cbmV4cG9ydCB0eXBlIEluY29taW5nRGF0YU1hcCA9IHtcbiAgW0luY29taW5nTWVzc2FnZVR5cGUuSEFORFNIQUtFXTogSGFuZHNoYWtlUGF5bG9hZDtcbiAgW0luY29taW5nTWVzc2FnZVR5cGUuQUNDRVBUXTogQWNjZXB0UGF5bG9hZDtcbiAgW0luY29taW5nTWVzc2FnZVR5cGUuUkVKRUNUXTogUmVqZWN0UGF5bG9hZDtcbn07XG4iLCJpbXBvcnQgdHlwZSB7IElVbmRpcmVjdGVkTWVzc2VuZ2VyLCBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcn0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB7IEFOWV9UQVJHRVQgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0T3B0aW9ucyB9IGZyb20gJ0BzZGsvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcCB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBDb25uZWN0TWVzc2FnZSB9IGZyb20gJy4uL01lc3NhZ2VzL0Nvbm5lY3RNZXNzYWdlJztcbmltcG9ydCB7IEhhbmRzaGFrZU9ic2VydmVyIH0gZnJvbSAnLi4vTWVzc2FnZU9ic2VydmVycy9IYW5kc2hha2VPYnNlcnZlcic7XG5pbXBvcnQgeyBBY2NlcHRPYnNlcnZlciB9IGZyb20gJy4uL01lc3NhZ2VPYnNlcnZlcnMvQWNjZXB0T2JzZXJ2ZXInO1xuaW1wb3J0IHsgUmVqZWN0T2JzZXJ2ZXIgfSBmcm9tICcuLi9NZXNzYWdlT2JzZXJ2ZXJzL1JlamVjdE9ic2VydmVyJztcblxudHlwZSBEaWN0PFQgPSB1bmtub3duPiA9IFJlY29yZDxzdHJpbmcsIFQgfCB1bmRlZmluZWQ+O1xuXG5lbnVtIENvbm5lY3Rpb25TdGF0ZSB7XG4gIElETEUsXG4gIENPTk5FQ1RJTkcsXG4gIEhBTkRTSEFLRSxcbiAgQ09OTkVDVEVELFxuICBSRUpFQ1RFRCxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb25uZWN0UmVzcG9uc2Uge1xuICBzb3VyY2VJZDogbnVtYmVyO1xuICB0YXJnZXRJZDogbnVtYmVyO1xuICB0YXJnZXRPcmlnaW46IHN0cmluZztcbiAgc2NyaXB0VXJsOiBzdHJpbmc7XG4gIHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3Q7XG59XG5cbmV4cG9ydCBjbGFzcyBDb25uZWN0b3I8U291cmNlVD4ge1xuICBwcml2YXRlIGNvbm5lY3Rpb25TdGF0ZTogQ29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLklETEU7XG4gIHByaXZhdGUgY29ubmVjdGlvblBvbGw6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSBjb25uZWN0aW9uUHJvbWlzZTogUHJvbWlzZTxDb25uZWN0UmVzcG9uc2U+O1xuICBwcml2YXRlIHJlc29sdmVDb25uZWN0aW9uITogKHZhbHVlOiBDb25uZWN0UmVzcG9uc2UpID0+IHZvaWQ7XG4gIHByaXZhdGUgcmVqZWN0Q29ubmVjdGlvbiE6IChyZWFzb246IHN0cmluZykgPT4gdm9pZDtcblxuICBwcml2YXRlIGhhbmRzaGFrZU9ic2VydmVyOiBIYW5kc2hha2VPYnNlcnZlcjtcbiAgcHJpdmF0ZSBhY2NlcHRPYnNlcnZlcjogQWNjZXB0T2JzZXJ2ZXI7XG4gIHByaXZhdGUgcmVqZWN0T2JzZXJ2ZXI6IFJlamVjdE9ic2VydmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgbWVzc2VuZ2VyOiBJVW5kaXJlY3RlZE1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcCwgU291cmNlVD4sXG4gICAgcHJpdmF0ZSB0YXJnZXQ6IElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPE91dGdvaW5nRGF0YU1hcCwgU291cmNlVD4sXG4gICAgcHJpdmF0ZSBzb3VyY2U6IFNvdXJjZVRcbiAgKSB7XG4gICAgY2xhc3MgQ29ubmVjdG9yRmFjYWRlIHtcbiAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgY29ubmVjdG9yOiBDb25uZWN0b3I8U291cmNlVD4pIHt9XG4gICAgICBwdWJsaWMgaGFuZHNoYWtlKCkge1xuICAgICAgICB0aGlzLmNvbm5lY3Rvci5oYW5kc2hha2UoKTtcbiAgICAgIH1cbiAgICAgIHB1YmxpYyBhY2NlcHQoc291cmNlSWQ6IG51bWJlciwgc2NyaXB0VXJsOiBzdHJpbmcsIHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3QsIHRhcmdldElkOiBudW1iZXIsIHRhcmdldE9yaWdpbjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdG9yLmFjY2VwdChzb3VyY2VJZCwgc2NyaXB0VXJsLCBzZXJpYWxpemVkSW50ZXJmYWNlLCB0YXJnZXRJZCwgdGFyZ2V0T3JpZ2luKTtcbiAgICAgIH1cbiAgICAgIHB1YmxpYyByZWplY3QocmVhc29uOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0b3IucmVqZWN0KHJlYXNvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgY29ubmVjdG9yRmFjYWRlID0gbmV3IENvbm5lY3RvckZhY2FkZSh0aGlzKTtcblxuICAgIHRoaXMuaGFuZHNoYWtlT2JzZXJ2ZXIgPSBuZXcgSGFuZHNoYWtlT2JzZXJ2ZXIoY29ubmVjdG9yRmFjYWRlKTtcbiAgICB0aGlzLmFjY2VwdE9ic2VydmVyID0gbmV3IEFjY2VwdE9ic2VydmVyKGNvbm5lY3RvckZhY2FkZSk7XG4gICAgdGhpcy5yZWplY3RPYnNlcnZlciA9IG5ldyBSZWplY3RPYnNlcnZlcihjb25uZWN0b3JGYWNhZGUpO1xuICAgIHRoaXMuY29ubmVjdGlvblByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHtcbiAgICAgIHRoaXMucmVzb2x2ZUNvbm5lY3Rpb24gPSByZXM7XG4gICAgICB0aGlzLnJlamVjdENvbm5lY3Rpb24gPSByZWo7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgY29ubmVjdCh2ZXJzaW9uOiBzdHJpbmcsIG9wdGlvbnM6IFBhcnRpYWw8Q29ubmVjdE9wdGlvbnM+ID0ge30pOiBQcm9taXNlPENvbm5lY3RSZXNwb25zZT4ge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9PT0gQ29ubmVjdGlvblN0YXRlLklETEUpIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RJTkc7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5hZGRPYnNlcnZlcih0aGlzLmhhbmRzaGFrZU9ic2VydmVyKTtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLmFkZE9ic2VydmVyKHRoaXMuYWNjZXB0T2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5tZXNzZW5nZXIuYWRkT2JzZXJ2ZXIodGhpcy5yZWplY3RPYnNlcnZlcik7XG4gICAgICAvLyBUT0RPOiBmaWd1cmUgb3V0IGEgYmV0dGVyIHdheSB0byBlbnN1cmUgY29ubmVjdGlvblxuICAgICAgdGhpcy5jb25uZWN0aW9uUG9sbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIC8vIHNlbmQgdGhlIG1lc3NhZ2UgdG8gYW55Ym9keSB3aG8ncyBsaXN0ZW5pbmcgd2l0aGluIHRoZSB0YXJnZXQgd2luZG93XG4gICAgICAgIHRoaXMubWVzc2VuZ2VyLnNlbmQobmV3IENvbm5lY3RNZXNzYWdlKHZlcnNpb24sIG9wdGlvbnMpLCBBTllfVEFSR0VULCB0aGlzLnRhcmdldCwgdGhpcy5zb3VyY2UpO1xuICAgICAgfSwgNTAwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uUHJvbWlzZTtcbiAgfVxuXG4gIHB1YmxpYyBjYW5jZWxDb25uZWN0aW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA8IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNURUQpIHtcbiAgICAgIHRoaXMuc3RvcENvbm5lY3RQb2xsaW5nKCk7XG4gICAgICB0aGlzLnJlamVjdENvbm5lY3Rpb24oJ1VzZXIgbWFudWFsbHkgY2FuY2VsbGVkIGNvbm5lY3Rpb24nKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRzaGFrZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uU3RhdGUgPCBDb25uZWN0aW9uU3RhdGUuSEFORFNIQUtFKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5IQU5EU0hBS0U7XG4gICAgICB0aGlzLnN0b3BDb25uZWN0UG9sbGluZygpO1xuXG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLmhhbmRzaGFrZU9ic2VydmVyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFjY2VwdChzb3VyY2VJZDogbnVtYmVyLCBzY3JpcHRVcmw6IHN0cmluZywgc2VyaWFsaXplZEludGVyZmFjZTogRGljdCwgdGFyZ2V0SWQ6IG51bWJlciwgdGFyZ2V0T3JpZ2luOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uU3RhdGUgPCBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVEVEKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNURUQ7XG5cbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMuaGFuZHNoYWtlT2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5tZXNzZW5nZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcy5hY2NlcHRPYnNlcnZlcik7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLnJlamVjdE9ic2VydmVyKTtcbiAgICAgIHRoaXMuc3RvcENvbm5lY3RQb2xsaW5nKCk7XG5cbiAgICAgIHRoaXMucmVzb2x2ZUNvbm5lY3Rpb24oe1xuICAgICAgICBzb3VyY2VJZCxcbiAgICAgICAgdGFyZ2V0SWQsXG4gICAgICAgIHRhcmdldE9yaWdpbixcbiAgICAgICAgc2NyaXB0VXJsLFxuICAgICAgICBzZXJpYWxpemVkSW50ZXJmYWNlLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZWplY3QocmVhc29uOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uU3RhdGUgPCBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVEVEKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5SRUpFQ1RFRDtcblxuICAgICAgdGhpcy5tZXNzZW5nZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcy5oYW5kc2hha2VPYnNlcnZlcik7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLmFjY2VwdE9ic2VydmVyKTtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMucmVqZWN0T2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5zdG9wQ29ubmVjdFBvbGxpbmcoKTtcblxuICAgICAgdGhpcy5yZWplY3RDb25uZWN0aW9uKHJlYXNvbik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdG9wQ29ubmVjdFBvbGxpbmcoKTogdm9pZCB7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNvbm5lY3Rpb25Qb2xsKTtcbiAgICB0aGlzLmNvbm5lY3Rpb25Qb2xsID0gdW5kZWZpbmVkO1xuICB9XG5cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NhZ2UgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0T3B0aW9ucyB9IGZyb20gJ0BzZGsvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0UGF5bG9hZCwgT3V0Z29pbmdEYXRhTWFwfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgT3V0Z29pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBDb25uZWN0TWVzc2FnZSBpbXBsZW1lbnRzIElNZXNzYWdlPE91dGdvaW5nTWVzc2FnZVR5cGUuQ09OTkVDVCwgT3V0Z29pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlID0gT3V0Z29pbmdNZXNzYWdlVHlwZS5DT05ORUNUO1xuICBwdWJsaWMgcmVhZG9ubHkgcGF5bG9hZDogQ29ubmVjdFBheWxvYWQ7XG5cbiAgY29uc3RydWN0b3IoYm9vdHN0cmFwVmVyc2lvbjogc3RyaW5nLCBvcHRpb25zOiBQYXJ0aWFsPENvbm5lY3RPcHRpb25zPiA9IHt9KSB7XG4gICAgdGhpcy5wYXlsb2FkID0ge1xuICAgICAgYm9vdHN0cmFwVmVyc2lvbixcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgYXV0aDogb3B0aW9ucy5hdXRoLFxuICAgICAgICBwcm92aWRlcjogb3B0aW9ucy5wcm92aWRlcixcbiAgICAgICAgc2RrVHlwZTogb3B0aW9ucy5zZGtUeXBlLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IENsaWVudEluZm8sIElNZXNzYWdlT2JzZXJ2ZXIgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBJbmNvbWluZ0RhdGFNYXAsIEhhbmRzaGFrZVBheWxvYWQgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgSW5jb21pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGFuZHNoYWtlUmVjZWl2ZXIge1xuICBoYW5kc2hha2UoKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIEhhbmRzaGFrZU9ic2VydmVyIGltcGxlbWVudHMgSU1lc3NhZ2VPYnNlcnZlcjxJbmNvbWluZ01lc3NhZ2VUeXBlLkhBTkRTSEFLRSwgSW5jb21pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSBtZXNzYWdlVHlwZSA9IEluY29taW5nTWVzc2FnZVR5cGUuSEFORFNIQUtFO1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlY2VpdmVyOiBIYW5kc2hha2VSZWNlaXZlcikgeyB9XG5cbiAgcHVibGljIG5vdGlmeShfaGFuZHNoYWtlOiBIYW5kc2hha2VQYXlsb2FkLCBfY2xpZW50SW5mbzogQ2xpZW50SW5mbywgX3RpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5yZWNlaXZlci5oYW5kc2hha2UoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBDbGllbnRJbmZvLCBJTWVzc2FnZU9ic2VydmVyIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgSW5jb21pbmdEYXRhTWFwLCBBY2NlcHRQYXlsb2FkIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IEluY29taW5nTWVzc2FnZVR5cGUgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuXG50eXBlIERpY3Q8VCA9IHVua25vd24+ID0gUmVjb3JkPHN0cmluZywgVCB8IHVuZGVmaW5lZD47XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWNjZXB0UmVjZWl2ZXIge1xuICBhY2NlcHQoc291cmNlSWQ6IG51bWJlciwgc2NyaXB0VXJsOiBzdHJpbmcsIHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3QsIHRhcmdldElkOiBudW1iZXIsIHRhcmdldE9yaWdpbjogc3RyaW5nKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIEFjY2VwdE9ic2VydmVyIGltcGxlbWVudHMgSU1lc3NhZ2VPYnNlcnZlcjxJbmNvbWluZ01lc3NhZ2VUeXBlLkFDQ0VQVCwgSW5jb21pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSBtZXNzYWdlVHlwZSA9IEluY29taW5nTWVzc2FnZVR5cGUuQUNDRVBUO1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlY2VpdmVyOiBBY2NlcHRSZWNlaXZlcikge31cblxuICBwdWJsaWMgbm90aWZ5KGFjY2VwdDogQWNjZXB0UGF5bG9hZCwgX2NsaWVudEluZm86IENsaWVudEluZm8sIF90aW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0IHsgc291cmNlSWQsIHNjcmlwdFVybCwgdGFyZ2V0SWQsIHRhcmdldE9yaWdpbiB9ID0gYWNjZXB0O1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRJbnRlcmZhY2UgPSBhY2NlcHQuaW50ZXJmYWNlOyAvLyBjYW4ndCBiZSBkZXN0cnVjdHVyZWQgYmVjYXVzZSBgaW50ZXJmYWNlYCBpcyBhIHJlc2VydmVkIHdvcmRcblxuICAgIHRoaXMucmVjZWl2ZXIuYWNjZXB0KHNvdXJjZUlkLCBzY3JpcHRVcmwsIHNlcmlhbGl6ZWRJbnRlcmZhY2UsIHRhcmdldElkLCB0YXJnZXRPcmlnaW4pO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IENsaWVudEluZm8sIElNZXNzYWdlT2JzZXJ2ZXIgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBJbmNvbWluZ0RhdGFNYXAsIFJlamVjdFBheWxvYWQgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgSW5jb21pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVqZWN0UmVjZWl2ZXIge1xuICByZWplY3QocmVhc29uOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgUmVqZWN0T2JzZXJ2ZXIgaW1wbGVtZW50cyBJTWVzc2FnZU9ic2VydmVyPEluY29taW5nTWVzc2FnZVR5cGUuUkVKRUNULCBJbmNvbWluZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IG1lc3NhZ2VUeXBlID0gSW5jb21pbmdNZXNzYWdlVHlwZS5SRUpFQ1Q7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVjZWl2ZXI6IFJlamVjdFJlY2VpdmVyKSB7fVxuXG4gIHB1YmxpYyBub3RpZnkocmVqZWN0OiBSZWplY3RQYXlsb2FkLCBfY2xpZW50SW5mbzogQ2xpZW50SW5mbywgX3RpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5yZWNlaXZlci5yZWplY3QocmVqZWN0LnJlYXNvbik7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSW5kZXhLZXkgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogQW4gb2JqZWN0IHRvIHVzZSBpbiBwbGFjZSBvZiBhIGNhbGxiYWNrXG4gKiBBdm9pZHMgaXNzdWVzIHdpdGggdW5ib3VuZCBmdW5jdGlvbnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJT2JzZXJ2ZXI8VCBleHRlbmRzIHVua25vd25bXT4ge1xuICBub3RpZnkoLi4uZGF0YTogVCk6IHZvaWQ7XG59XG5cbi8qKlxuICogSW5mb3JtYXRpb24gYWJvdXQgYSBjbGllbnQgc2VuZGluZyBtZXNzYWdlc1xuICovXG5leHBvcnQgdHlwZSBDbGllbnRJbmZvID0ge1xuICBpZDogbnVtYmVyO1xufVxuXG4vKipcbiAqIEFuIG9ic2VydmVyIGFzc29jaWF0ZWQgd2l0aCBhIHNwZWNpZmljIHR5cGUgb2YgbWVzc2FnZVxuICogTm90aWZpZWQgb2YgaW5jb21pbmcgbWVzc2FnZXMgb2YgdHlwZSBgSW5jb21pbmdNZXNzYWdlVHlwZWBcbiAqXG4gKiBAcGFyYW0gSW5jb21pbmdNZXNzYWdlVHlwZSBUaGUgbWVzc2FnZSB0eXBlIHRvIGxpc3RlbiBmb3JcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIEEgbWFwIGJldHdlZW4gSW5jb21pbmdNZXNzYWdlVHlwZSBhbmQgZGF0YSByZWNlaXZlZCBhbmQgdXNlZCB3aXRoaW4gYG5vdGlmeWBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJTWVzc2FnZU9ic2VydmVyPFxuICBJbmNvbWluZ01lc3NhZ2VUeXBlIGV4dGVuZHMga2V5b2YgSW5jb21pbmdEYXRhTWFwVCxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbiAgQ2xpZW50SW5mb1QgZXh0ZW5kcyBDbGllbnRJbmZvID0gQ2xpZW50SW5mbyxcbj4ge1xuICAvKiogVGhlIG1lc3NhZ2UgdHlwZSB0byBsaXN0ZW4gZm9yICovXG4gIHJlYWRvbmx5IG1lc3NhZ2VUeXBlOiBJbmNvbWluZ01lc3NhZ2VUeXBlO1xuICAvKiogQSBjYWxsYmFjayBjYWxsZWQgd2hlbiBhbiBJTWVzc2FnZSByZWNlaXZlcyBhbiBgSW5jb21pbmdNZXNzYWdlVHlwZWAgbWVzc2FnZSAqL1xuICBub3RpZnkocGF5bG9hZDogSW5jb21pbmdEYXRhTWFwVFtJbmNvbWluZ01lc3NhZ2VUeXBlXSwgY2xpZW50SW5mbzogQ2xpZW50SW5mb1QsIHNlbnRBdFRpbWVzdGFtcDogbnVtYmVyKTogdm9pZDtcbn1cblxuLyoqXG4gKiBBIGZhY3RvcnkgdG8gY3JlYXRlIElNZXNzZW5nZXJzXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJTWVzc2VuZ2VyRmFjdG9yeTxPdXRnb2luZ0RhdGFNYXBULEluY29taW5nRGF0YU1hcFQ+IHtcbiAgLyoqXG4gICAqIENyZWF0ZSBhbiBJTWVzc2VuZ2VyIHRoYXQgY2FuIHNlbmQgYE91dGdvaW5nRGF0YU1hcFRgIGFuZCBjYW4gcmVjZWl2ZSBgSW5jb21pbmdEYXRhTWFwVGBcbiAgICovXG4gIGNyZWF0ZU1lc3NlbmdlcigpOiBJTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+O1xufVxuXG4vKipcbiAqIEEgYmktZGlyZWN0aW9uYWwgY29tbXVuaWNhdG9yIHRoYXQgY2FuXG4gKiAtIHJlY2VpdmUgbWVzc2FnZSBvZiB0eXBlIGBrZXlvZiBJbmNvbWluZ0RhdGFNYXBUYCB2aWEgb2JzZXJ2ZXJzXG4gKiAtIHNlbmQgbWVzc2FnZXMgb2YgdHlwZSBga2V5b2YgT3V0Z29pbmdEYXRhTWFwVGBcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSByZWdpc3RlcmVkIG9ic2VydmVyc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElNZXNzZW5nZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFQsXG4+IHtcbiAgLyoqIHRlYXIgZG93biB0aGlzIG1lc3NlbmdlciAqL1xuICBpbml0KCk6IHZvaWQ7XG4gIC8qKiB0ZWFyIGRvd24gdGhpcyBtZXNzZW5nZXIgKi9cbiAgZGlzcG9zZSgpOiB2b2lkO1xuICAvKiogUmVnaXN0ZXIgYW4gYG9ic2VydmVyYCB0byBsaXN0ZW4gZm9yIGluY29taW5nIG1lc3NhZ2VzICovXG4gIGFkZE9ic2VydmVyKG9ic2VydmVyOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQ7XG4gIC8qKiBSZW1vdmUgYW4gYG9ic2VydmVyYCBmcm9tIGxpc3RlbmluZyB0byBpbmNvbWluZyBtZXNzYWdlcyAqL1xuICByZW1vdmVPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkO1xuICAvKiogU2VuZCBhIGBtZXNzYWdlYCB0byB0aGUgdGFyZ2V0ICovXG4gIHNlbmQobWVzc2FnZTogSU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+KTogdm9pZDtcbn1cblxuLyoqXG4gKiBBIGJyaWRnZSBiZXR3ZWVuIGEgbWVzc2VuZ2VyIGFuZCB0aGUgdW5kZXJseWluZyBtZXNzZW5naW5nIG1lY2hhbmlzbSwgYWxsb3dpbmcgdGhlIG1lc3NlbmdlciB0byBiZSBtb3JlIGdlbmVyaWNcbiAqIFVzZWZ1bCBpbiBhYnN0cmFjdGluZyBhd2F5IHNvbWV0aGluZyBsaWtlIHdpbmRvdy5wb3N0TWVzc2FnZSBmcm9tIGFuIGBJTWVzc2VuZ2VyYFxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NlbmdlckJyaWRnZTxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbj4ge1xuICAvKiogVHVybiBvbiB0aGUgYWJpbGl0eSB0byByZWNlaXZlIG1lc3NhZ2VzIGZyb20gYW5vdGhlciBjbGllbnQgKi9cbiAgbGlzdGVuKG9ic2VydmVyOiBJT2JzZXJ2ZXI8W0lCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgQ2xpZW50SW5mb10+KTogdm9pZDtcbiAgLyoqIFR1cm4gb2ZmIHRoZSBhYmlsaXR5IHRvIHJlY2VpdmUgbWVzc2FnZXMgKi9cbiAgc3RvcExpc3RlbmluZygpOiB2b2lkO1xuICAvKiogU2VuZCBtZXNzYWdlIHRvIHRoZSBhbm90aGVyIGNsaWVudCAqL1xuICBzZW5kKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPik6IHZvaWQ7XG59XG5cbi8qKlxuICogQSBiaS1kaXJlY3Rpb25hbCBjb21tdW5pY2F0b3IgdGhhdCBjYW5cbiAqIC0gb3Blbmx5IHJlY2VpdmUgbWVzc2FnZXMgb2YgdHlwZSBga2V5b2YgSW5jb21pbmdEYXRhTWFwVGAgdmlhIG9ic2VydmVycyBmcm9tIHVuc3BlY2lmaWVkIHNvdXJjZXNcbiAqIC0gc2VuZCBtZXNzYWdlcyBvZiB0eXBlIGBrZXlvZiBPdXRnb2luZ0RhdGFNYXBUYCB0byB0YXJnZXRzIHNwZWNpZmllZCB3aGVuIHNlbmRpbmdcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSByZWdpc3RlcmVkIG9ic2VydmVyc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElVbmRpcmVjdGVkTWVzc2VuZ2VyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuICBTb3VyY2VULFxuPiB7XG4gIC8qKiBSZWdpc3RlciBhbiBgb2JzZXJ2ZXJgIHRvIGxpc3RlbiBmb3IgaW5jb21pbmcgbWVzc2FnZXMgKi9cbiAgYWRkT2JzZXJ2ZXIob2JzZXJ2ZXI6IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZDtcbiAgLyoqIFJlbW92ZSBhbiBgb2JzZXJ2ZXJgIGZyb20gbGlzdGVuaW5nIHRvIGluY29taW5nIG1lc3NhZ2VzICovXG4gIHJlbW92ZU9ic2VydmVyKG9ic2VydmVyOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQ7XG4gIC8qKiBTZW5kIGEgYG1lc3NhZ2VgIHRvIHRoZSBgdGFyZ2V0YCAqL1xuICBzZW5kKFxuICAgIG1lc3NhZ2U6IElNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPixcbiAgICB0YXJnZXRJZDogbnVtYmVyIHwgdHlwZW9mIEFOWV9UQVJHRVQsIHRhcmdldDogSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXI8T3V0Z29pbmdEYXRhTWFwVCwgU291cmNlVD4sXG4gICAgc291cmNlOiBTb3VyY2VULFxuICApOiB2b2lkO1xuICAvKiogVGVhciBkb3duIHRoaXMgbWVzc2VuZ2VyICovXG4gIGRpc3Bvc2UoKTogdm9pZDtcbn1cblxuLyoqXG4gKiBBIHNwZWNpYWwgaWQgdG8gc3ltYm9saXplIHRoZSBtZXNzYWdlIHNob3VsZCBnbyB0byBhbGwgb3RoZXIgYElVbmRpcmVjdGVkTGlzdGVuZXJzYC5cbiAqIEZvciB1c2Ugd2l0aCBgSVVuZGlyZWN0ZWRNZXNzZW5nZXJgIGFuZCBgSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXJgLlxuICovXG5leHBvcnQgY29uc3QgQU5ZX1RBUkdFVCA9IC0xO1xuXG4vKipcbiAqIEEgYnJpZGdlIGJldHdlZW4gYSBtZXNzZW5nZXIgYW5kIHRoZSB1bmRlcmx5aW5nIG1lc3NhZ2UgcmVjZWl2aW5nIG1lY2hhbmlzbSwgYWxsb3dpbmcgdGhlIG1lc3NlbmdlciB0byBiZSBtb3JlIGdlbmVyaWNcbiAqIFVzZWZ1bCBpbiBhYnN0cmFjdGluZyBhd2F5IHNvbWV0aGluZyBsaWtlIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyIGZyb20gYW4gYElNZXNzZW5nZXJgXG4gKlxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lcjxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbj4ge1xuICAvKiogVHVybiBvbiB0aGUgYWJpbGl0eSB0byByZWNlaXZlIG1lc3NhZ2VzIGZyb20gYW5vdGhlciBjbGllbnQgKi9cbiAgbGlzdGVuKG9ic2VydmVyOiBJT2JzZXJ2ZXI8W0lCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgQ2xpZW50SW5mb10+KTogdm9pZDtcbiAgLyoqIFR1cm4gb2ZmIHRoZSBhYmlsaXR5IHRvIHJlY2VpdmUgbWVzc2FnZXMgKi9cbiAgc3RvcExpc3RlbmluZygpOiB2b2lkO1xufVxuXG4vKipcbiAqIEEgYnJpZGdlIGJldHdlZW4gYSBtZXNzZW5nZXIgYW5kIHRoZSB1bmRlcmx5aW5nIG1lc3NhZ2Ugc2VuZGluZyBtZWNoYW5pc20sIGFsbG93aW5nIHRoZSBtZXNzZW5nZXIgdG8gYmUgbW9yZSBnZW5lcmljXG4gKiBVc2VmdWwgaW4gYWJzdHJhY3RpbmcgYXdheSBzb21ldGhpbmcgbGlrZSB3aW5kb3cucG9zdE1lc3NhZ2UgZnJvbSBhbiBgSU1lc3NlbmdlcmBcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcjxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbiAgU291cmNlVCxcbj4ge1xuICAvKiogU2VuZCBtZXNzYWdlIHRvIHRoZSBjbGllbnQgKi9cbiAgc2VuZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4sIHNvdXJjZTogU291cmNlVCk6IHZvaWQ7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgZGF0YSBmb3IgZWFjaCBtZXNzYWdlIChib3RoIG91dGdvaW5nIGFuZCBpbmNvbWluZylcbiAqXG4gKiBAcGFyYW0gTWVzc2FnZVR5cGUgVGhlIHR5cGUgb2YgdGhlIG1lc3NhZ2VcbiAqIEBwYXJhbSBQYXlsb2FkTWFwIFRoZSBtYXAgYmV0d2VlbiBtZXNzYWdlIHR5cGVzIGFuZCB0aGVpciBwYXlsb2Fkc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElNZXNzYWdlPFxuICBNZXNzYWdlVHlwZSBleHRlbmRzIGtleW9mIFBheWxvYWRNYXBULFxuICBQYXlsb2FkTWFwVCxcbj4ge1xuICAvKiogVGhlIHNwZWNpZmljIHR5cGUgb2YgbWVzc2FnZSAqL1xuICB0eXBlOiBNZXNzYWdlVHlwZTtcbiAgLyoqIFRoZSBkYXRhIHRvIHNlbmQgKi9cbiAgcGF5bG9hZDogUGF5bG9hZE1hcFRbTWVzc2FnZVR5cGVdO1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGRhdGEgZm9yIGVhY2ggbG93ZXIgbGV2ZWwgbWVzc2FnZSB0eXBlcyBiZWluZyByZWNlaXZlZCBieSB0aGUgYnJpZGdlc1xuICpcbiAqIEBwYXJhbSBNZXNzYWdlVHlwZSBUaGUgdHlwZSBvZiB0aGUgbWVzc2FnZVxuICogQHBhcmFtIFBheWxvYWRNYXAgVGhlIG1hcCBiZXR3ZWVuIG1lc3NhZ2UgdHlwZXMgYW5kIHRoZWlyIHBheWxvYWRzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUJyaWRnZU1lc3NhZ2U8XG4gIE1lc3NhZ2VUeXBlIGV4dGVuZHMga2V5b2YgUGF5bG9hZE1hcFQsXG4gIFBheWxvYWRNYXBULFxuPiB7XG4gIC8qKiBUaGUgc3BlY2lmaWMgdHlwZSBvZiBtZXNzYWdlICovXG4gIHR5cGU6IE1lc3NhZ2VUeXBlO1xuICAvKiogVGhlIGRhdGEgcmVjZWl2ZWQgKi9cbiAgcGF5bG9hZDogUGF5bG9hZE1hcFRbTWVzc2FnZVR5cGVdO1xuICAvKiogVGhlIHRpbWVzdGFtcCBvZiB3aGVuIHRoZSBtZXNzYWdlIHdhcyBzZW50ICovXG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICAvKiogVGhlIGlkIG9mIHRoZSBjbGllbnQgc2VuZGluZyB0aGUgbWVzc2FnZSAqL1xuICBmcm9tSWQ6IG51bWJlcjtcbiAgLyoqIFRoZSBpZCBvZiB0aGUgY2xpZW50IHRoYXQgc2hvdWxkIHJlY2VpdmUgdGhpcyBtZXNzYWdlICovXG4gIHRvSWQ6IG51bWJlciB8IG51bWJlcltdO1xufVxuIiwiaW1wb3J0IHsgUG9zdE1lc3NhZ2VGYWN0b3J5LCBQb3N0TWVzc2FnZUxpc3RlbmVyLCBQb3N0TWVzc2FnZVNlbmRlciwgVW5kaXJlY3RlZE1lc3NlbmdlciB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7XG4gIElTZGtDb25uZWN0b3J9IGZyb20gJy4vTVBfU0RLJztcbmltcG9ydCB7XG4gIE1QX1NESyxcbn0gZnJvbSAnLi9NUF9TREsnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0UmVzcG9uc2UgfSBmcm9tICcuL0Nvbm5lY3Rvcic7XG5pbXBvcnQgeyBDb25uZWN0b3IgfSBmcm9tICcuL0Nvbm5lY3Rvcic7XG5pbXBvcnQgdHlwZSB7IEluY29taW5nRGF0YU1hcCwgT3V0Z29pbmdEYXRhTWFwIH0gZnJvbSAnLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBNcFNkaywgQ29ubmVjdE9wdGlvbnMgfSBmcm9tICdAc2RrL3R5cGVzJztcblxuZXhwb3J0IGNvbnN0IHZlcnNpb24gPSAnMy4wJztcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25uZWN0KHRhcmdldFdpbmRvdzogSFRNTElGcmFtZUVsZW1lbnQsIG9wdGlvbnM6IFBhcnRpYWw8Q29ubmVjdE9wdGlvbnM+ID0ge30pOiBQcm9taXNlPE1wU2RrPiB7XG4gIGNvbnN0IHRhcmdldCA9IGdldFdpbmRvdyh0YXJnZXRXaW5kb3cpO1xuICBpZiAoIXRhcmdldCkgcmV0dXJuIFByb21pc2UucmVqZWN0KCdpbnZhbGlkIHdpbmRvdycpO1xuXG4gIC8vIGNyZWF0ZSBhIHdheSB0byBjcmVhdGUgY29tbXVuaWNhdGlvbiBjaGFubmVscyAoSU1lc3NhZ2UpIGFuZCBzZXQgdXAgYSBQb3N0TWVzc2FnZSB0byB1c2UgZm9yIGNvbm5lY3RpbmdcbiAgY29uc3Qgc291cmNlSWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKTsgLy8gYSB0ZW1wIGlkIHRvIHVzZSB3aGlsZSBjb25uZWN0aW5nXG4gIGNvbnN0IHBvc3RNZXNzYWdlTGlzdGVuZXIgPSBuZXcgUG9zdE1lc3NhZ2VMaXN0ZW5lcjxJbmNvbWluZ0RhdGFNYXA+KHdpbmRvdyk7XG4gIGNvbnN0IHBvc3RNZXNhZ2VTZW5kZXIgPSBuZXcgUG9zdE1lc3NhZ2VTZW5kZXI8T3V0Z29pbmdEYXRhTWFwPih0YXJnZXQpO1xuICBjb25zdCBwb3N0TWVzc2FnZSA9IG5ldyBVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwLCBXaW5kb3c+KHNvdXJjZUlkLCBwb3N0TWVzc2FnZUxpc3RlbmVyKTtcbiAgcG9zdE1lc3NhZ2UuaW5pdCgpO1xuXG4gIC8vIGNvbm5lY3RcbiAgY29uc3QgY29ubmVjdG9yID0gbmV3IENvbm5lY3RvcjxXaW5kb3c+KHBvc3RNZXNzYWdlLCBwb3N0TWVzYWdlU2VuZGVyLCB3aW5kb3cpO1xuICByZXR1cm4gTVBfU0RLLmNvbm5lY3QobmV3IEVtYmVkQ29ubmVjdG9yKGNvbm5lY3RvciwgcG9zdE1lc3NhZ2UsIG9wdGlvbnMpLCBuZXcgRW1iZWRNZXNzZW5nZXJGYWN0b3J5RmV0Y2hlcih0YXJnZXQpLCB3aW5kb3cpO1xufVxuXG5mdW5jdGlvbiBnZXRXaW5kb3coZWxlbWVudDogSFRNTElGcmFtZUVsZW1lbnQpOiBXaW5kb3cgfCBudWxsIHtcbiAgaWYgKGVsZW1lbnQuY29udGVudFdpbmRvdykgcmV0dXJuIGVsZW1lbnQuY29udGVudFdpbmRvdztcbiAgcmV0dXJuIG51bGw7XG59XG5cbmNsYXNzIEVtYmVkQ29ubmVjdG9yIGltcGxlbWVudHMgSVNka0Nvbm5lY3RvcjxDb25uZWN0UmVzcG9uc2U+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBjb25uZWN0b3I6IENvbm5lY3RvcjxXaW5kb3c+LFxuICAgIHByaXZhdGUgcG9zdE1lc3NhZ2U6IFVuZGlyZWN0ZWRNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwLCBJbmNvbWluZ0RhdGFNYXAsIFdpbmRvdz4sXG4gICAgcHJpdmF0ZSBvcHRpb25zOiBQYXJ0aWFsPENvbm5lY3RPcHRpb25zPixcbiAgKSB7fVxuICBwdWJsaWMgY29ubmVjdCgpIHtcbiAgICByZXR1cm4gdGhpcy5jb25uZWN0b3IuY29ubmVjdCh2ZXJzaW9uLCB0aGlzLm9wdGlvbnMpO1xuICB9XG5cbiAgcHVibGljIGNhbmNlbENvbm5lY3RpbmcoKSB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZS5kaXNwb3NlKCk7XG4gIH1cbn1cblxuY2xhc3MgRW1iZWRNZXNzZW5nZXJGYWN0b3J5RmV0Y2hlciB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdGFyZ2V0OiBXaW5kb3cpIHt9XG4gIHB1YmxpYyBnZXRGYWN0b3J5KGNvbm5lY3RSZXNwb25zZTogQ29ubmVjdFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIG5ldyBQb3N0TWVzc2FnZUZhY3RvcnkoY29ubmVjdFJlc3BvbnNlLnNvdXJjZUlkLCB3aW5kb3csIGNvbm5lY3RSZXNwb25zZS50YXJnZXRJZCwgdGhpcy50YXJnZXQsIGNvbm5lY3RSZXNwb25zZS50YXJnZXRPcmlnaW4pO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IElNZXNzYWdlIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgSGFuZHNoYWtlUGF5bG9hZCwgSW5jb21pbmdEYXRhTWFwfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgSW5jb21pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBIYW5kc2hha2VNZXNzYWdlIGltcGxlbWVudHMgSU1lc3NhZ2U8SW5jb21pbmdNZXNzYWdlVHlwZS5IQU5EU0hBS0UsIEluY29taW5nRGF0YU1hcD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgdHlwZSA9IEluY29taW5nTWVzc2FnZVR5cGUuSEFORFNIQUtFO1xuICBwdWJsaWMgcmVhZG9ubHkgcGF5bG9hZDogSGFuZHNoYWtlUGF5bG9hZDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnBheWxvYWQgPSB7fTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBJTWVzc2FnZSB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IEFjY2VwdFBheWxvYWQsIEluY29taW5nRGF0YU1hcH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IEluY29taW5nTWVzc2FnZVR5cGUgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQWNjZXB0TWVzc2FnZSBpbXBsZW1lbnRzIElNZXNzYWdlPEluY29taW5nTWVzc2FnZVR5cGUuQUNDRVBULCBJbmNvbWluZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IHR5cGUgPSBJbmNvbWluZ01lc3NhZ2VUeXBlLkFDQ0VQVDtcbiAgcHVibGljIHJlYWRvbmx5IHBheWxvYWQ6IEFjY2VwdFBheWxvYWQ7XG5cbiAgLy8gVE9PRCAoc2RrIDEueCBzdXBwb3J0KTogU0RLIGJvb3RzdHJhcCAxLnggZXhwZWN0cyB0aGUgYGludGVyZmFjZWAgdG8gYmUgYXQgdGhlIHJvb3Qgb2YgdGhlIG1lc3NhZ2VzXG4gIHB1YmxpYyBpbnRlcmZhY2U6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuXG4gIGNvbnN0cnVjdG9yKHNjcmlwdFVybDogc3RyaW5nLCBjbGllbnRJbnRlcmZhY2U6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LCBzb3VyY2VJZDogbnVtYmVyLCB0YXJnZXRJZDogbnVtYmVyLCB0YXJnZXRPcmlnaW46IHN0cmluZykge1xuICAgIHRoaXMucGF5bG9hZCA9IHtcbiAgICAgIHNjcmlwdFVybCxcbiAgICAgIGludGVyZmFjZTogY2xpZW50SW50ZXJmYWNlLFxuICAgICAgc291cmNlSWQsXG4gICAgICB0YXJnZXRJZCxcbiAgICAgIHRhcmdldE9yaWdpbixcbiAgICB9O1xuICAgIHRoaXMuaW50ZXJmYWNlID0gY2xpZW50SW50ZXJmYWNlO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IElNZXNzYWdlIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgSW5jb21pbmdEYXRhTWFwLCBSZWplY3RQYXlsb2FkIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IEluY29taW5nTWVzc2FnZVR5cGUgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUmVqZWN0TWVzc2FnZSBpbXBsZW1lbnRzIElNZXNzYWdlPEluY29taW5nTWVzc2FnZVR5cGUuUkVKRUNULCBJbmNvbWluZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IHR5cGUgPSBJbmNvbWluZ01lc3NhZ2VUeXBlLlJFSkVDVDtcbiAgcHVibGljIHJlYWRvbmx5IHBheWxvYWQ6IFJlamVjdFBheWxvYWQ7XG5cbiAgLy8gVE9PRCAoc2RrIDEueCBzdXBwb3J0KTogU0RLIGJvb3RzdHJhcCAxLnggZXhwZWN0cyB0aGUgYHJlYXNvbmAgdG8gYmUgYXQgdGhlIHJvb3Qgb2YgdGhlIG1lc3NhZ2VzXG4gIHB1YmxpYyByZWFzb246IHN0cmluZztcbiAgY29uc3RydWN0b3IocmVhc29uOiBzdHJpbmcpIHtcbiAgICB0aGlzLnBheWxvYWQgPSB7XG4gICAgICByZWFzb24sXG4gICAgfTtcbiAgICB0aGlzLnJlYXNvbiA9IHJlYXNvbjtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBDbGllbnRJbmZvLCBJTWVzc2FnZU9ic2VydmVyIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgT3V0Z29pbmdEYXRhTWFwLCBDb25uZWN0UGF5bG9hZCB9IGZyb20gJ0BzZGsvYm9vdHN0cmFwJztcbmltcG9ydCB7IE91dGdvaW5nTWVzc2FnZVR5cGUgfSBmcm9tICdAc2RrL2Jvb3RzdHJhcCc7XG5cbi8qKlxuICogQW4gb2JzZXJ2ZXIgdGhhdCByZWNlaXZlcyBgQ29ubmVjdFBheWxvYWRgIG9iamVjdHMgaW4gaXRzIGBvbkNvbm5lY3Rpb25SZWNlaXZlZGAgY2FsbGJhY2tcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJQ29ubmVjdE9ic2VydmVyPFQgZXh0ZW5kcyBDbGllbnRJbmZvPiB7XG4gIG9uQ29ubmVjdGlvblJlY2VpdmVkKGNvbm5lY3Q6IENvbm5lY3RQYXlsb2FkLCBjbGllbnRJbmZvOiBUKTogdm9pZDtcbn1cblxuLyoqXG4gKiBBbiBhZGFwdG9yIHRvIG1ha2UgYW4gYElDb25uZWN0T2JzZXJ2ZXJgIGxvb2sgbGlrZSBhbiBgSU1lc3NhZ2VPYnNlcnZlcmAgKHdpdGggYSBgbm90aWZ5YCBmdW5jdGlvbilcbiAqIENhbGxzIHRoZSBpbnB1dCBvYmplY3QncyBgb25Db25uZWN0aW9uUmVjZWl2ZWRgIHdoZW4gYSBgQ09OTkVDVGAgbWVzc2FnZSBpcyByZWNlaXZlZCBvbiB0aGUgYElNZXNzZW5nZXJgIHRoaXMgaXMgcmVnaXN0ZXJlZCB3aXRoLlxuICovXG5leHBvcnQgY2xhc3MgQ29ubmVjdE1lc3NhZ2VPYnNlcnZlcjxUIGV4dGVuZHMgQ2xpZW50SW5mbz4gaW1wbGVtZW50cyBJTWVzc2FnZU9ic2VydmVyPE91dGdvaW5nTWVzc2FnZVR5cGUuQ09OTkVDVCwgT3V0Z29pbmdEYXRhTWFwLCBUPiB7XG4gIHB1YmxpYyByZWFkb25seSBtZXNzYWdlVHlwZSA9IE91dGdvaW5nTWVzc2FnZVR5cGUuQ09OTkVDVDtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWNlaXZlcjogSUNvbm5lY3RPYnNlcnZlcjxUPikge31cblxuICBwdWJsaWMgbm90aWZ5KGNvbm5lY3Q6IENvbm5lY3RQYXlsb2FkLCBjbGllbnRJbmZvOiBUKTogdm9pZCB7XG4gICAgdGhpcy5yZWNlaXZlci5vbkNvbm5lY3Rpb25SZWNlaXZlZChjb25uZWN0LCBjbGllbnRJbmZvKTtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==