(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[710],{710:(e,s,t)=>{"use strict";t.r(s),t.d(s,{AcceptMessage:()=>D,AcceptObserver:()=>E,ConnectMessage:()=>O,ConnectMessageObserver:()=>S,HandshakeMessage:()=>P,HandshakeObserver:()=>C,IncomingMessageType:()=>w,MP_SDK:()=>p,OutgoingMessageType:()=>f,RejectMessage:()=>R,RejectObserver:()=>I,connect:()=>M,version:()=>k});class n{constructor(e){this.messageReceiver=e}notify(e,s){this.messageReceiver.onMessageReceived(e,s)}}class r{constructor(){this.values={}}add(e,s){this.getValuesAtKey(e).push(s)}remove(e,s){const t=this.values[e];if(t){const e=t.indexOf(s);e>-1&&t.splice(e,1)}}removeKey(e){delete this.values[e]}getValuesAtKey(e){const s=this.values[e]||[];return this.values[e]=s,s}valuesPerKey(e){return this.getValuesAtKey(e).length}find(e,s){return this.values[e]&&this.values[e].find(s)}get keys(){return Object.keys(this.values)}hasKey(e){return e in this.values}has(e,s){return this.hasKey(e)&&this.values[e].includes(s)}*[Symbol.iterator](){for(const e in this.values)for(const s of this.values[e])yield[e,s]}}class i{listen(){}stopListening(){}send(){throw Error("The sdk has been disconnected and can't make any new calls")}}class o{constructor(e,s,t){this.sourceId=e,this.targetId=s,this.messageBridge=t,this.observers=new r}static toFilteredMessenger(e,s,t){const n=new c(e.sourceId,e.targetId,e,s);for(const s of t)for(const t of e.observers.getValuesAtKey(s))n.addObserver(t);return n}init(){const e=new class{constructor(e){this.messenger=e}onMessageReceived(e,s){this.messenger.onMessageReceived(e,s)}}(this),s=new n(e);this.messageBridge.listen(s)}dispose(){this.messageBridge.stopListening(),this.messageBridge=new i}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e){const s=this.sourceId,t=this.targetId;this.messageBridge.send(Object.assign(Object.assign({},e),{fromId:s,toId:t,timestamp:Date.now()}))}onMessageReceived(e,s){if(!this.filterMessageId(e))return;const t=e.type,n=this.observers.getValuesAtKey(t);if(n)for(const t of n){const n=e.payload||e;t.notify(n,s,e.timestamp)}}filterMessageId(e){const s=e.toId,t=e.fromId;return s instanceof Array?s.indexOf(this.sourceId)>-1:(void 0===s||s===this.sourceId)&&t===this.targetId}}class c extends o{constructor(e,s,t,n){super(e,s,new i),this.messenger=t,this.sendFilter=n,this.errorBridge=new i}send(e){this.sendFilter.includes(e.type)?this.messenger.send(e):this.errorBridge.send()}}class a{constructor(e,s){this.sourceId=e,this.listenerBridge=s,this.observers=new r}init(){const e=new class{constructor(e){this.messenger=e}onMessageReceived(e,s){this.messenger.onMessageReceived(e,s)}}(this),s=new n(e);this.listenerBridge.listen(s)}dispose(){this.listenerBridge.stopListening()}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e,s,t,n){t.send(Object.assign(Object.assign({},e),{fromId:this.sourceId,toId:s,timestamp:Date.now()}),n)}onMessageReceived(e,s){const t=e.type,n=this.observers.getValuesAtKey(t);if(n)for(const t of n){const n=e.payload||e;t.notify(n,s,e.timestamp)}}}class h{constructor(e){this.targetWindow=e,this.messageObserver=null,this.onMessage=e=>{if(this.messageObserver){const s=e.data;this.messageObserver.notify(Object.assign({},s),{id:s.fromId,origin:e.origin,source:e.source},e.data.timestamp)}}}listen(e){this.messageObserver||(this.messageObserver=e,this.targetWindow.addEventListener("message",this.onMessage))}stopListening(){this.targetWindow.removeEventListener("message",this.onMessage),this.messageObserver=null}}class d{constructor(e,s="*"){this.targetWindow=e,this.targetOrigin=s}send(e,s){this.targetWindow.postMessage(e,this.targetOrigin)}}class l{constructor(e,s,t="*"){this.sourceWindow=e,this.listener=new h(e),this.sender=new d(s,t)}listen(e){this.listener.listen(e)}stopListening(){this.listener.stopListening()}send(e){this.sender.send(e,this.sourceWindow)}}class g{constructor(e,s,t,n,r="*"){this.sourceId=e,this.sourceWindow=s,this.targetId=t,this.targetWindow=n,this.targetOrigin=r}createMessenger(){const e=new l(this.sourceWindow,this.targetWindow,this.targetOrigin);return new o(this.sourceId,this.targetId,e)}}var u=function(e,s,t,n){return new(t||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var s;e.done?r(e.value):(s=e.value,s instanceof t?s:new t((function(e){e(s)}))).then(o,c)}a((n=n.apply(e,s||[])).next())}))};class v{constructor(){this.libraryCache=new Map}load(e,s){const t=this.libraryCache.get(e)||new m(e,s);return this.libraryCache.set(e,t),t.library}}class m{constructor(e,s){this._libraryPromise=new Promise(((e,s)=>{this.libraryResolver=e,this.libraryRejecter=s})),this.fetch(e,s)}fetch(e,s){return u(this,void 0,void 0,(function*(){try{const t=yield import(e),n=Object.assign({},t);if(s&&s in window){const e=window[s]||{};Object.assign(n,e),delete window[s]}this.libraryResolver(n)}catch(e){this.libraryRejecter(e)}}))}get library(){return this._libraryPromise}}var p,f,w,y,b=function(e,s,t,n){return new(t||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var s;e.done?r(e.value):(s=e.value,s instanceof t?s:new t((function(e){e(s)}))).then(o,c)}a((n=n.apply(e,s||[])).next())}))};!function(e){const s=new v;e.connect=function(e,t,n){return b(this,void 0,void 0,(function*(){let r;try{r=yield e.connect()}finally{e.cancelConnecting()}const i=yield function(e){return b(this,void 0,void 0,(function*(){if(!e)throw new Error("Unabled to load the sdk");try{const t=yield s.load(e,"sdk-client");if(t&&t.SdkBuilder&&"function"==typeof t.SdkBuilder)return t.SdkBuilder}catch(e){}throw Error(`Could not load the sdk from ${e}`)}))}(r.scriptUrl),o=t.getFactory(r);return function(e,s,t,n){return new s(t,e).build(n)}(n,i,o,r.serializedInterface)}))}}(p||(p={})),function(e){e.CONNECT="postmessage.connect"}(f||(f={})),function(e){e.HANDSHAKE="postmessage.handshake",e.ACCEPT="postmessage.accept",e.REJECT="postmessage.reject"}(w||(w={}));class O{constructor(e,s={}){this.type=f.CONNECT,this.payload={bootstrapVersion:e,options:{auth:s.auth,provider:s.provider,sdkType:s.sdkType}}}}class C{constructor(e){this.receiver=e,this.messageType=w.HANDSHAKE}notify(e,s,t){this.receiver.handshake()}}class E{constructor(e){this.receiver=e,this.messageType=w.ACCEPT}notify(e,s,t){const{sourceId:n,scriptUrl:r,targetId:i,targetOrigin:o}=e,c=e.interface;this.receiver.accept(n,r,c,i,o)}}class I{constructor(e){this.receiver=e,this.messageType=w.REJECT}notify(e,s,t){this.receiver.reject(e.reason)}}!function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.HANDSHAKE=2]="HANDSHAKE",e[e.CONNECTED=3]="CONNECTED",e[e.REJECTED=4]="REJECTED"}(y||(y={}));class N{constructor(e,s,t){this.messenger=e,this.target=s,this.source=t,this.connectionState=y.IDLE,this.connectionPoll=void 0;const n=new class{constructor(e){this.connector=e}handshake(){this.connector.handshake()}accept(e,s,t,n,r){this.connector.accept(e,s,t,n,r)}reject(e){this.connector.reject(e)}}(this);this.handshakeObserver=new C(n),this.acceptObserver=new E(n),this.rejectObserver=new I(n),this.connectionPromise=new Promise(((e,s)=>{this.resolveConnection=e,this.rejectConnection=s}))}connect(e,s={}){return this.connectionState===y.IDLE&&(this.connectionState=y.CONNECTING,this.messenger.addObserver(this.handshakeObserver),this.messenger.addObserver(this.acceptObserver),this.messenger.addObserver(this.rejectObserver),this.connectionPoll=window.setInterval((()=>{this.messenger.send(new O(e,s),-1,this.target,this.source)}),500)),this.connectionPromise}cancelConnecting(){this.connectionState<y.CONNECTED&&(this.stopConnectPolling(),this.rejectConnection("User manually cancelled connection"))}handshake(){this.connectionState<y.HANDSHAKE&&(this.connectionState=y.HANDSHAKE,this.stopConnectPolling(),this.messenger.removeObserver(this.handshakeObserver))}accept(e,s,t,n,r){this.connectionState<y.CONNECTED&&(this.connectionState=y.CONNECTED,this.messenger.removeObserver(this.handshakeObserver),this.messenger.removeObserver(this.acceptObserver),this.messenger.removeObserver(this.rejectObserver),this.stopConnectPolling(),this.resolveConnection({sourceId:e,targetId:n,targetOrigin:r,scriptUrl:s,serializedInterface:t}))}reject(e){this.connectionState<y.CONNECTED&&(this.connectionState=y.REJECTED,this.messenger.removeObserver(this.handshakeObserver),this.messenger.removeObserver(this.acceptObserver),this.messenger.removeObserver(this.rejectObserver),this.stopConnectPolling(),this.rejectConnection(e))}stopConnectPolling(){clearInterval(this.connectionPoll),this.connectionPoll=void 0}}var T=function(e,s,t,n){return new(t||(t=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var s;e.done?r(e.value):(s=e.value,s instanceof t?s:new t((function(e){e(s)}))).then(o,c)}a((n=n.apply(e,s||[])).next())}))};const k="3.0";function M(e,s={}){return T(this,void 0,void 0,(function*(){const t=(n=e).contentWindow?n.contentWindow:null;var n;if(!t)return Promise.reject("invalid window");const r=Math.floor(1e6*Math.random()),i=new h(window),o=new d(t),c=new a(r,i);c.init();const l=new N(c,o,window);return p.connect(new A(l,c,s),new j(t),window)}))}class A{constructor(e,s,t){this.connector=e,this.postMessage=s,this.options=t}connect(){return this.connector.connect(k,this.options)}cancelConnecting(){this.postMessage.dispose()}}class j{constructor(e){this.target=e}getFactory(e){return new g(e.sourceId,window,e.targetId,this.target,e.targetOrigin)}}class P{constructor(){this.type=w.HANDSHAKE,this.payload={}}}class D{constructor(e,s,t,n,r){this.type=w.ACCEPT,this.payload={scriptUrl:e,interface:s,sourceId:t,targetId:n,targetOrigin:r},this.interface=s}}class R{constructor(e){this.type=w.REJECT,this.payload={reason:e},this.reason=e}}class S{constructor(e){this.receiver=e,this.messageType=f.CONNECT}notify(e,s){this.receiver.onConnectionReceived(e,s)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9NZXNzZW5nZXIvQnJpZGdlT2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvdXRpbC9EaWN0QXJyYXkvRGljdEFycmF5LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9tZXNzZW5nZXJzL2Vycm9ybWVzc2FnZS9FcnJvck1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvTWVzc2VuZ2VyL01lc3Nlbmdlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9NZXNzZW5nZXIvVW5kaXJlY3RlZE1lc3Nlbmdlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9wb3N0bWVzc2FnZS9VbmRpcmVjdGVkUG9zdE1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvcG9zdG1lc3NhZ2UvUG9zdE1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvcG9zdG1lc3NhZ2UvUG9zdE1lc3NhZ2VGYWN0b3J5LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL2R5bmFtaWMtbGliLWxvYWRlci9EeW5hbWljTGliTG9hZGVyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01QX1NESy50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlVHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvQ29ubmVjdG9yL2luZGV4LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VzL0Nvbm5lY3RNZXNzYWdlLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VPYnNlcnZlcnMvSGFuZHNoYWtlT2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvTWVzc2FnZU9ic2VydmVycy9BY2NlcHRPYnNlcnZlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlT2JzZXJ2ZXJzL1JlamVjdE9ic2VydmVyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9tZXNzZW5nZXJzL01lc3Nlbmdlci9JTWVzc2VuZ2VyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VzL0hhbmRzaGFrZU1lc3NhZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvTWVzc2FnZXMvQWNjZXB0TWVzc2FnZS50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlcy9SZWplY3RNZXNzYWdlLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VPYnNlcnZlcnMvQ29ubmVjdE9ic2VydmVyLnRzIl0sIm5hbWVzIjpbIkJyaWRnZU9ic2VydmVyIiwibWVzc2FnZVJlY2VpdmVyIiwibWVzc2FnZSIsImNsaWVudEluZm8iLCJ0aGlzIiwib25NZXNzYWdlUmVjZWl2ZWQiLCJEaWN0QXJyYXkiLCJ2YWx1ZXMiLCJrZXkiLCJ2YWx1ZSIsImdldFZhbHVlc0F0S2V5IiwicHVzaCIsInZhbHVlc0F0S2V5IiwiaWR4IiwiaW5kZXhPZiIsInNwbGljZSIsImxlbmd0aCIsInZhbEZpbmRlciIsImZpbmQiLCJPYmplY3QiLCJrZXlzIiwidmFsIiwiaGFzS2V5IiwiaW5jbHVkZXMiLCJTeW1ib2wiLCJpdGVyYXRvciIsIkVycm9yTWVzc2FnZUJyaWRnZSIsIkVycm9yIiwic291cmNlSWQiLCJ0YXJnZXRJZCIsIm1lc3NhZ2VCcmlkZ2UiLCJvYnNlcnZlcnMiLCJtZXNzZW5nZXIiLCJzZW5kRmlsdGVyIiwicmVjdkZpbHRlciIsImZpbHRlcmVkTWVzc2VuZ2VyIiwiRmlsdGVyZWRNZXNzZW5nZXIiLCJtc2dUeXBlIiwib2JzZXJ2ZXIiLCJhZGRPYnNlcnZlciIsIm1lc3NlbmdlckZhY2FkZSIsImJyaWRnZU9ic2VydmVyIiwibGlzdGVuIiwic3RvcExpc3RlbmluZyIsIm8iLCJhZGQiLCJtZXNzYWdlVHlwZSIsInJlbW92ZSIsImZyb21JZCIsInRvSWQiLCJzZW5kIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsImZpbHRlck1lc3NhZ2VJZCIsInR5cGUiLCJtZXNzYWdlT2JzZXJ2ZXJzIiwicGF5bG9hZCIsIm5vdGlmeSIsIkFycmF5IiwidW5kZWZpbmVkIiwic3VwZXIiLCJlcnJvckJyaWRnZSIsIlVuZGlyZWN0ZWRNZXNzZW5nZXIiLCJsaXN0ZW5lckJyaWRnZSIsInRhcmdldCIsInNvdXJjZSIsIlBvc3RNZXNzYWdlTGlzdGVuZXIiLCJ0YXJnZXRXaW5kb3ciLCJtZXNzYWdlT2JzZXJ2ZXIiLCJvbk1lc3NhZ2UiLCJldmVudCIsImRhdGEiLCJpZCIsIm9yaWdpbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9zdE1lc3NhZ2VTZW5kZXIiLCJ0YXJnZXRPcmlnaW4iLCJfc291cmNlIiwicG9zdE1lc3NhZ2UiLCJQb3N0TWVzc2FnZUJyaWRnZSIsInNvdXJjZVdpbmRvdyIsImxpc3RlbmVyIiwic2VuZGVyIiwiUG9zdE1lc3NhZ2VGYWN0b3J5IiwicG9zdE1lc3NhZ2VCcmlkZ2UiLCJEeW5hbWljTGliTG9hZGVyIiwibGlicmFyeUNhY2hlIiwiTWFwIiwicGF0aCIsIndpbmRvd0tleSIsInNjcmlwdEZldGNoZXIiLCJnZXQiLCJTY3JpcHRGZXRjaGVyIiwic2V0IiwibGlicmFyeSIsIl9saWJyYXJ5UHJvbWlzZSIsIlByb21pc2UiLCJyZXMiLCJyZWoiLCJsaWJyYXJ5UmVzb2x2ZXIiLCJsaWJyYXJ5UmVqZWN0ZXIiLCJmZXRjaCIsIm1vZHVsZSIsImltcG9ydCIsImxpYiIsIndpbmRvdyIsImxpYk9iamVjdCIsImFzc2lnbiIsImUiLCJNUF9TREsiLCJPdXRnb2luZ01lc3NhZ2VUeXBlIiwiSW5jb21pbmdNZXNzYWdlVHlwZSIsIkNvbm5lY3Rpb25TdGF0ZSIsImxpYkxvYWRlciIsImNvbm5lY3QiLCJjb25uZWN0b3IiLCJmYWN0b3J5RmV0Y2hlciIsIndpbmRvd0NvbnRleHQiLCJjb25uZWN0UmVzcG9uc2UiLCJjYW5jZWxDb25uZWN0aW5nIiwiYnVpbGRlciIsInVybCIsInNka0NsaWVudCIsImxvYWQiLCJTZGtCdWlsZGVyIiwiZmV0Y2hTY3JpcHQiLCJzY3JpcHRVcmwiLCJtZXNzZW5nZXJGYWN0b3J5IiwiZ2V0RmFjdG9yeSIsInNka0J1aWxkZXIiLCJzZXJpYWxpemVkSW50ZXJmYWNlIiwiYnVpbGQiLCJidWlsZEludGVyZmFjZSIsIkNvbm5lY3RNZXNzYWdlIiwiYm9vdHN0cmFwVmVyc2lvbiIsIm9wdGlvbnMiLCJDT05ORUNUIiwiYXV0aCIsInByb3ZpZGVyIiwic2RrVHlwZSIsIkhhbmRzaGFrZU9ic2VydmVyIiwicmVjZWl2ZXIiLCJIQU5EU0hBS0UiLCJfaGFuZHNoYWtlIiwiX2NsaWVudEluZm8iLCJfdGltZXN0YW1wIiwiaGFuZHNoYWtlIiwiQWNjZXB0T2JzZXJ2ZXIiLCJBQ0NFUFQiLCJhY2NlcHQiLCJpbnRlcmZhY2UiLCJSZWplY3RPYnNlcnZlciIsIlJFSkVDVCIsInJlamVjdCIsInJlYXNvbiIsIkNvbm5lY3RvciIsImNvbm5lY3Rpb25TdGF0ZSIsIklETEUiLCJjb25uZWN0aW9uUG9sbCIsImNvbm5lY3RvckZhY2FkZSIsImhhbmRzaGFrZU9ic2VydmVyIiwiYWNjZXB0T2JzZXJ2ZXIiLCJyZWplY3RPYnNlcnZlciIsImNvbm5lY3Rpb25Qcm9taXNlIiwicmVzb2x2ZUNvbm5lY3Rpb24iLCJyZWplY3RDb25uZWN0aW9uIiwidmVyc2lvbiIsIkNPTk5FQ1RJTkciLCJzZXRJbnRlcnZhbCIsIkNPTk5FQ1RFRCIsInN0b3BDb25uZWN0UG9sbGluZyIsInJlbW92ZU9ic2VydmVyIiwiUkVKRUNURUQiLCJjbGVhckludGVydmFsIiwiZWxlbWVudCIsImNvbnRlbnRXaW5kb3ciLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJwb3N0TWVzc2FnZUxpc3RlbmVyIiwicG9zdE1lc2FnZVNlbmRlciIsImluaXQiLCJFbWJlZENvbm5lY3RvciIsIkVtYmVkTWVzc2VuZ2VyRmFjdG9yeUZldGNoZXIiLCJkaXNwb3NlIiwiSGFuZHNoYWtlTWVzc2FnZSIsIkFjY2VwdE1lc3NhZ2UiLCJjbGllbnRJbnRlcmZhY2UiLCJSZWplY3RNZXNzYWdlIiwiQ29ubmVjdE1lc3NhZ2VPYnNlcnZlciIsIm9uQ29ubmVjdGlvblJlY2VpdmVkIl0sIm1hcHBpbmdzIjoia1lBV08sTUFBTUEsRUFDWCxZQUFvQkMsR0FBQSxLQUFBQSxrQkFDYixPQUFPQyxFQUF1RUMsR0FDbkZDLEtBQUtILGdCQUFnQkksa0JBQWtCSCxFQUFTQyxJQ1g3QyxNQUFNRyxFQUFiLGNBQ1UsS0FBQUMsT0FBdUMsR0FReEMsSUFBSUMsRUFBUUMsR0FDR0wsS0FBS00sZUFBZUYsR0FDNUJHLEtBQUtGLEdBU1osT0FBT0QsRUFBUUMsR0FDcEIsTUFBTUcsRUFBY1IsS0FBS0csT0FBT0MsR0FDaEMsR0FBSUksRUFBYSxDQUNmLE1BQU1DLEVBQU1ELEVBQVlFLFFBQVFMLEdBQzVCSSxHQUFPLEdBQ1RELEVBQVlHLE9BQU9GLEVBQUssSUFTdkIsVUFBVUwsVUFDUkosS0FBS0csT0FBT0MsR0FTZCxlQUFlQSxHQUNwQixNQUFNSSxFQUFjUixLQUFLRyxPQUFPQyxJQUFRLEdBRXhDLE9BREFKLEtBQUtHLE9BQU9DLEdBQU9JLEVBQ1pBLEVBUUYsYUFBYUosR0FDbEIsT0FBT0osS0FBS00sZUFBZUYsR0FBS1EsT0FHM0IsS0FBS1Is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QUFqRyxZQUFja0UsRUFBb0IwQixRQUczQyxPQUFPdEIsRUFBeUJqSCxHQUNyQ0MsS0FBSzJJLFNBQVNpRCxxQkFBcUI1RSxFQUFTakgiLCJmaWxlIjoiNzEwLmluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBJT2JzZXJ2ZXIsIElCcmlkZ2VNZXNzYWdlIH0gZnJvbSAnLi9JTWVzc2VuZ2VyJztcbmltcG9ydCB0eXBlIHsgSW5kZXhLZXkgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IENsaWVudEluZm8gfSBmcm9tICcuLic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NhZ2VSZWNlaXZlcjxJbmNvbWluZ0RhdGFNYXBUPiB7XG4gIG9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbyk6IHZvaWQ7XG59XG5cbi8qKlxuICogQW4gb2JzZXJ2ZXIgdXNlZCBzcGVjaWZpY2FsbHkgZm9yIGJpbmRpbmcgYW4gSU1lc3NlbmdlciB0byBhbiBJTWVzc2VuZ2VyQnJpZGdlXG4gKi9cbmV4cG9ydCBjbGFzcyBCcmlkZ2VPYnNlcnZlcjxJbmNvbWluZ0RhdGFNYXBUPiBpbXBsZW1lbnRzIElPYnNlcnZlcjxbSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBDbGllbnRJbmZvXT4ge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lc3NhZ2VSZWNlaXZlcjogSU1lc3NhZ2VSZWNlaXZlcjxJbmNvbWluZ0RhdGFNYXBUPikgeyB9XG4gIHB1YmxpYyBub3RpZnkobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKTogdm9pZCB7XG4gICAgdGhpcy5tZXNzYWdlUmVjZWl2ZXIub25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZSwgY2xpZW50SW5mbyk7XG4gIH1cbn1cbiIsIi8qKlxuICogQSBkaWN0aW9uYXJ5IGxpa2Ugb2JqZWN0IG9mIGFycmF5c1xuICovXG5leHBvcnQgY2xhc3MgRGljdEFycmF5PEsgZXh0ZW5kcyBzdHJpbmcgfCBudW1iZXIsIFY+IHtcbiAgcHJpdmF0ZSB2YWx1ZXM6IFJlY29yZDxzdHJpbmcgfCBudW1iZXIsIFZbXT4gPSB7fTtcblxuICAvKipcbiAgICogQWRkIGFuIGVudHJ5IHRvIHRoZSBhcnJheSBhdCBga2V5YFxuICAgKlxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKiBAcGFyYW0ge1Z9IHZhbHVlXG4gICAqL1xuICBwdWJsaWMgYWRkKGtleTogSywgdmFsdWU6IFYpOiB2b2lkIHtcbiAgICBjb25zdCB2YWx1ZXNBdEtleSA9IHRoaXMuZ2V0VmFsdWVzQXRLZXkoa2V5KTtcbiAgICB2YWx1ZXNBdEtleS5wdXNoKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYW4gZW50cnkgZnJvbSB0aGUgYXJyYXkgYXQgYGtleWBcbiAgICpcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICogQHBhcmFtIHtWfSB2YWx1ZVxuICAgKi9cbiAgcHVibGljIHJlbW92ZShrZXk6IEssIHZhbHVlOiBWKTogdm9pZCB7XG4gICAgY29uc3QgdmFsdWVzQXRLZXkgPSB0aGlzLnZhbHVlc1trZXldO1xuICAgIGlmICh2YWx1ZXNBdEtleSkge1xuICAgICAgY29uc3QgaWR4ID0gdmFsdWVzQXRLZXkuaW5kZXhPZih2YWx1ZSk7XG4gICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgdmFsdWVzQXRLZXkuc3BsaWNlKGlkeCwgMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbGwgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCBga2V5YFxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKi9cbiAgcHVibGljIHJlbW92ZUtleShrZXk6IEspOiB2b2lkIHtcbiAgICBkZWxldGUgdGhpcy52YWx1ZXNba2V5XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGFycmF5IG9mIHZhbHVlcyBhdCBga2V5YFxuICAgKiBXaWxsIGFsd2F5cyByZXR1cm4gYXQgbGVhc3QgYW4gZW1wdHkgYXJyYXlcbiAgICpcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICovXG4gIHB1YmxpYyBnZXRWYWx1ZXNBdEtleShrZXk6IEspOiBWW10ge1xuICAgIGNvbnN0IHZhbHVlc0F0S2V5ID0gdGhpcy52YWx1ZXNba2V5XSB8fCBbXTtcbiAgICB0aGlzLnZhbHVlc1trZXldID0gdmFsdWVzQXRLZXk7XG4gICAgcmV0dXJuIHZhbHVlc0F0S2V5IGFzIFZbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGNvdW50IG9mIHZhbHVlcyBhdCBga2V5YFxuICAgKlxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKi9cbiAgcHVibGljIHZhbHVlc1BlcktleShrZXk6IEspOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmdldFZhbHVlc0F0S2V5KGtleSkubGVuZ3RoO1xuICB9XG5cbiAgcHVibGljIGZpbmQoa2V5OiBLLCB2YWxGaW5kZXI6ICh2YWw6IFYpID0+IGJvb2xlYW4pOiBWIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZXNba2V5XSAmJiB0aGlzLnZhbHVlc1trZXldLmZpbmQodmFsRmluZGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gaXRlcmF0b3Igb3ZlciB0aGUga2V5cyBpbiB0aGlzIGBEaWN0QXJyYXlgXG4gICAqL1xuICBwdWJsaWMgZ2V0IGtleXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnZhbHVlcyk7XG4gIH1cblxuICAvKipcbiAgICogVGVzdCBpZiBga2V5YCBpcyBpbiB0aGlzIGBEaWN0QXJyYXlgXG4gICAqIEBwYXJhbSB7S30ga2V5XG4gICAqL1xuICBwdWJsaWMgaGFzS2V5KGtleTogSyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBrZXkgaW4gdGhpcy52YWx1ZXM7XG4gIH1cblxuICAvKipcbiAgICogVGVzdCBpZiBhIGtleS12YWx1ZSBwYWlyIGlzIGluIHRoaXMgYERpY3RBcnJheWBcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICogQHBhcmFtIHtWfSB2YWxcbiAgICovXG4gIHB1YmxpYyBoYXMoa2V5OiBLLCB2YWw6IFYpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5oYXNLZXkoa2V5KSAmJiB0aGlzLnZhbHVlc1trZXldLmluY2x1ZGVzKHZhbCk7XG4gIH1cblxuICAvKipcbiAgICogSXRlcmF0ZSBvdmVyIGFsbCB2YWx1ZXMgaW4gdGhpcyBgRGljdEFycmF5YFxuICAgKi9cbiAgcHVibGljICpbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYWJsZUl0ZXJhdG9yPFtzdHJpbmcsIFZdPiB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy52YWx1ZXMpIHtcbiAgICAgIGZvciAoY29uc3QgdmFsIG9mIHRoaXMudmFsdWVzW2tleV0pIHtcbiAgICAgICAgeWllbGQgW2tleSwgdmFsXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckJyaWRnZSB9IGZyb20gJy4uL01lc3Nlbmdlci9JTWVzc2VuZ2VyJztcblxuLyoqXG4gKiBBY3RzIGFzIGEgTWVzc2VuZ2VyQnJpZGdlIGJ1dCB0aHJvd3MgZXJyb3JzIG9uIGFsbCBvdXRnb2luZyBjYWxscyBhbmQgbm8tb3BzIGFueSBpbmNvbWluZyBtZXNzYWdlc1xuICovXG5leHBvcnQgY2xhc3MgRXJyb3JNZXNzYWdlQnJpZGdlIGltcGxlbWVudHMgSU1lc3NlbmdlckJyaWRnZTx1bmtub3duLCB1bmtub3duPiB7XG4gIC8qKlxuICAgKiBOby1vcCBsaXN0ZW5lclxuICAgKi9cbiAgcHVibGljIGxpc3RlbigpOiB2b2lkIHt9XG5cbiAgLyoqXG4gICAqIE5vLW9wIHN0b3AgcmVjZWl2aW5nIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzdG9wTGlzdGVuaW5nKCk6IHZvaWQge31cblxuICAvKipcbiAgICogVGhyb3cgZXJyb3JzIHdoZW4gYXR0ZW1wdGluZyB0byBzZW5kIG1lc3NhZ2VzXG4gICAqL1xuICBwdWJsaWMgc2VuZCgpOiBuZXZlciB7XG4gICAgdGhyb3cgRXJyb3IoJ1RoZSBzZGsgaGFzIGJlZW4gZGlzY29ubmVjdGVkIGFuZCBjYW5cXCd0IG1ha2UgYW55IG5ldyBjYWxscycpO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7XG4gIElNZXNzZW5nZXIsIElNZXNzZW5nZXJCcmlkZ2UsXG4gIElNZXNzYWdlLCBJTWVzc2FnZU9ic2VydmVyLCBJQnJpZGdlTWVzc2FnZSxcbiAgQ2xpZW50SW5mbyxcbn0gZnJvbSAnLi9JTWVzc2VuZ2VyJztcbmltcG9ydCB7IEJyaWRnZU9ic2VydmVyIH0gZnJvbSAnLi9CcmlkZ2VPYnNlcnZlcic7XG5pbXBvcnQgeyBEaWN0QXJyYXkgfSBmcm9tICdAbXAvdXRpbC1kaWN0YXJyYXknO1xuaW1wb3J0IHR5cGUgeyBJbmRleEtleSB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IEVycm9yTWVzc2FnZUJyaWRnZSB9IGZyb20gJy4uL2Vycm9ybWVzc2FnZS9FcnJvck1lc3NhZ2VCcmlkZ2UnO1xuXG4vKipcbiAqIEEgYmktZGlyZWN0aW9uYWwgY29tbXVuaWNhdG9yIHRoYXQgY2FuXG4gKiAtIHJlY2VpdmUgbWVzc2FnZSBvZiB0eXBlIGBrZXlvZiBJbmNvbWluZ0RhdGFNYXBUYCB2aWEgb2JzZXJ2ZXJzXG4gKiAtIHNlbmQgbWVzc2FnZXMgb2YgdHlwZSBga2V5b2YgT3V0Z29pbmdEYXRhTWFwVGBcbiAqIC0gZmlsdGVycyBpbmNvbWluZyBtZXNzYWdlcyBiYXNlZCBvbiB0aGUgaWQgb2YgdGhlIGNsaWVudCBhbmQgdGhlIG1lc3NhZ2UncyB0YXJnZXRcbiAqXG4gKiBUaGUgdW5kZXJseWluZyBjb21tdW5pY2F0aW9uIG1lY2hhbmlzbXMgYXJlIGRlZmluZWQgYnkgYW4gSU1lc3NlbmdlckJyaWRnZSBwcm92aWRlZCBieSB0aGUgY3JlYXRvclxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBNZXNzZW5nZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFQsXG4+IGltcGxlbWVudHMgSU1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiB7XG5cbiAgcHJpdmF0ZSBvYnNlcnZlcnM6IERpY3RBcnJheTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4+ID0gbmV3IERpY3RBcnJheSgpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc291cmNlSWQ6IG51bWJlciwgcHJpdmF0ZSB0YXJnZXRJZDogbnVtYmVyLCBwcml2YXRlIG1lc3NhZ2VCcmlkZ2U6IElNZXNzZW5nZXJCcmlkZ2U8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4pIHsgfVxuXG4gIC8qKlxuICAgKiBDbG9uZSB0aGlzIE1lc3NlbmdlciBhcyBhbiBJTWVzc2VuZ2VyIHRoYXQgd2lsbCBvbmx5IHNlbmQgYW5kIHJlY2VpdmUgY2VydGFpbiB0eXBlcyBvZiBtZXNzYWdlc1xuICAgKiBAcGFyYW0gbWVzc2VuZ2VyXG4gICAqIEBwYXJhbSBzZW5kRmlsdGVyXG4gICAqIEBwYXJhbSByZWN2RmlsdGVyXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHRvRmlsdGVyZWRNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4oXG4gICAgbWVzc2VuZ2VyOiBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sXG4gICAgc2VuZEZpbHRlcjogQXJyYXk8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4+LFxuICAgIHJlY3ZGaWx0ZXI6IEFycmF5PEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+PixcbiAgKTogSU1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiB7XG4gICAgY29uc3QgZmlsdGVyZWRNZXNzZW5nZXIgPSBuZXcgRmlsdGVyZWRNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4obWVzc2VuZ2VyLnNvdXJjZUlkLCBtZXNzZW5nZXIudGFyZ2V0SWQsIG1lc3Nlbmdlciwgc2VuZEZpbHRlcik7XG4gICAgZm9yIChjb25zdCBtc2dUeXBlIG9mIHJlY3ZGaWx0ZXIpIHtcbiAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgbWVzc2VuZ2VyLm9ic2VydmVycy5nZXRWYWx1ZXNBdEtleShtc2dUeXBlKSkge1xuICAgICAgICBmaWx0ZXJlZE1lc3Nlbmdlci5hZGRPYnNlcnZlcihvYnNlcnZlcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbHRlcmVkTWVzc2VuZ2VyO1xuICB9XG4gIC8qKlxuICAgKiBTdGFydCBsaXN0ZW5pbmcgZm9yIGFueSBpbmNvbWluZyBtZXNzYWdlcyB2aWEgdGhlIGBtZXNzYWdlQnJpZGdlYFxuICAgKi9cbiAgcHVibGljIGluaXQoKTogdm9pZCB7XG4gICAgY2xhc3MgTWVzc2VuZ2VyRmFjYWRlIHtcbiAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVzc2VuZ2VyOiBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4pIHt9XG4gICAgICBwdWJsaWMgb25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKSB7XG4gICAgICAgIHRoaXMubWVzc2VuZ2VyLm9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2UsIGNsaWVudEluZm8pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NlbmdlckZhY2FkZSA9IG5ldyBNZXNzZW5nZXJGYWNhZGUodGhpcyk7XG4gICAgY29uc3QgYnJpZGdlT2JzZXJ2ZXIgPSBuZXcgQnJpZGdlT2JzZXJ2ZXIobWVzc2VuZ2VyRmFjYWRlKTtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2UubGlzdGVuKGJyaWRnZU9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGxpc3RlbmluZyBmb3IgbWVzc2FnZXMgYW5kIGNsZWFuIHVwIHRoaXMgTWVzc2VuZ2VyXG4gICAqL1xuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2Uuc3RvcExpc3RlbmluZygpO1xuICAgIHRoaXMubWVzc2FnZUJyaWRnZSA9IG5ldyBFcnJvck1lc3NhZ2VCcmlkZ2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnNlcnZlIGluY29taW5nIG1lc3NhZ2VzXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIGFkZE9ic2VydmVyKG86IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgdGhpcy5vYnNlcnZlcnMuYWRkKG8ubWVzc2FnZVR5cGUsIG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgYW4gb2JzZXJ2ZXIgZnJvbSByZWNlaXZpbmcgbWVzc2FnZXNcbiAgICpcbiAgICogQHBhcmFtIG9ic2VydmVyXG4gICAqL1xuICBwdWJsaWMgcmVtb3ZlT2JzZXJ2ZXIobzogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICB0aGlzLm9ic2VydmVycy5yZW1vdmUoby5tZXNzYWdlVHlwZSwgbyk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhIGBtZXNzYWdlYCB0byB0aGUgYHRhcmdldGAgb2YgdGhlIGBJTWVzc2VuZ2VyQnJpZGdlYFxuICAgKlxuICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgKi9cbiAgcHVibGljIHNlbmQobWVzc2FnZTogSU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgY29uc3QgZnJvbUlkID0gdGhpcy5zb3VyY2VJZDtcbiAgICBjb25zdCB0b0lkID0gdGhpcy50YXJnZXRJZDtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2Uuc2VuZCh7XG4gICAgICAuLi5tZXNzYWdlLFxuICAgICAgZnJvbUlkLFxuICAgICAgdG9JZCxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOb3RpZnkgYWxsIG9ic2VydmVycyBvZiBgbWVzc2FnZS50eXBlYCBvZiB0aGUgaW5jb21pbmcgYG1lc3NhZ2VgIGFmdGVyIGFueSBmaWx0ZXJpbmcgb3V0IG1lc3NhZ2VzIG5vdCBtZWFudCBmb3IgdGhpcyBNZXNzZW5nZXJcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHByaXZhdGUgb25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKSB7XG4gICAgaWYgKCF0aGlzLmZpbHRlck1lc3NhZ2VJZChtZXNzYWdlKSkgcmV0dXJuO1xuXG4gICAgY29uc3QgbWVzc2FnZVR5cGUgPSBtZXNzYWdlLnR5cGU7XG4gICAgY29uc3QgbWVzc2FnZU9ic2VydmVycyA9IHRoaXMub2JzZXJ2ZXJzLmdldFZhbHVlc0F0S2V5KG1lc3NhZ2VUeXBlKTtcbiAgICBpZiAobWVzc2FnZU9ic2VydmVycykge1xuICAgICAgZm9yIChjb25zdCBvYnNlcnZlciBvZiBtZXNzYWdlT2JzZXJ2ZXJzKSB7XG4gICAgICAgIC8vIFRPRE8gKHNkayAxLnggc3VwcG9ydCk6IFNESyBib290c3RyYXAgMS54IHB1dCB0aGUgcGF5bG9hZCBhdCB0aGUgcm9vdCBvZiB0aGUgbWVzc2FnZSwgbm90IHVuZGVyIHRoZSBgcGF5bG9hZGAgcHJvcGVydHlcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IG1lc3NhZ2UucGF5bG9hZCB8fCBtZXNzYWdlIGFzIHVua25vd24gYXMgSW5jb21pbmdEYXRhTWFwVFtFeGNsdWRlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIHN5bWJvbD5dO1xuICAgICAgICBvYnNlcnZlci5ub3RpZnkocGF5bG9hZCwgY2xpZW50SW5mbywgbWVzc2FnZS50aW1lc3RhbXApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgd2hldGhlciBgbWVzc2FnZWAgaXMgbWVhbnQgZm9yIHRoaXMgTWVzc2VuZ2VyIGFuZCBjb21lcyBmcm9tIGEga25vd24gdGFyZ2V0XG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqL1xuICBwcml2YXRlIGZpbHRlck1lc3NhZ2VJZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiBib29sZWFuIHtcbiAgICBjb25zdCB0b0lkID0gbWVzc2FnZS50b0lkO1xuICAgIGNvbnN0IGZyb21JZCA9IG1lc3NhZ2UuZnJvbUlkO1xuICAgIGlmICh0b0lkIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgIHJldHVybiB0b0lkLmluZGV4T2YodGhpcy5zb3VyY2VJZCkgPiAtMTtcbiAgICB9XG5cbiAgICAvLyBUT0RPIChzZGsgMS54IHN1cHBvcnQpOiBTREsgYm9vdHN0cmFwIDEueCBoYWQgYHRvSWRgIGFzIHVuZGVmaW5lZCBmb3IgbWVzc2FnZXNcbiAgICByZXR1cm4gKHRvSWQgPT09IHVuZGVmaW5lZCB8fCB0b0lkID09PSB0aGlzLnNvdXJjZUlkKSAmJiBmcm9tSWQgPT09IHRoaXMudGFyZ2V0SWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBBIGRlY29yYXRlZCBJTWVzc2VuZ2VyIHRoYXQgb25seSBzZW5kcyBtZXNzYWdlcyBmcm9tIGEgcHJlZGVmaW5lZCBzZXQgb2YgbWVzc2FnZSB0eXBlcyBhbmQgZXJyb3JzIG9uIG90aGVycy5cbiAqL1xuY2xhc3MgRmlsdGVyZWRNZXNzZW5nZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFRcbj4gZXh0ZW5kcyBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICBwcml2YXRlIGVycm9yQnJpZGdlOiBFcnJvck1lc3NhZ2VCcmlkZ2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgc291cmNlSWQ6IG51bWJlcixcbiAgICB0YXJnZXRJZDogbnVtYmVyLFxuICAgIHByaXZhdGUgbWVzc2VuZ2VyOiBJTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+LFxuICAgIHByaXZhdGUgc2VuZEZpbHRlcjogQXJyYXk8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4+LFxuICApIHtcbiAgICAvLyBUT0RPIChAbXAvc2RrKTogc29tZXRoaW5nIGFib3V0IHRoZSB0c2NvbmZpZyBpbiBAbXAvc2RrIHJlcXVpcmVzIGBzdXBlcmAgdG8gYmUgY2FsbGVkIGZpcnN0IHNvIHRoZSBgbmV3IEVycm9yTWVzc2FnZUJyaWRnZWAgY2FuJ3QgYmUgc2hhcmVkXG4gICAgc3VwZXIoc291cmNlSWQsIHRhcmdldElkLCBuZXcgRXJyb3JNZXNzYWdlQnJpZGdlKCkpO1xuICAgIHRoaXMuZXJyb3JCcmlkZ2UgPSBuZXcgRXJyb3JNZXNzYWdlQnJpZGdlKCk7XG4gIH1cblxuICBwdWJsaWMgc2VuZChtZXNzYWdlOiBJTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zZW5kRmlsdGVyLmluY2x1ZGVzKG1lc3NhZ2UudHlwZSkpIHtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLnNlbmQobWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZXJyb3JCcmlkZ2Uuc2VuZCgpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUge1xuICBJVW5kaXJlY3RlZE1lc3NlbmdlciwgSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lciwgSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXIsXG4gIElNZXNzYWdlLCBJTWVzc2FnZU9ic2VydmVyLCBJQnJpZGdlTWVzc2FnZSxcbiAgQ2xpZW50SW5mbyxcbn0gZnJvbSAnLi9JTWVzc2VuZ2VyJztcbmltcG9ydCB7IEJyaWRnZU9ic2VydmVyIH0gZnJvbSAnLi9CcmlkZ2VPYnNlcnZlcic7XG5pbXBvcnQgeyBEaWN0QXJyYXkgfSBmcm9tICdAbXAvdXRpbC1kaWN0YXJyYXknO1xuaW1wb3J0IHR5cGUgeyBJbmRleEtleSB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqXG4gKiBBIGJpLWRpcmVjdGlvbmFsIGNvbW11bmljYXRvciB0aGF0IGNhblxuICogLSBvcGVubHkgcmVjZWl2ZSBtZXNzYWdlcyBvZiB0eXBlIGBrZXlvZiBJbmNvbWluZ0RhdGFNYXBUYCB2aWEgb2JzZXJ2ZXJzIGZyb20gdW5zcGVjaWZpZWQgc291cmNlc1xuICogLSBzZW5kIG1lc3NhZ2VzIG9mIHR5cGUgYGtleW9mIE91dGdvaW5nRGF0YU1hcFRgIHRvIHRhcmdldHMgc3BlY2lmaWVkIHdoZW4gc2VuZGluZ1xuICpcbiAqICoqRGlmZmVycyBmcm9tIGEgc3RhbmRhcmQgYElNZXNzZW5nZXJgIGluIHRoYXQgaXQgZG9lc24ndCBrbm93IGl0J3MgY29tbXVuaWNhdGlvbiB0YXJnZXQgYXQgY29uc3RydWN0aW9uIHRpbWUqKlxuICpcbiAqIFRoZSB1bmRlcmx5aW5nIGNvbW11bmljYXRpb24gbWVjaGFuaXNtcyBhcmUgZGVmaW5lZCBieSBhbiBgSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lcmAgcHJvdmlkZWQgaW4gdGhlIGNvbnN0cnVjdG9yXG4gKiBhbmQgYnkgdGhlIGBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcmAgcHJvdmlkZWQgaW4gc2VuZFxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBjbGFzcyBVbmRpcmVjdGVkTWVzc2VuZ2VyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuICBTb3VyY2VULFxuPiBpbXBsZW1lbnRzIElVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQsIFNvdXJjZVQ+IHtcblxuICBwcml2YXRlIG9ic2VydmVyczogRGljdEFycmF5PEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPj4gPSBuZXcgRGljdEFycmF5KCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzb3VyY2VJZDogbnVtYmVyLCBwcml2YXRlIGxpc3RlbmVyQnJpZGdlOiBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPEluY29taW5nRGF0YU1hcFQ+KSB7IH1cblxuICAvKipcbiAgICogU3RhcnQgbGlzdGVuaW5nIGZvciBhbnkgaW5jb21pbmcgbWVzc2FnZXMgdmlhIHRoZSBgbGlzdGVuZXJCcmlkZ2VgXG4gICAqL1xuICBwdWJsaWMgaW5pdCgpOiB2b2lkIHtcbiAgICBjbGFzcyBVbmRpcmVjdGVkRmFjYWRlIHtcbiAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVzc2VuZ2VyOiBVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQsIFNvdXJjZVQ+KSB7fVxuICAgICAgcHVibGljIG9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbykge1xuICAgICAgICB0aGlzLm1lc3Nlbmdlci5vbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlLCBjbGllbnRJbmZvKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBtZXNzZW5nZXJGYWNhZGUgPSBuZXcgVW5kaXJlY3RlZEZhY2FkZSh0aGlzKTtcbiAgICBjb25zdCBicmlkZ2VPYnNlcnZlciA9IG5ldyBCcmlkZ2VPYnNlcnZlcihtZXNzZW5nZXJGYWNhZGUpO1xuICAgIHRoaXMubGlzdGVuZXJCcmlkZ2UubGlzdGVuKGJyaWRnZU9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGxpc3RlbmluZyBmb3IgbWVzc2FnZXMgYW5kIGNsZWFuIHVwIHRoaXMgVW5kaXJlY3RlZE1lc3NlbmdlclxuICAgKi9cbiAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lckJyaWRnZS5zdG9wTGlzdGVuaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogT2JzZXJ2ZSBpbmNvbWluZyBtZXNzYWdlc1xuICAgKlxuICAgKiBAcGFyYW0gb2JzZXJ2ZXJcbiAgICovXG4gIHB1YmxpYyBhZGRPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICB0aGlzLm9ic2VydmVycy5hZGQob2JzZXJ2ZXIubWVzc2FnZVR5cGUsIG9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGFuIG9ic2VydmVyIGZyb20gcmVjZWl2aW5nIG1lc3NhZ2VzXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIHJlbW92ZU9ic2VydmVyKG9ic2VydmVyOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQge1xuICAgIHRoaXMub2JzZXJ2ZXJzLnJlbW92ZShvYnNlcnZlci5tZXNzYWdlVHlwZSwgb2JzZXJ2ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgYSBgbWVzc2FnZWAgdG8gdGhlIGB0YXJnZXRgXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqIEBwYXJhbSB0YXJnZXRJZFxuICAgKiBAcGFyYW0gdGFyZ2V0XG4gICAqL1xuICBwdWJsaWMgc2VuZChcbiAgICBtZXNzYWdlOiBJTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4sXG4gICAgdGFyZ2V0SWQ6IG51bWJlcixcbiAgICB0YXJnZXQ6IElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPE91dGdvaW5nRGF0YU1hcFQsIHVua25vd24+LFxuICAgIHNvdXJjZTogU291cmNlVCxcbiAgKTogdm9pZCB7XG4gICAgdGFyZ2V0LnNlbmQoe1xuICAgICAgLi4ubWVzc2FnZSxcbiAgICAgIGZyb21JZDogdGhpcy5zb3VyY2VJZCxcbiAgICAgIHRvSWQ6IHRhcmdldElkLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICAvKipcbiAgICogTm90aWZ5IGFsbCBvYnNlcnZlcnMgb2YgYG1lc3NhZ2UudHlwZWAgb2YgdGhlIGluY29taW5nIGBtZXNzYWdlYFxuICAgKlxuICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgKi9cbiAgcHJpdmF0ZSBvbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4sIGNsaWVudEluZm86IENsaWVudEluZm8pOiB2b2lkIHtcbiAgICBjb25zdCBtZXNzYWdlVHlwZSA9IG1lc3NhZ2UudHlwZTtcbiAgICBjb25zdCBtZXNzYWdlT2JzZXJ2ZXJzID0gdGhpcy5vYnNlcnZlcnMuZ2V0VmFsdWVzQXRLZXkobWVzc2FnZVR5cGUpO1xuICAgIGlmIChtZXNzYWdlT2JzZXJ2ZXJzKSB7XG4gICAgICBmb3IgKGNvbnN0IG9ic2VydmVyIG9mIG1lc3NhZ2VPYnNlcnZlcnMpIHtcbiAgICAgICAgLy8gVE9ETyAoc2RrIDEueCBzdXBwb3J0KTogU0RLIEJvb3N0cmFwIDEueCBwdXQgdGhlIHBheWxvYWQgYXQgdGhlIHJvb3Qgb2YgdGhlIG1lc3NhZ2VcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IG1lc3NhZ2UucGF5bG9hZCB8fCBtZXNzYWdlIGFzIHVua25vd24gYXMgSW5jb21pbmdEYXRhTWFwVFtFeGNsdWRlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIHN5bWJvbD5dO1xuICAgICAgICBvYnNlcnZlci5ub3RpZnkocGF5bG9hZCwgY2xpZW50SW5mbywgbWVzc2FnZS50aW1lc3RhbXApO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBQb3N0TWVzc2FnZUNsaWVudEluZm8gfSBmcm9tICcuL1Bvc3RNZXNzYWdlQ2xpZW50SW5mbyc7XG5pbXBvcnQgdHlwZSB7IElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyLCBJT2JzZXJ2ZXIsIElCcmlkZ2VNZXNzYWdlLCBJTWVzc2FnZSB9IGZyb20gJy4uL01lc3Nlbmdlci9JTWVzc2VuZ2VyJztcblxuLyoqXG4gKiBCcmlkZ2VzIGFuZCBhYnN0cmFjdHMgYSB3aW5kb3cgYW5kIGl0cyBhZGRFdmVudExpc3RlbmVyIGZ1bmN0aW9uIHRvIHJlY2VpdmUgYG1lc3NhZ2VgIGV2ZW50c1xuICpcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgY2xhc3MgUG9zdE1lc3NhZ2VMaXN0ZW5lcjxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbj4gaW1wbGVtZW50cyBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPEluY29taW5nRGF0YU1hcFQ+IHtcbiAgcHJpdmF0ZSBtZXNzYWdlT2JzZXJ2ZXI6IElPYnNlcnZlcjxbSU1lc3NhZ2U8a2V5b2YgSW5jb21pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sIFBvc3RNZXNzYWdlQ2xpZW50SW5mbywgbnVtYmVyXT4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBvbk1lc3NhZ2U6IChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdGFyZ2V0V2luZG93OiBXaW5kb3cpIHtcbiAgICAvLyBzZXQgdXAgYSBjYWxsYmFjayB0byB1c2UgaW4gYHdpbmRvdy5hZGRFdmVudExpc3RlbmVyYCB0aGF0IHdpbGwgdHJpZ2dlciB0aGUgcmVnaXN0ZXJlZCBvYnNlcnZlcnNcbiAgICB0aGlzLm9uTWVzc2FnZSA9IChldmVudDogTWVzc2FnZUV2ZW50PElCcmlkZ2VNZXNzYWdlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+PikgPT4ge1xuICAgICAgaWYgKHRoaXMubWVzc2FnZU9ic2VydmVyKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBldmVudC5kYXRhO1xuICAgICAgICB0aGlzLm1lc3NhZ2VPYnNlcnZlci5ub3RpZnkoe1xuICAgICAgICAgIC8vIFRoaXMgc3ByZWFkIGlzIGtlcHQgZm9yIGJhY2t3YXJkIGNvbXBhdGlsaXR5IHdpdGggbWVzc2VuZ2VycyBjb21waWxlZCBpbnRvIG9sZGVyIHNkayBib290c3RyYXBzLi4uIHN1Y2tzXG4gICAgICAgICAgLi4ubWVzc2FnZSxcbiAgICAgICAgfSwge1xuICAgICAgICAgIGlkOiBtZXNzYWdlLmZyb21JZCxcbiAgICAgICAgICBvcmlnaW46IGV2ZW50Lm9yaWdpbixcbiAgICAgICAgICBzb3VyY2U6IGV2ZW50LnNvdXJjZSBhcyBXaW5kb3csXG4gICAgICAgIH0sIGV2ZW50LmRhdGEudGltZXN0YW1wKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHJlY2VpdmluZyBtZXNzYWdlIGV2ZW50cyBmcm9tIHBvc3RNZXNzYWdlXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIGxpc3RlbihvYnNlcnZlcjogSU9ic2VydmVyPFtJTWVzc2FnZTxrZXlvZiBJbmNvbWluZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiwgUG9zdE1lc3NhZ2VDbGllbnRJbmZvXT4pOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMubWVzc2FnZU9ic2VydmVyKSB7XG4gICAgICB0aGlzLm1lc3NhZ2VPYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy50YXJnZXRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25NZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3RvcCByZWNlaXZpbmcgbWVzc2FnZSBldmVudHMgZnJvbSBwb3N0TWVzc2FnZVxuICAgKi9cbiAgcHVibGljIHN0b3BMaXN0ZW5pbmcoKTogdm9pZCB7XG4gICAgdGhpcy50YXJnZXRXaW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMub25NZXNzYWdlKTtcbiAgICB0aGlzLm1lc3NhZ2VPYnNlcnZlciA9IG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBCcmlkZ2VzIGFuZCBhYnN0cmFjdHMgYSB3aW5kb3cgYW5kIGl0cyBwb3N0TWVzc2FnZSBmdW5jdGlvbiB0byBzZW5kIG1lc3NhZ2VzXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBjbGFzcyBQb3N0TWVzc2FnZVNlbmRlcjxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbj4gaW1wbGVtZW50cyBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcjxPdXRnb2luZ0RhdGFNYXBULCBXaW5kb3c+IHtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRhcmdldFdpbmRvdzogV2luZG93LCBwcml2YXRlIHRhcmdldE9yaWdpbjogc3RyaW5nID0gJyonKSB7IH1cblxuICAvKipcbiAgICogU2VuZCBhIG1lc3NhZ2Ugb3ZlciBwb3N0TWVzc2FnZSB0byB0aGUgYHRhcmdldFdpbmRvd2BcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzZW5kKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPGtleW9mIE91dGdvaW5nRGF0YU1hcFQsIE91dGdvaW5nRGF0YU1hcFQ+LCBfc291cmNlOiBXaW5kb3cpOiB2b2lkIHtcbiAgICB0aGlzLnRhcmdldFdpbmRvdy5wb3N0TWVzc2FnZShtZXNzYWdlLCB0aGlzLnRhcmdldE9yaWdpbik7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckJyaWRnZSwgSU1lc3NhZ2UsIElPYnNlcnZlciwgSUJyaWRnZU1lc3NhZ2UsIElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyIH0gZnJvbSAnLi4vTWVzc2VuZ2VyL0lNZXNzZW5nZXInO1xuaW1wb3J0IHsgUG9zdE1lc3NhZ2VMaXN0ZW5lciwgUG9zdE1lc3NhZ2VTZW5kZXIgfSBmcm9tICcuL1VuZGlyZWN0ZWRQb3N0TWVzc2FnZUJyaWRnZSc7XG5pbXBvcnQgdHlwZSB7IEluZGV4S2V5IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEJyaWRnZXMgYW5kIHNldHMgdXAgYSBkaXJlY3QgY2hhbm5lbCBiZXR3ZWVuIHR3byBXaW5kb3dzIHVzaW5nIHBvc3RNZXNzYWdlXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGNsYXNzIFBvc3RNZXNzYWdlQnJpZGdlPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuPiBpbXBsZW1lbnRzIElNZXNzZW5nZXJCcmlkZ2U8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICBwcml2YXRlIGxpc3RlbmVyOiBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPEluY29taW5nRGF0YU1hcFQ+O1xuICBwcml2YXRlIHNlbmRlcjogSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXI8T3V0Z29pbmdEYXRhTWFwVCwgV2luZG93PjtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvdXJjZVdpbmRvdzogV2luZG93LCB0YXJnZXRXaW5kb3c6IFdpbmRvdywgdGFyZ2V0T3JpZ2luOiBzdHJpbmcgPSAnKicpIHtcbiAgICB0aGlzLmxpc3RlbmVyID0gbmV3IFBvc3RNZXNzYWdlTGlzdGVuZXIoc291cmNlV2luZG93KTtcbiAgICB0aGlzLnNlbmRlciA9IG5ldyBQb3N0TWVzc2FnZVNlbmRlcih0YXJnZXRXaW5kb3csIHRhcmdldE9yaWdpbik7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgcmVjZWl2aW5nIG1lc3NhZ2UgZXZlbnRzIGZyb20gcG9zdE1lc3NhZ2VcbiAgICpcbiAgICogQHBhcmFtIG9ic2VydmVyXG4gICAqL1xuICBwdWJsaWMgbGlzdGVuKG9ic2VydmVyOiBJT2JzZXJ2ZXI8W0lNZXNzYWdlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+XT4pOiB2b2lkIHtcbiAgICB0aGlzLmxpc3RlbmVyLmxpc3RlbihvYnNlcnZlcik7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCByZWNlaXZpbmcgbWVzc2FnZSBldmVudHMgZnJvbSBwb3N0TWVzc2FnZVxuICAgKi9cbiAgcHVibGljIHN0b3BMaXN0ZW5pbmcoKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lci5zdG9wTGlzdGVuaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhIG1lc3NhZ2Ugb3ZlciBwb3N0TWVzc2FnZSB0byB0aGUgYHRhcmdldFdpbmRvd2BcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzZW5kKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPik6IHZvaWQge1xuICAgIHRoaXMuc2VuZGVyLnNlbmQobWVzc2FnZSwgdGhpcy5zb3VyY2VXaW5kb3cpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBNZXNzZW5nZXIgfSBmcm9tICcuLi9NZXNzZW5nZXIvTWVzc2VuZ2VyJztcbmltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckZhY3RvcnksIElNZXNzZW5nZXIgfSBmcm9tICcuLi9NZXNzZW5nZXIvSU1lc3Nlbmdlcic7XG5pbXBvcnQgeyBQb3N0TWVzc2FnZUJyaWRnZSB9IGZyb20gJy4vUG9zdE1lc3NhZ2VCcmlkZ2UnO1xuXG4vKipcbiAqIEEgc2ltcGxlIGZhY3RvcnkgdG8gY3JlYXRlIFBvc3RNZXNzYWdlIHRvIGhpZGUgYXdheSB0aGUgZGV0YWlscyBvZiBpZHMgYW5kIHNvdXJjZS9hcmdldCBXaW5kb3cgaW5mb3JtYXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIFBvc3RNZXNzYWdlRmFjdG9yeTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiBpbXBsZW1lbnRzIElNZXNzZW5nZXJGYWN0b3J5PE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+ICB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc291cmNlSWQ6IG51bWJlciwgcHJpdmF0ZSBzb3VyY2VXaW5kb3c6IFdpbmRvdyxcbiAgICBwcml2YXRlIHRhcmdldElkOiBudW1iZXIsIHByaXZhdGUgdGFyZ2V0V2luZG93OiBXaW5kb3csIHByaXZhdGUgdGFyZ2V0T3JpZ2luOiBzdHJpbmcgPSAnKicpIHsgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBQb3N0TWVzc2FnZSBjaGFubmVsXG4gICAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSB0aGUgbmV3bHkgY3JlYXRlZCBJTWVzc2VuZ2VyXG4gICAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSB0aGUgbmV3bHkgY3JlYXRlZCBJTWVzc2VuZ2VyXG4gICAqL1xuICBwdWJsaWMgY3JlYXRlTWVzc2VuZ2VyKCk6IElNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICAgIGNvbnN0IHBvc3RNZXNzYWdlQnJpZGdlID0gbmV3IFBvc3RNZXNzYWdlQnJpZGdlPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KHRoaXMuc291cmNlV2luZG93LCB0aGlzLnRhcmdldFdpbmRvdywgdGhpcy50YXJnZXRPcmlnaW4pO1xuICAgIGNvbnN0IG1lc3NlbmdlciA9IG5ldyBNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4odGhpcy5zb3VyY2VJZCwgdGhpcy50YXJnZXRJZCwgcG9zdE1lc3NhZ2VCcmlkZ2UpO1xuICAgIHJldHVybiBtZXNzZW5nZXI7XG4gIH1cbn1cbiIsIi8qKlxuICogQSBsb2FkZXIgZm9yIGZldGNoaW5nIHJlbW90ZSBzY3JpcHRzXG4gKi9cbmV4cG9ydCBjbGFzcyBEeW5hbWljTGliTG9hZGVyIHtcbiAgcHJpdmF0ZSBsaWJyYXJ5Q2FjaGUgPSBuZXcgTWFwPHN0cmluZywgU2NyaXB0RmV0Y2hlcjx1bmtub3duPj4oKTtcblxuICAvKipcbiAgICogRmV0Y2ggYSBsaWJyYXJ5IGZyb20gYHBhdGhgXG4gICAqXG4gICAqIEBwYXJhbSBwYXRoXG4gICAqIEBwYXJhbSB3aW5kb3dLZXkgSWYgV2VicGFjayBidWlsdCB0aGUgbGlicmFyeSB1c2luZyBgbGlicmFyeVRhcmdldDogJ3dpbmRvdydgLCB0aGlzIGlzIHRoZSBgbGlicmFyeWAgcGFyYW0gaW4gdGhlIHdlYnBhY2sgY29uZmlnXG4gICAqL1xuICBwdWJsaWMgbG9hZDxUPihwYXRoOiBzdHJpbmcsIHdpbmRvd0tleT86IHN0cmluZyk6IFByb21pc2U8VD4ge1xuICAgIGNvbnN0IHNjcmlwdEZldGNoZXIgPSB0aGlzLmxpYnJhcnlDYWNoZS5nZXQocGF0aCkgYXMgU2NyaXB0RmV0Y2hlcjxUPiB8fCBuZXcgU2NyaXB0RmV0Y2hlcjxUPihwYXRoLCB3aW5kb3dLZXkpO1xuICAgIHRoaXMubGlicmFyeUNhY2hlLnNldChwYXRoLCBzY3JpcHRGZXRjaGVyKTtcblxuICAgIHJldHVybiBzY3JpcHRGZXRjaGVyLmxpYnJhcnk7XG4gIH1cbn1cblxuLyoqXG4gKiBGZXRjaGVzIGEgc2NyaXB0XG4gKi9cbmNsYXNzIFNjcmlwdEZldGNoZXI8VD4ge1xuICBwcml2YXRlIGxpYnJhcnlSZXNvbHZlciE6IChsaWI6IFQpID0+IHZvaWQ7XG4gIHByaXZhdGUgbGlicmFyeVJlamVjdGVyITogKGVycjogc3RyaW5nKSA9PiB2b2lkO1xuICBwcml2YXRlIF9saWJyYXJ5UHJvbWlzZTogUHJvbWlzZTxUPjtcblxuICBjb25zdHJ1Y3RvcihwYXRoOiBzdHJpbmcsIHdpbmRvd0tleT86IHN0cmluZykge1xuICAgIHRoaXMuX2xpYnJhcnlQcm9taXNlID0gbmV3IFByb21pc2U8VD4oKHJlcywgcmVqKSA9PiB7XG4gICAgICB0aGlzLmxpYnJhcnlSZXNvbHZlciA9IHJlcztcbiAgICAgIHRoaXMubGlicmFyeVJlamVjdGVyID0gcmVqO1xuICAgIH0pO1xuICAgIHRoaXMuZmV0Y2gocGF0aCwgd2luZG93S2V5KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2gocGF0aDogc3RyaW5nLCB3aW5kb3dLZXk/OiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbW9kdWxlID0gYXdhaXQgaW1wb3J0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gcGF0aCk7XG4gICAgICBjb25zdCBsaWIgPSB7IC4uLm1vZHVsZSB9IGFzIFQ7XG5cbiAgICAgIC8vIGlmIHRoZSBgd2luZG93S2V5YCBhcmcgd2FzIHByb3ZpZGVkIGFuZCB0aGUgbGlicmFyeSdzIGNvbnRlbnRzIHdlcmUgYXR0YWNoZWQgdG8gdGhlIHdpbmRvdywgYXNzaWduIHRoYXQgdG8gdGhlIGBsaWJgIG9iamVjdFxuICAgICAgaWYgKHdpbmRvd0tleSAmJiB3aW5kb3dLZXkgaW4gd2luZG93KSB7XG4gICAgICAgIGNvbnN0IGxpYk9iamVjdCA9IHdpbmRvd1t3aW5kb3dLZXkgYXMga2V5b2YgV2luZG93XSB8fCB7fTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihsaWIsIGxpYk9iamVjdCk7XG4gICAgICAgIGRlbGV0ZSB3aW5kb3dbd2luZG93S2V5IGFzIGtleW9mIFdpbmRvd107XG4gICAgICB9XG5cbiAgICAgIHRoaXMubGlicmFyeVJlc29sdmVyKGxpYik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5saWJyYXJ5UmVqZWN0ZXIoZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEEgcHJvbWlzZSBvZiB0aGUgbGlicmFyeSBiZWluZyBsb2FkZWRcbiAgICovXG4gIHB1YmxpYyBnZXQgbGlicmFyeSgpOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5fbGlicmFyeVByb21pc2U7XG4gIH1cblxufVxuIiwiaW1wb3J0IHR5cGUgeyBDb25uZWN0UmVzcG9uc2UgfSBmcm9tICcuL0Nvbm5lY3Rvcic7XG5pbXBvcnQgdHlwZSB7IElNZXNzZW5nZXJGYWN0b3J5IH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcblxuaW1wb3J0IHR5cGUgeyBNcFNkayB9IGZyb20gJ0BzZGsvdHlwZXMnO1xuaW1wb3J0IHsgRHluYW1pY0xpYkxvYWRlciB9IGZyb20gJ2R5bmFtaWMtbGliLWxvYWRlcic7XG5cbnR5cGUgRGljdDxUID0gdW5rbm93bj4gPSBSZWNvcmQ8c3RyaW5nLCBUIHwgdW5kZWZpbmVkPjtcblxuLy8gZGVjbGFyZSBjbGFzcyBpcyBsaWtlIGRlZmluaW5nIGFuIGludGVyZmFjZSwgYnV0IGl0IGNhbiBoYXZlIGEgY29uc3RydWN0b3Jcbi8vIGl0J3Mgc2ltaWxhciB0byBgZXh0ZXJuYCwgd2hlcmUgdGhpcyBjbGFzcyBpcyBmdWxseSBkZWZpbmVkIGFuZCBpbXBsZW1lbnRlZCBlbHNld2hlcmVcbmRlY2xhcmUgY2xhc3MgU2RrQnVpbGRlcjxPdXRnb2luZ0RhdGFNYXBUID0gdW5rbm93biwgSW5jb21pbmdEYXRhTWFwVCA9IHVua25vd24+IHtcbiAgY29uc3RydWN0b3IobWVzc2VuZ2VyRmFjdG9yeTogSU1lc3NlbmdlckZhY3Rvcnk8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sIHdpbmRvd0NvbnRleHQ6IFdpbmRvdyk7XG4gIHB1YmxpYyBidWlsZChzZXJpYWxpemVkSW50ZXJmYWNlOiBEaWN0KTogTXBTZGs7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVNka0Nvbm5lY3RvcjxUIGV4dGVuZHMgQ29ubmVjdFJlc3BvbnNlPiB7XG4gIGNvbm5lY3QoKTogUHJvbWlzZTxUPjtcbiAgY2FuY2VsQ29ubmVjdGluZygpOiB2b2lkO1xufVxuXG5leHBvcnQgdHlwZSBNZXNzZW5nZXJGYWN0b3J5RmV0Y2hlcjxDb25uZWN0UmVzcG9uc2VUIGV4dGVuZHMgQ29ubmVjdFJlc3BvbnNlLCBPdXV0Z29pbmdEYXRhTWFwLCBJbmNvbWluZ0RhdGFNYXA+ID0ge1xuICBnZXRGYWN0b3J5KGNvbm5lY3RSZXNwb25zZTogQ29ubmVjdFJlc3BvbnNlVCk6IElNZXNzZW5nZXJGYWN0b3J5PE91dXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcD47XG59O1xuXG5leHBvcnQgbmFtZXNwYWNlIE1QX1NESyB7XG4gIGNvbnN0IGxpYkxvYWRlciA9IG5ldyBEeW5hbWljTGliTG9hZGVyKCk7XG4gIGV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25uZWN0PFQgZXh0ZW5kcyBDb25uZWN0UmVzcG9uc2UgPSBDb25uZWN0UmVzcG9uc2UsIE91dGdvaW5nRGF0YU1hcCA9IHVua25vd24sIEluY29taW5nRGF0YU1hcCA9IHVua25vd24+KFxuICAgIGNvbm5lY3RvcjogSVNka0Nvbm5lY3RvcjxUPixcbiAgICBmYWN0b3J5RmV0Y2hlcjogTWVzc2VuZ2VyRmFjdG9yeUZldGNoZXI8VCwgT3V0Z29pbmdEYXRhTWFwLCBJbmNvbWluZ0RhdGFNYXA+LFxuICAgIHdpbmRvd0NvbnRleHQ6IFdpbmRvdyxcbiAgKTogUHJvbWlzZTxNcFNkaz4ge1xuICAgIGxldCBjb25uZWN0UmVzcG9uc2U6IFQ7XG4gICAgdHJ5IHtcbiAgICAgIGNvbm5lY3RSZXNwb25zZSA9IGF3YWl0IGNvbm5lY3Rvci5jb25uZWN0KCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIGFmdGVyIGEgY29ubmVjdGlvbiBpcyBzdWNjZXNzZnVsIG9yIG5vdCwgc2h1dGRvd24gdGhlIGNvbm5lY3RvciBhbmQgaXRzIHBvc3RtZXNzYWdlIHJlY2VpdmluZyBtZXNzYWdlc1xuICAgICAgY29ubmVjdG9yLmNhbmNlbENvbm5lY3RpbmcoKTtcbiAgICB9XG5cbiAgICAvLyBmZXRjaCBhbmQgYnVpbGQgdGhlIGNsaWVudCBpbnRlcmZhY2VcbiAgICBjb25zdCBidWlsZGVyID0gYXdhaXQgZmV0Y2hTY3JpcHQoY29ubmVjdFJlc3BvbnNlLnNjcmlwdFVybCk7XG4gICAgLy8gc2V0IHVwIGEgZmFjdG9yeSBzbyB0aGF0IHRoZSBjbGllbnQgY2FuIGNyZWF0ZSBNZXNzZW5nZXIgY2hhbm5lbHNcbiAgICBjb25zdCBtZXNzZW5nZXJGYWN0b3J5ID0gZmFjdG9yeUZldGNoZXIuZ2V0RmFjdG9yeShjb25uZWN0UmVzcG9uc2UpO1xuICAgIC8vIGJ1aWxkIGFuZCByZXR1cm4gdGhlIGNsaWVudCBpbnRlcmZhY2UgdG8gdGhlIHVzZXJcbiAgICByZXR1cm4gYnVpbGRJbnRlcmZhY2Uod2luZG93Q29udGV4dCwgYnVpbGRlciwgbWVzc2VuZ2VyRmFjdG9yeSwgY29ubmVjdFJlc3BvbnNlLnNlcmlhbGl6ZWRJbnRlcmZhY2UpO1xuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hTY3JpcHQodXJsPzogc3RyaW5nKTogUHJvbWlzZTx0eXBlb2YgU2RrQnVpbGRlcj4ge1xuICAgIGlmICghdXJsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZWQgdG8gbG9hZCB0aGUgc2RrJyk7XG4gICAgfVxuXG4gICAgLy8gZmV0Y2ggYW5kIGNhY2hlIHRoZSBwcm9taXNlIGZvciB0aGUgcmVxdWVzdGVkIHNjcmlwdFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZGtDbGllbnQgPSBhd2FpdCBsaWJMb2FkZXIubG9hZDx7U2RrQnVpbGRlcjogdHlwZW9mIFNka0J1aWxkZXJ9Pih1cmwsICdzZGstY2xpZW50Jyk7XG4gICAgICBpZiAoc2RrQ2xpZW50ICYmIHNka0NsaWVudC5TZGtCdWlsZGVyICYmIHR5cGVvZiBzZGtDbGllbnQuU2RrQnVpbGRlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gc2RrQ2xpZW50LlNka0J1aWxkZXI7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBjYXRjaCBhbGwgYW5kIFwiaWdub3JlXCIsIHNpbmNlIHdlJ2xsIHRocm93IHNob3J0bHkgYW55d2F5XG4gICAgfVxuICAgIHRocm93IEVycm9yKGBDb3VsZCBub3QgbG9hZCB0aGUgc2RrIGZyb20gJHt1cmx9YCk7XG4gIH1cblxuICBmdW5jdGlvbiBidWlsZEludGVyZmFjZTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPihcbiAgICB3aW5kb3dDb250ZXh0OiBXaW5kb3csXG4gICAgc2RrQnVpbGRlcjogdHlwZW9mIFNka0J1aWxkZXIsXG4gICAgbWVzc2VuZ2VyRmFjdG9yeTogSU1lc3NlbmdlckZhY3Rvcnk8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sXG4gICAgc2VyaWFsaXplZEludGVyZmFjZTogRGljdCxcbiAgKTogUmV0dXJuVHlwZTxTZGtCdWlsZGVyWydidWlsZCddPiB7XG4gICAgcmV0dXJuIG5ldyBzZGtCdWlsZGVyKG1lc3NlbmdlckZhY3RvcnksIHdpbmRvd0NvbnRleHQpLmJ1aWxkKHNlcmlhbGl6ZWRJbnRlcmZhY2UpO1xuICB9XG59XG4iLCIvLyAtLS0tLS0tLS0tLS0tLS0tLSBPdXRnb2luZyBNZXNzYWdlcyAtLS0tLS0tLS0tLS0tLS0tLSAvL1xuZXhwb3J0IGVudW0gT3V0Z29pbmdNZXNzYWdlVHlwZSB7XG4gIENPTk5FQ1QgPSAncG9zdG1lc3NhZ2UuY29ubmVjdCcsXG59XG5cbi8qKlxuICogVGhlIGRhdGEgcGF5bG9hZCBvZiBhIENvbm5lY3QgbWVzc2FnZVxuICovXG5leHBvcnQgdHlwZSBDb25uZWN0UGF5bG9hZCA9IHtcbiAgLyoqIFRoZSB2ZXJzaW9uIG9mIHRoZSBzZGsgYm9vdHN0cmFwIGF0dGVtcHRpbmcgdG8gY29ubmVjdCAqL1xuICBib290c3RyYXBWZXJzaW9uOiBzdHJpbmc7XG4gIG9wdGlvbnM6IHtcbiAgICAvKiogQW4gYXV0aCB0b2tlbiAqL1xuICAgIGF1dGg/OiBzdHJpbmc7XG5cbiAgICAvKiogcHJvdmlkZXIgbmFtZSAqL1xuICAgIHByb3ZpZGVyPzogc3RyaW5nO1xuXG4gICAgc2RrVHlwZT86IHN0cmluZztcbiAgfSxcbiAgLy8gVE9ETyAoc2RrKTogc2RrIGJvb3RzdHJhcCB2Mi54IHBhc3NlZCB0aGUgYXBwbGljYXRpb25LZXk7IHJlbW92ZSB0aGlzIHdoZW4gdGhvc2UgdmVyc2lvbnMgYXJlIG5vIGxvbmdlciBzdXBwb3J0ZWRcbiAgYXBwbGljYXRpb25LZXk/OiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIEEgbWFwIGJldHdlZW4gdGhlIG91dGdvaW5nIG1lc3NhZ2VzIHR5cGVzIGFuZCB0aGUgZGF0YSBhc3NvY2lhdGVkIHdpdGggdGhlIG1lc3NhZ2VcbiAqL1xuZXhwb3J0IHR5cGUgT3V0Z29pbmdEYXRhTWFwID0ge1xuICBbT3V0Z29pbmdNZXNzYWdlVHlwZS5DT05ORUNUXTogQ29ubmVjdFBheWxvYWQsXG59O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLSBJbmNvbWluZyBNZXNzYWdlcyAtLS0tLS0tLS0tLS0tLS0tLSAvL1xuZXhwb3J0IGVudW0gSW5jb21pbmdNZXNzYWdlVHlwZSB7XG4gIEhBTkRTSEFLRSA9ICdwb3N0bWVzc2FnZS5oYW5kc2hha2UnLFxuICBBQ0NFUFQgICAgPSAncG9zdG1lc3NhZ2UuYWNjZXB0JyxcbiAgUkVKRUNUICAgID0gJ3Bvc3RtZXNzYWdlLnJlamVjdCcsXG59XG5cbi8qKlxuICogVGhlIGRhdGEgb2YgYSBtZXNzYWdlIHNpZ25hbGxpbmcgdGhhdCB0aGUgY29ubmVjdGlvbiB3YXMgKG1vc3RseSkgYWNjZXB0ZWQgYnV0IGhhc24ndCBiZWVuIGZpbmFsaXplZCB5ZXRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBIYW5kc2hha2VQYXlsb2FkIHtcbiAgLyoqIERPIE5PVCBVU0U6IFBsYWNlaG9sZGVyIHRvIG1ha2UgdGhpcyB0eXBlIHVuaXF1ZSBmcm9tIG90aGVyIG1lc3NhZ2UgRGF0YSB0eXBlcyAqL1xuICB1bnVzZWQ/OiAnaGFuZHNoYWtlLmRhdGEnO1xufVxuXG4vKipcbiAqIFRoZSBkYXRhIG9mIGEgbWVzc2FnZSBzaWduYWxsaW5nIHRoZSBjb25uZWN0aW9uIHRvIHRoZSBob3N0IHdhcyBhY2NlcHRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEFjY2VwdFBheWxvYWQge1xuICAvKiogVGhlIGlkIHRoYXQgd2FzIGFzc2lnbmVkIHRvIHRoaWUgY2xpZW50IGJlaGluZCB0aGlzIGNvbm5lY3Rpb24gKi9cbiAgc291cmNlSWQ6IG51bWJlcjtcbiAgLyoqIFRoZSByZW1vdGUgdXJsIG9mIHRoZSBjbGllbnQgc2NyaXB0IHRvIGJlIGR5bmFtaWNhbGx5IGxvYWRlZCAqL1xuICBzY3JpcHRVcmw6IHN0cmluZztcbiAgLyoqIFRoZSBzZXJpYWxpemVkIGludGVyZmFjZSB0aGF0IHRoZSBob3N0IHN1cHBvcnRzICovXG4gIGludGVyZmFjZTogUmVjb3JkPHN0cmluZywgdW5rbm93biB8IHVuZGVmaW5lZD47XG4gIC8qKiBUaGUgaWQgb2YgdGhlIGhvc3QgdGhhdCBhY2NlcHRlZCB0aGUgY29ubmVjdGlvbiAqL1xuICB0YXJnZXRJZDogbnVtYmVyO1xuICAvKiogVGhlIG9yaWdpbiBvZiB0aGUgaG9zdCB0aGF0IGFjY2VwdGVkIHRoZSBjb25uZWN0aW9uICovXG4gIHRhcmdldE9yaWdpbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIFRoZSBkYXRhIG9mIGEgbWVzc2FnZSBzaWduYWxsaW5nIHRoYXQgdGhlIGNvbm5lY3Rpb24gd2FzIHJlamVjdGVkIG9yIGZhaWxlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlamVjdFBheWxvYWQge1xuICAvKiogVGhlIGVycm9yIG1lc3NhZ2Ugd2h5IGNvbm5lY3RpbmcgZmFpbGVkICovXG4gIHJlYXNvbjogc3RyaW5nO1xufVxuXG4vKipcbiAqIEEgbWFwIGJldHdlZW4gdGhlIGluY29taW5nIG1lc3NhZ2VzIHR5cGVzIGFuZCB0aGUgZGF0YSBhc3NvY2lhdGVkIHdpdGggdGhlIG1lc3NhZ2VcbiAqL1xuZXhwb3J0IHR5cGUgSW5jb21pbmdEYXRhTWFwID0ge1xuICBbSW5jb21pbmdNZXNzYWdlVHlwZS5IQU5EU0hBS0VdOiBIYW5kc2hha2VQYXlsb2FkO1xuICBbSW5jb21pbmdNZXNzYWdlVHlwZS5BQ0NFUFRdOiBBY2NlcHRQYXlsb2FkO1xuICBbSW5jb21pbmdNZXNzYWdlVHlwZS5SRUpFQ1RdOiBSZWplY3RQYXlsb2FkO1xufTtcbiIsImltcG9ydCB0eXBlIHsgSVVuZGlyZWN0ZWRNZXNzZW5nZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHsgQU5ZX1RBUkdFVCB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IENvbm5lY3RPcHRpb25zIH0gZnJvbSAnQHNkay90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IE91dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IENvbm5lY3RNZXNzYWdlIH0gZnJvbSAnLi4vTWVzc2FnZXMvQ29ubmVjdE1lc3NhZ2UnO1xuaW1wb3J0IHsgSGFuZHNoYWtlT2JzZXJ2ZXIgfSBmcm9tICcuLi9NZXNzYWdlT2JzZXJ2ZXJzL0hhbmRzaGFrZU9ic2VydmVyJztcbmltcG9ydCB7IEFjY2VwdE9ic2VydmVyIH0gZnJvbSAnLi4vTWVzc2FnZU9ic2VydmVycy9BY2NlcHRPYnNlcnZlcic7XG5pbXBvcnQgeyBSZWplY3RPYnNlcnZlciB9IGZyb20gJy4uL01lc3NhZ2VPYnNlcnZlcnMvUmVqZWN0T2JzZXJ2ZXInO1xuXG50eXBlIERpY3Q8VCA9IHVua25vd24+ID0gUmVjb3JkPHN0cmluZywgVCB8IHVuZGVmaW5lZD47XG5cbmVudW0gQ29ubmVjdGlvblN0YXRlIHtcbiAgSURMRSxcbiAgQ09OTkVDVElORyxcbiAgSEFORFNIQUtFLFxuICBDT05ORUNURUQsXG4gIFJFSkVDVEVELFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbm5lY3RSZXNwb25zZSB7XG4gIHNvdXJjZUlkOiBudW1iZXI7XG4gIHRhcmdldElkOiBudW1iZXI7XG4gIHRhcmdldE9yaWdpbjogc3RyaW5nO1xuICBzY3JpcHRVcmw6IHN0cmluZztcbiAgc2VyaWFsaXplZEludGVyZmFjZTogRGljdDtcbn1cblxuZXhwb3J0IGNsYXNzIENvbm5lY3RvcjxTb3VyY2VUPiB7XG4gIHByaXZhdGUgY29ubmVjdGlvblN0YXRlOiBDb25uZWN0aW9uU3RhdGUgPSBDb25uZWN0aW9uU3RhdGUuSURMRTtcbiAgcHJpdmF0ZSBjb25uZWN0aW9uUG9sbDogbnVtYmVyIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICBwcml2YXRlIGNvbm5lY3Rpb25Qcm9taXNlOiBQcm9taXNlPENvbm5lY3RSZXNwb25zZT47XG4gIHByaXZhdGUgcmVzb2x2ZUNvbm5lY3Rpb24hOiAodmFsdWU6IENvbm5lY3RSZXNwb25zZSkgPT4gdm9pZDtcbiAgcHJpdmF0ZSByZWplY3RDb25uZWN0aW9uITogKHJlYXNvbjogc3RyaW5nKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgaGFuZHNoYWtlT2JzZXJ2ZXI6IEhhbmRzaGFrZU9ic2VydmVyO1xuICBwcml2YXRlIGFjY2VwdE9ic2VydmVyOiBBY2NlcHRPYnNlcnZlcjtcbiAgcHJpdmF0ZSByZWplY3RPYnNlcnZlcjogUmVqZWN0T2JzZXJ2ZXI7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBtZXNzZW5nZXI6IElVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwLCBTb3VyY2VUPixcbiAgICBwcml2YXRlIHRhcmdldDogSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXI8T3V0Z29pbmdEYXRhTWFwLCBTb3VyY2VUPixcbiAgICBwcml2YXRlIHNvdXJjZTogU291cmNlVFxuICApIHtcbiAgICBjbGFzcyBDb25uZWN0b3JGYWNhZGUge1xuICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSBjb25uZWN0b3I6IENvbm5lY3RvcjxTb3VyY2VUPikge31cbiAgICAgIHB1YmxpYyBoYW5kc2hha2UoKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdG9yLmhhbmRzaGFrZSgpO1xuICAgICAgfVxuICAgICAgcHVibGljIGFjY2VwdChzb3VyY2VJZDogbnVtYmVyLCBzY3JpcHRVcmw6IHN0cmluZywgc2VyaWFsaXplZEludGVyZmFjZTogRGljdCwgdGFyZ2V0SWQ6IG51bWJlciwgdGFyZ2V0T3JpZ2luOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0b3IuYWNjZXB0KHNvdXJjZUlkLCBzY3JpcHRVcmwsIHNlcmlhbGl6ZWRJbnRlcmZhY2UsIHRhcmdldElkLCB0YXJnZXRPcmlnaW4pO1xuICAgICAgfVxuICAgICAgcHVibGljIHJlamVjdChyZWFzb246IHN0cmluZykge1xuICAgICAgICB0aGlzLmNvbm5lY3Rvci5yZWplY3QocmVhc29uKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBjb25uZWN0b3JGYWNhZGUgPSBuZXcgQ29ubmVjdG9yRmFjYWRlKHRoaXMpO1xuXG4gICAgdGhpcy5oYW5kc2hha2VPYnNlcnZlciA9IG5ldyBIYW5kc2hha2VPYnNlcnZlcihjb25uZWN0b3JGYWNhZGUpO1xuICAgIHRoaXMuYWNjZXB0T2JzZXJ2ZXIgPSBuZXcgQWNjZXB0T2JzZXJ2ZXIoY29ubmVjdG9yRmFjYWRlKTtcbiAgICB0aGlzLnJlamVjdE9ic2VydmVyID0gbmV3IFJlamVjdE9ic2VydmVyKGNvbm5lY3RvckZhY2FkZSk7XG4gICAgdGhpcy5jb25uZWN0aW9uUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgdGhpcy5yZXNvbHZlQ29ubmVjdGlvbiA9IHJlcztcbiAgICAgIHRoaXMucmVqZWN0Q29ubmVjdGlvbiA9IHJlajtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBjb25uZWN0KHZlcnNpb246IHN0cmluZywgb3B0aW9uczogUGFydGlhbDxDb25uZWN0T3B0aW9ucz4gPSB7fSk6IFByb21pc2U8Q29ubmVjdFJlc3BvbnNlPiB7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvblN0YXRlID09PSBDb25uZWN0aW9uU3RhdGUuSURMRSkge1xuICAgICAgdGhpcy5jb25uZWN0aW9uU3RhdGUgPSBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVElORztcbiAgICAgIHRoaXMubWVzc2VuZ2VyLmFkZE9ic2VydmVyKHRoaXMuaGFuZHNoYWtlT2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5tZXNzZW5nZXIuYWRkT2JzZXJ2ZXIodGhpcy5hY2NlcHRPYnNlcnZlcik7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5hZGRPYnNlcnZlcih0aGlzLnJlamVjdE9ic2VydmVyKTtcbiAgICAgIC8vIFRPRE86IGZpZ3VyZSBvdXQgYSBiZXR0ZXIgd2F5IHRvIGVuc3VyZSBjb25uZWN0aW9uXG4gICAgICB0aGlzLmNvbm5lY3Rpb25Qb2xsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgLy8gc2VuZCB0aGUgbWVzc2FnZSB0byBhbnlib2R5IHdobydzIGxpc3RlbmluZyB3aXRoaW4gdGhlIHRhcmdldCB3aW5kb3dcbiAgICAgICAgdGhpcy5tZXNzZW5nZXIuc2VuZChuZXcgQ29ubmVjdE1lc3NhZ2UodmVyc2lvbiwgb3B0aW9ucyksIEFOWV9UQVJHRVQsIHRoaXMudGFyZ2V0LCB0aGlzLnNvdXJjZSk7XG4gICAgICB9LCA1MDApO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb25Qcm9taXNlO1xuICB9XG5cbiAgcHVibGljIGNhbmNlbENvbm5lY3RpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvblN0YXRlIDwgQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RFRCkge1xuICAgICAgdGhpcy5zdG9wQ29ubmVjdFBvbGxpbmcoKTtcbiAgICAgIHRoaXMucmVqZWN0Q29ubmVjdGlvbignVXNlciBtYW51YWxseSBjYW5jZWxsZWQgY29ubmVjdGlvbicpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgaGFuZHNoYWtlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA8IENvbm5lY3Rpb25TdGF0ZS5IQU5EU0hBS0UpIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkhBTkRTSEFLRTtcbiAgICAgIHRoaXMuc3RvcENvbm5lY3RQb2xsaW5nKCk7XG5cbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMuaGFuZHNoYWtlT2JzZXJ2ZXIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYWNjZXB0KHNvdXJjZUlkOiBudW1iZXIsIHNjcmlwdFVybDogc3RyaW5nLCBzZXJpYWxpemVkSW50ZXJmYWNlOiBEaWN0LCB0YXJnZXRJZDogbnVtYmVyLCB0YXJnZXRPcmlnaW46IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA8IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNURUQpIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RFRDtcblxuICAgICAgdGhpcy5tZXNzZW5nZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcy5oYW5kc2hha2VPYnNlcnZlcik7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLmFjY2VwdE9ic2VydmVyKTtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMucmVqZWN0T2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5zdG9wQ29ubmVjdFBvbGxpbmcoKTtcblxuICAgICAgdGhpcy5yZXNvbHZlQ29ubmVjdGlvbih7XG4gICAgICAgIHNvdXJjZUlkLFxuICAgICAgICB0YXJnZXRJZCxcbiAgICAgICAgdGFyZ2V0T3JpZ2luLFxuICAgICAgICBzY3JpcHRVcmwsXG4gICAgICAgIHNlcmlhbGl6ZWRJbnRlcmZhY2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHJlamVjdChyZWFzb246IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA8IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNURUQpIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLlJFSkVDVEVEO1xuXG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLmhhbmRzaGFrZU9ic2VydmVyKTtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMuYWNjZXB0T2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5tZXNzZW5nZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcy5yZWplY3RPYnNlcnZlcik7XG4gICAgICB0aGlzLnN0b3BDb25uZWN0UG9sbGluZygpO1xuXG4gICAgICB0aGlzLnJlamVjdENvbm5lY3Rpb24ocmVhc29uKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0b3BDb25uZWN0UG9sbGluZygpOiB2b2lkIHtcbiAgICBjbGVhckludGVydmFsKHRoaXMuY29ubmVjdGlvblBvbGwpO1xuICAgIHRoaXMuY29ubmVjdGlvblBvbGwgPSB1bmRlZmluZWQ7XG4gIH1cblxufVxuIiwiaW1wb3J0IHR5cGUgeyBJTWVzc2FnZSB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IENvbm5lY3RPcHRpb25zIH0gZnJvbSAnQHNkay90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IENvbm5lY3RQYXlsb2FkLCBPdXRnb2luZ0RhdGFNYXB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBPdXRnb2luZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxuZXhwb3J0IGNsYXNzIENvbm5lY3RNZXNzYWdlIGltcGxlbWVudHMgSU1lc3NhZ2U8T3V0Z29pbmdNZXNzYWdlVHlwZS5DT05ORUNULCBPdXRnb2luZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IHR5cGUgPSBPdXRnb2luZ01lc3NhZ2VUeXBlLkNPTk5FQ1Q7XG4gIHB1YmxpYyByZWFkb25seSBwYXlsb2FkOiBDb25uZWN0UGF5bG9hZDtcblxuICBjb25zdHJ1Y3Rvcihib290c3RyYXBWZXJzaW9uOiBzdHJpbmcsIG9wdGlvbnM6IFBhcnRpYWw8Q29ubmVjdE9wdGlvbnM+ID0ge30pIHtcbiAgICB0aGlzLnBheWxvYWQgPSB7XG4gICAgICBib290c3RyYXBWZXJzaW9uLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBhdXRoOiBvcHRpb25zLmF1dGgsXG4gICAgICAgIHByb3ZpZGVyOiBvcHRpb25zLnByb3ZpZGVyLFxuICAgICAgICBzZGtUeXBlOiBvcHRpb25zLnNka1R5cGUsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgQ2xpZW50SW5mbywgSU1lc3NhZ2VPYnNlcnZlciB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IEluY29taW5nRGF0YU1hcCwgSGFuZHNoYWtlUGF5bG9hZCB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBIYW5kc2hha2VSZWNlaXZlciB7XG4gIGhhbmRzaGFrZSgpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgSGFuZHNoYWtlT2JzZXJ2ZXIgaW1wbGVtZW50cyBJTWVzc2FnZU9ic2VydmVyPEluY29taW5nTWVzc2FnZVR5cGUuSEFORFNIQUtFLCBJbmNvbWluZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IG1lc3NhZ2VUeXBlID0gSW5jb21pbmdNZXNzYWdlVHlwZS5IQU5EU0hBS0U7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVjZWl2ZXI6IEhhbmRzaGFrZVJlY2VpdmVyKSB7IH1cblxuICBwdWJsaWMgbm90aWZ5KF9oYW5kc2hha2U6IEhhbmRzaGFrZVBheWxvYWQsIF9jbGllbnRJbmZvOiBDbGllbnRJbmZvLCBfdGltZXN0YW1wOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnJlY2VpdmVyLmhhbmRzaGFrZSgpO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IENsaWVudEluZm8sIElNZXNzYWdlT2JzZXJ2ZXIgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBJbmNvbWluZ0RhdGFNYXAsIEFjY2VwdFBheWxvYWQgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgSW5jb21pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbnR5cGUgRGljdDxUID0gdW5rbm93bj4gPSBSZWNvcmQ8c3RyaW5nLCBUIHwgdW5kZWZpbmVkPjtcblxuZXhwb3J0IGludGVyZmFjZSBBY2NlcHRSZWNlaXZlciB7XG4gIGFjY2VwdChzb3VyY2VJZDogbnVtYmVyLCBzY3JpcHRVcmw6IHN0cmluZywgc2VyaWFsaXplZEludGVyZmFjZTogRGljdCwgdGFyZ2V0SWQ6IG51bWJlciwgdGFyZ2V0T3JpZ2luOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgQWNjZXB0T2JzZXJ2ZXIgaW1wbGVtZW50cyBJTWVzc2FnZU9ic2VydmVyPEluY29taW5nTWVzc2FnZVR5cGUuQUNDRVBULCBJbmNvbWluZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IG1lc3NhZ2VUeXBlID0gSW5jb21pbmdNZXNzYWdlVHlwZS5BQ0NFUFQ7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVjZWl2ZXI6IEFjY2VwdFJlY2VpdmVyKSB7fVxuXG4gIHB1YmxpYyBub3RpZnkoYWNjZXB0OiBBY2NlcHRQYXlsb2FkLCBfY2xpZW50SW5mbzogQ2xpZW50SW5mbywgX3RpbWVzdGFtcDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgeyBzb3VyY2VJZCwgc2NyaXB0VXJsLCB0YXJnZXRJZCwgdGFyZ2V0T3JpZ2luIH0gPSBhY2NlcHQ7XG4gICAgY29uc3Qgc2VyaWFsaXplZEludGVyZmFjZSA9IGFjY2VwdC5pbnRlcmZhY2U7IC8vIGNhbid0IGJlIGRlc3RydWN0dXJlZCBiZWNhdXNlIGBpbnRlcmZhY2VgIGlzIGEgcmVzZXJ2ZWQgd29yZFxuXG4gICAgdGhpcy5yZWNlaXZlci5hY2NlcHQoc291cmNlSWQsIHNjcmlwdFVybCwgc2VyaWFsaXplZEludGVyZmFjZSwgdGFyZ2V0SWQsIHRhcmdldE9yaWdpbik7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgQ2xpZW50SW5mbywgSU1lc3NhZ2VPYnNlcnZlciB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IEluY29taW5nRGF0YU1hcCwgUmVqZWN0UGF5bG9hZCB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBSZWplY3RSZWNlaXZlciB7XG4gIHJlamVjdChyZWFzb246IHN0cmluZyk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBSZWplY3RPYnNlcnZlciBpbXBsZW1lbnRzIElNZXNzYWdlT2JzZXJ2ZXI8SW5jb21pbmdNZXNzYWdlVHlwZS5SRUpFQ1QsIEluY29taW5nRGF0YU1hcD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgbWVzc2FnZVR5cGUgPSBJbmNvbWluZ01lc3NhZ2VUeXBlLlJFSkVDVDtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWNlaXZlcjogUmVqZWN0UmVjZWl2ZXIpIHt9XG5cbiAgcHVibGljIG5vdGlmeShyZWplY3Q6IFJlamVjdFBheWxvYWQsIF9jbGllbnRJbmZvOiBDbGllbnRJbmZvLCBfdGltZXN0YW1wOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnJlY2VpdmVyLnJlamVjdChyZWplY3QucmVhc29uKTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBJbmRleEtleSB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gdXNlIGluIHBsYWNlIG9mIGEgY2FsbGJhY2tcbiAqIEF2b2lkcyBpc3N1ZXMgd2l0aCB1bmJvdW5kIGZ1bmN0aW9uc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElPYnNlcnZlcjxUIGV4dGVuZHMgdW5rbm93bltdPiB7XG4gIG5vdGlmeSguLi5kYXRhOiBUKTogdm9pZDtcbn1cblxuLyoqXG4gKiBJbmZvcm1hdGlvbiBhYm91dCBhIGNsaWVudCBzZW5kaW5nIG1lc3NhZ2VzXG4gKi9cbmV4cG9ydCB0eXBlIENsaWVudEluZm8gPSB7XG4gIGlkOiBudW1iZXI7XG59XG5cbi8qKlxuICogQW4gb2JzZXJ2ZXIgYXNzb2NpYXRlZCB3aXRoIGEgc3BlY2lmaWMgdHlwZSBvZiBtZXNzYWdlXG4gKiBOb3RpZmllZCBvZiBpbmNvbWluZyBtZXNzYWdlcyBvZiB0eXBlIGBJbmNvbWluZ01lc3NhZ2VUeXBlYFxuICpcbiAqIEBwYXJhbSBJbmNvbWluZ01lc3NhZ2VUeXBlIFRoZSBtZXNzYWdlIHR5cGUgdG8gbGlzdGVuIGZvclxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgQSBtYXAgYmV0d2VlbiBJbmNvbWluZ01lc3NhZ2VUeXBlIGFuZCBkYXRhIHJlY2VpdmVkIGFuZCB1c2VkIHdpdGhpbiBgbm90aWZ5YFxuICovXG5leHBvcnQgaW50ZXJmYWNlIElNZXNzYWdlT2JzZXJ2ZXI8XG4gIEluY29taW5nTWVzc2FnZVR5cGUgZXh0ZW5kcyBrZXlvZiBJbmNvbWluZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuICBDbGllbnRJbmZvVCBleHRlbmRzIENsaWVudEluZm8gPSBDbGllbnRJbmZvLFxuPiB7XG4gIC8qKiBUaGUgbWVzc2FnZSB0eXBlIHRvIGxpc3RlbiBmb3IgKi9cbiAgcmVhZG9ubHkgbWVzc2FnZVR5cGU6IEluY29taW5nTWVzc2FnZVR5cGU7XG4gIC8qKiBBIGNhbGxiYWNrIGNhbGxlZCB3aGVuIGFuIElNZXNzYWdlIHJlY2VpdmVzIGFuIGBJbmNvbWluZ01lc3NhZ2VUeXBlYCBtZXNzYWdlICovXG4gIG5vdGlmeShwYXlsb2FkOiBJbmNvbWluZ0RhdGFNYXBUW0luY29taW5nTWVzc2FnZVR5cGVdLCBjbGllbnRJbmZvOiBDbGllbnRJbmZvVCwgc2VudEF0VGltZXN0YW1wOiBudW1iZXIpOiB2b2lkO1xufVxuXG4vKipcbiAqIEEgZmFjdG9yeSB0byBjcmVhdGUgSU1lc3NlbmdlcnNcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIElNZXNzZW5nZXJGYWN0b3J5PE91dGdvaW5nRGF0YU1hcFQsSW5jb21pbmdEYXRhTWFwVD4ge1xuICAvKipcbiAgICogQ3JlYXRlIGFuIElNZXNzZW5nZXIgdGhhdCBjYW4gc2VuZCBgT3V0Z29pbmdEYXRhTWFwVGAgYW5kIGNhbiByZWNlaXZlIGBJbmNvbWluZ0RhdGFNYXBUYFxuICAgKi9cbiAgY3JlYXRlTWVzc2VuZ2VyKCk6IElNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD47XG59XG5cbi8qKlxuICogQSBiaS1kaXJlY3Rpb25hbCBjb21tdW5pY2F0b3IgdGhhdCBjYW5cbiAqIC0gcmVjZWl2ZSBtZXNzYWdlIG9mIHR5cGUgYGtleW9mIEluY29taW5nRGF0YU1hcFRgIHZpYSBvYnNlcnZlcnNcbiAqIC0gc2VuZCBtZXNzYWdlcyBvZiB0eXBlIGBrZXlvZiBPdXRnb2luZ0RhdGFNYXBUYFxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NlbmdlcjxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbj4ge1xuICAvKiogdGVhciBkb3duIHRoaXMgbWVzc2VuZ2VyICovXG4gIGluaXQoKTogdm9pZDtcbiAgLyoqIHRlYXIgZG93biB0aGlzIG1lc3NlbmdlciAqL1xuICBkaXNwb3NlKCk6IHZvaWQ7XG4gIC8qKiBSZWdpc3RlciBhbiBgb2JzZXJ2ZXJgIHRvIGxpc3RlbiBmb3IgaW5jb21pbmcgbWVzc2FnZXMgKi9cbiAgYWRkT2JzZXJ2ZXIob2JzZXJ2ZXI6IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZDtcbiAgLyoqIFJlbW92ZSBhbiBgb2JzZXJ2ZXJgIGZyb20gbGlzdGVuaW5nIHRvIGluY29taW5nIG1lc3NhZ2VzICovXG4gIHJlbW92ZU9ic2VydmVyKG9ic2VydmVyOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQ7XG4gIC8qKiBTZW5kIGEgYG1lc3NhZ2VgIHRvIHRoZSB0YXJnZXQgKi9cbiAgc2VuZChtZXNzYWdlOiBJTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4pOiB2b2lkO1xufVxuXG4vKipcbiAqIEEgYnJpZGdlIGJldHdlZW4gYSBtZXNzZW5nZXIgYW5kIHRoZSB1bmRlcmx5aW5nIG1lc3NlbmdpbmcgbWVjaGFuaXNtLCBhbGxvd2luZyB0aGUgbWVzc2VuZ2VyIHRvIGJlIG1vcmUgZ2VuZXJpY1xuICogVXNlZnVsIGluIGFic3RyYWN0aW5nIGF3YXkgc29tZXRoaW5nIGxpa2Ugd2luZG93LnBvc3RNZXNzYWdlIGZyb20gYW4gYElNZXNzZW5nZXJgXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWQgYnkgcmVnaXN0ZXJlZCBvYnNlcnZlcnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJTWVzc2VuZ2VyQnJpZGdlPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuPiB7XG4gIC8qKiBUdXJuIG9uIHRoZSBhYmlsaXR5IHRvIHJlY2VpdmUgbWVzc2FnZXMgZnJvbSBhbm90aGVyIGNsaWVudCAqL1xuICBsaXN0ZW4ob2JzZXJ2ZXI6IElPYnNlcnZlcjxbSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBDbGllbnRJbmZvXT4pOiB2b2lkO1xuICAvKiogVHVybiBvZmYgdGhlIGFiaWxpdHkgdG8gcmVjZWl2ZSBtZXNzYWdlcyAqL1xuICBzdG9wTGlzdGVuaW5nKCk6IHZvaWQ7XG4gIC8qKiBTZW5kIG1lc3NhZ2UgdG8gdGhlIGFub3RoZXIgY2xpZW50ICovXG4gIHNlbmQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+KTogdm9pZDtcbn1cblxuLyoqXG4gKiBBIGJpLWRpcmVjdGlvbmFsIGNvbW11bmljYXRvciB0aGF0IGNhblxuICogLSBvcGVubHkgcmVjZWl2ZSBtZXNzYWdlcyBvZiB0eXBlIGBrZXlvZiBJbmNvbWluZ0RhdGFNYXBUYCB2aWEgb2JzZXJ2ZXJzIGZyb20gdW5zcGVjaWZpZWQgc291cmNlc1xuICogLSBzZW5kIG1lc3NhZ2VzIG9mIHR5cGUgYGtleW9mIE91dGdvaW5nRGF0YU1hcFRgIHRvIHRhcmdldHMgc3BlY2lmaWVkIHdoZW4gc2VuZGluZ1xuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkIGJ5IHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVVuZGlyZWN0ZWRNZXNzZW5nZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFQsXG4gIFNvdXJjZVQsXG4+IHtcbiAgLyoqIFJlZ2lzdGVyIGFuIGBvYnNlcnZlcmAgdG8gbGlzdGVuIGZvciBpbmNvbWluZyBtZXNzYWdlcyAqL1xuICBhZGRPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkO1xuICAvKiogUmVtb3ZlIGFuIGBvYnNlcnZlcmAgZnJvbSBsaXN0ZW5pbmcgdG8gaW5jb21pbmcgbWVzc2FnZXMgKi9cbiAgcmVtb3ZlT2JzZXJ2ZXIob2JzZXJ2ZXI6IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZDtcbiAgLyoqIFNlbmQgYSBgbWVzc2FnZWAgdG8gdGhlIGB0YXJnZXRgICovXG4gIHNlbmQoXG4gICAgbWVzc2FnZTogSU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+LFxuICAgIHRhcmdldElkOiBudW1iZXIgfCB0eXBlb2YgQU5ZX1RBUkdFVCwgdGFyZ2V0OiBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcjxPdXRnb2luZ0RhdGFNYXBULCBTb3VyY2VUPixcbiAgICBzb3VyY2U6IFNvdXJjZVQsXG4gICk6IHZvaWQ7XG4gIC8qKiBUZWFyIGRvd24gdGhpcyBtZXNzZW5nZXIgKi9cbiAgZGlzcG9zZSgpOiB2b2lkO1xufVxuXG4vKipcbiAqIEEgc3BlY2lhbCBpZCB0byBzeW1ib2xpemUgdGhlIG1lc3NhZ2Ugc2hvdWxkIGdvIHRvIGFsbCBvdGhlciBgSVVuZGlyZWN0ZWRMaXN0ZW5lcnNgLlxuICogRm9yIHVzZSB3aXRoIGBJVW5kaXJlY3RlZE1lc3NlbmdlcmAgYW5kIGBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcmAuXG4gKi9cbmV4cG9ydCBjb25zdCBBTllfVEFSR0VUID0gLTE7XG5cbi8qKlxuICogQSBicmlkZ2UgYmV0d2VlbiBhIG1lc3NlbmdlciBhbmQgdGhlIHVuZGVybHlpbmcgbWVzc2FnZSByZWNlaXZpbmcgbWVjaGFuaXNtLCBhbGxvd2luZyB0aGUgbWVzc2VuZ2VyIHRvIGJlIG1vcmUgZ2VuZXJpY1xuICogVXNlZnVsIGluIGFic3RyYWN0aW5nIGF3YXkgc29tZXRoaW5nIGxpa2Ugd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgZnJvbSBhbiBgSU1lc3NlbmdlcmBcbiAqXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWQgYnkgcmVnaXN0ZXJlZCBvYnNlcnZlcnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyPFxuICBJbmNvbWluZ0RhdGFNYXBULFxuPiB7XG4gIC8qKiBUdXJuIG9uIHRoZSBhYmlsaXR5IHRvIHJlY2VpdmUgbWVzc2FnZXMgZnJvbSBhbm90aGVyIGNsaWVudCAqL1xuICBsaXN0ZW4ob2JzZXJ2ZXI6IElPYnNlcnZlcjxbSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBDbGllbnRJbmZvXT4pOiB2b2lkO1xuICAvKiogVHVybiBvZmYgdGhlIGFiaWxpdHkgdG8gcmVjZWl2ZSBtZXNzYWdlcyAqL1xuICBzdG9wTGlzdGVuaW5nKCk6IHZvaWQ7XG59XG5cbi8qKlxuICogQSBicmlkZ2UgYmV0d2VlbiBhIG1lc3NlbmdlciBhbmQgdGhlIHVuZGVybHlpbmcgbWVzc2FnZSBzZW5kaW5nIG1lY2hhbmlzbSwgYWxsb3dpbmcgdGhlIG1lc3NlbmdlciB0byBiZSBtb3JlIGdlbmVyaWNcbiAqIFVzZWZ1bCBpbiBhYnN0cmFjdGluZyBhd2F5IHNvbWV0aGluZyBsaWtlIHdpbmRvdy5wb3N0TWVzc2FnZSBmcm9tIGFuIGBJTWVzc2VuZ2VyYFxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBTb3VyY2VULFxuPiB7XG4gIC8qKiBTZW5kIG1lc3NhZ2UgdG8gdGhlIGNsaWVudCAqL1xuICBzZW5kKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPiwgc291cmNlOiBTb3VyY2VUKTogdm9pZDtcbn1cblxuLyoqXG4gKiBUaGUgYmFzZSBkYXRhIGZvciBlYWNoIG1lc3NhZ2UgKGJvdGggb3V0Z29pbmcgYW5kIGluY29taW5nKVxuICpcbiAqIEBwYXJhbSBNZXNzYWdlVHlwZSBUaGUgdHlwZSBvZiB0aGUgbWVzc2FnZVxuICogQHBhcmFtIFBheWxvYWRNYXAgVGhlIG1hcCBiZXR3ZWVuIG1lc3NhZ2UgdHlwZXMgYW5kIHRoZWlyIHBheWxvYWRzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NhZ2U8XG4gIE1lc3NhZ2VUeXBlIGV4dGVuZHMga2V5b2YgUGF5bG9hZE1hcFQsXG4gIFBheWxvYWRNYXBULFxuPiB7XG4gIC8qKiBUaGUgc3BlY2lmaWMgdHlwZSBvZiBtZXNzYWdlICovXG4gIHR5cGU6IE1lc3NhZ2VUeXBlO1xuICAvKiogVGhlIGRhdGEgdG8gc2VuZCAqL1xuICBwYXlsb2FkOiBQYXlsb2FkTWFwVFtNZXNzYWdlVHlwZV07XG59XG5cbi8qKlxuICogVGhlIGJhc2UgZGF0YSBmb3IgZWFjaCBsb3dlciBsZXZlbCBtZXNzYWdlIHR5cGVzIGJlaW5nIHJlY2VpdmVkIGJ5IHRoZSBicmlkZ2VzXG4gKlxuICogQHBhcmFtIE1lc3NhZ2VUeXBlIFRoZSB0eXBlIG9mIHRoZSBtZXNzYWdlXG4gKiBAcGFyYW0gUGF5bG9hZE1hcCBUaGUgbWFwIGJldHdlZW4gbWVzc2FnZSB0eXBlcyBhbmQgdGhlaXIgcGF5bG9hZHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJQnJpZGdlTWVzc2FnZTxcbiAgTWVzc2FnZVR5cGUgZXh0ZW5kcyBrZXlvZiBQYXlsb2FkTWFwVCxcbiAgUGF5bG9hZE1hcFQsXG4+IHtcbiAgLyoqIFRoZSBzcGVjaWZpYyB0eXBlIG9mIG1lc3NhZ2UgKi9cbiAgdHlwZTogTWVzc2FnZVR5cGU7XG4gIC8qKiBUaGUgZGF0YSByZWNlaXZlZCAqL1xuICBwYXlsb2FkOiBQYXlsb2FkTWFwVFtNZXNzYWdlVHlwZV07XG4gIC8qKiBUaGUgdGltZXN0YW1wIG9mIHdoZW4gdGhlIG1lc3NhZ2Ugd2FzIHNlbnQgKi9cbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIC8qKiBUaGUgaWQgb2YgdGhlIGNsaWVudCBzZW5kaW5nIHRoZSBtZXNzYWdlICovXG4gIGZyb21JZDogbnVtYmVyO1xuICAvKiogVGhlIGlkIG9mIHRoZSBjbGllbnQgdGhhdCBzaG91bGQgcmVjZWl2ZSB0aGlzIG1lc3NhZ2UgKi9cbiAgdG9JZDogbnVtYmVyIHwgbnVtYmVyW107XG59XG4iLCJpbXBvcnQgeyBQb3N0TWVzc2FnZUZhY3RvcnksIFBvc3RNZXNzYWdlTGlzdGVuZXIsIFBvc3RNZXNzYWdlU2VuZGVyLCBVbmRpcmVjdGVkTWVzc2VuZ2VyIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHtcbiAgSVNka0Nvbm5lY3Rvcn0gZnJvbSAnLi9NUF9TREsnO1xuaW1wb3J0IHtcbiAgTVBfU0RLLFxufSBmcm9tICcuL01QX1NESyc7XG5pbXBvcnQgdHlwZSB7IENvbm5lY3RSZXNwb25zZSB9IGZyb20gJy4vQ29ubmVjdG9yJztcbmltcG9ydCB7IENvbm5lY3RvciB9IGZyb20gJy4vQ29ubmVjdG9yJztcbmltcG9ydCB0eXBlIHsgSW5jb21pbmdEYXRhTWFwLCBPdXRnb2luZ0RhdGFNYXAgfSBmcm9tICcuL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgdHlwZSB7IE1wU2RrLCBDb25uZWN0T3B0aW9ucyB9IGZyb20gJ0BzZGsvdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgdmVyc2lvbiA9ICczLjAnO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3QodGFyZ2V0V2luZG93OiBIVE1MSUZyYW1lRWxlbWVudCwgb3B0aW9uczogUGFydGlhbDxDb25uZWN0T3B0aW9ucz4gPSB7fSk6IFByb21pc2U8TXBTZGs+IHtcbiAgY29uc3QgdGFyZ2V0ID0gZ2V0V2luZG93KHRhcmdldFdpbmRvdyk7XG4gIGlmICghdGFyZ2V0KSByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ2ludmFsaWQgd2luZG93Jyk7XG5cbiAgLy8gY3JlYXRlIGEgd2F5IHRvIGNyZWF0ZSBjb21tdW5pY2F0aW9uIGNoYW5uZWxzIChJTWVzc2FnZSkgYW5kIHNldCB1cCBhIFBvc3RNZXNzYWdlIHRvIHVzZSBmb3IgY29ubmVjdGluZ1xuICBjb25zdCBzb3VyY2VJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApOyAvLyBhIHRlbXAgaWQgdG8gdXNlIHdoaWxlIGNvbm5lY3RpbmdcbiAgY29uc3QgcG9zdE1lc3NhZ2VMaXN0ZW5lciA9IG5ldyBQb3N0TWVzc2FnZUxpc3RlbmVyPEluY29taW5nRGF0YU1hcD4od2luZG93KTtcbiAgY29uc3QgcG9zdE1lc2FnZVNlbmRlciA9IG5ldyBQb3N0TWVzc2FnZVNlbmRlcjxPdXRnb2luZ0RhdGFNYXA+KHRhcmdldCk7XG4gIGNvbnN0IHBvc3RNZXNzYWdlID0gbmV3IFVuZGlyZWN0ZWRNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwLCBJbmNvbWluZ0RhdGFNYXAsIFdpbmRvdz4oc291cmNlSWQsIHBvc3RNZXNzYWdlTGlzdGVuZXIpO1xuICBwb3N0TWVzc2FnZS5pbml0KCk7XG5cbiAgLy8gY29ubmVjdFxuICBjb25zdCBjb25uZWN0b3IgPSBuZXcgQ29ubmVjdG9yPFdpbmRvdz4ocG9zdE1lc3NhZ2UsIHBvc3RNZXNhZ2VTZW5kZXIsIHdpbmRvdyk7XG4gIHJldHVybiBNUF9TREsuY29ubmVjdChuZXcgRW1iZWRDb25uZWN0b3IoY29ubmVjdG9yLCBwb3N0TWVzc2FnZSwgb3B0aW9ucyksIG5ldyBFbWJlZE1lc3NlbmdlckZhY3RvcnlGZXRjaGVyKHRhcmdldCksIHdpbmRvdyk7XG59XG5cbmZ1bmN0aW9uIGdldFdpbmRvdyhlbGVtZW50OiBIVE1MSUZyYW1lRWxlbWVudCk6IFdpbmRvdyB8IG51bGwge1xuICBpZiAoZWxlbWVudC5jb250ZW50V2luZG93KSByZXR1cm4gZWxlbWVudC5jb250ZW50V2luZG93O1xuICByZXR1cm4gbnVsbDtcbn1cblxuY2xhc3MgRW1iZWRDb25uZWN0b3IgaW1wbGVtZW50cyBJU2RrQ29ubmVjdG9yPENvbm5lY3RSZXNwb25zZT4ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGNvbm5lY3RvcjogQ29ubmVjdG9yPFdpbmRvdz4sXG4gICAgcHJpdmF0ZSBwb3N0TWVzc2FnZTogVW5kaXJlY3RlZE1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcCwgV2luZG93PixcbiAgICBwcml2YXRlIG9wdGlvbnM6IFBhcnRpYWw8Q29ubmVjdE9wdGlvbnM+LFxuICApIHt9XG4gIHB1YmxpYyBjb25uZWN0KCkge1xuICAgIHJldHVybiB0aGlzLmNvbm5lY3Rvci5jb25uZWN0KHZlcnNpb24sIHRoaXMub3B0aW9ucyk7XG4gIH1cblxuICBwdWJsaWMgY2FuY2VsQ29ubmVjdGluZygpIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlLmRpc3Bvc2UoKTtcbiAgfVxufVxuXG5jbGFzcyBFbWJlZE1lc3NlbmdlckZhY3RvcnlGZXRjaGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0YXJnZXQ6IFdpbmRvdykge31cbiAgcHVibGljIGdldEZhY3RvcnkoY29ubmVjdFJlc3BvbnNlOiBDb25uZWN0UmVzcG9uc2UpIHtcbiAgICByZXR1cm4gbmV3IFBvc3RNZXNzYWdlRmFjdG9yeShjb25uZWN0UmVzcG9uc2Uuc291cmNlSWQsIHdpbmRvdywgY29ubmVjdFJlc3BvbnNlLnRhcmdldElkLCB0aGlzLnRhcmdldCwgY29ubmVjdFJlc3BvbnNlLnRhcmdldE9yaWdpbik7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NhZ2UgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBIYW5kc2hha2VQYXlsb2FkLCBJbmNvbWluZ0RhdGFNYXB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxuZXhwb3J0IGNsYXNzIEhhbmRzaGFrZU1lc3NhZ2UgaW1wbGVtZW50cyBJTWVzc2FnZTxJbmNvbWluZ01lc3NhZ2VUeXBlLkhBTkRTSEFLRSwgSW5jb21pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlID0gSW5jb21pbmdNZXNzYWdlVHlwZS5IQU5EU0hBS0U7XG4gIHB1YmxpYyByZWFkb25seSBwYXlsb2FkOiBIYW5kc2hha2VQYXlsb2FkO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucGF5bG9hZCA9IHt9O1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IElNZXNzYWdlIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgQWNjZXB0UGF5bG9hZCwgSW5jb21pbmdEYXRhTWFwfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgSW5jb21pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBBY2NlcHRNZXNzYWdlIGltcGxlbWVudHMgSU1lc3NhZ2U8SW5jb21pbmdNZXNzYWdlVHlwZS5BQ0NFUFQsIEluY29taW5nRGF0YU1hcD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgdHlwZSA9IEluY29taW5nTWVzc2FnZVR5cGUuQUNDRVBUO1xuICBwdWJsaWMgcmVhZG9ubHkgcGF5bG9hZDogQWNjZXB0UGF5bG9hZDtcblxuICAvLyBUT09EIChzZGsgMS54IHN1cHBvcnQpOiBTREsgYm9vdHN0cmFwIDEueCBleHBlY3RzIHRoZSBgaW50ZXJmYWNlYCB0byBiZSBhdCB0aGUgcm9vdCBvZiB0aGUgbWVzc2FnZXNcbiAgcHVibGljIGludGVyZmFjZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cbiAgY29uc3RydWN0b3Ioc2NyaXB0VXJsOiBzdHJpbmcsIGNsaWVudEludGVyZmFjZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHNvdXJjZUlkOiBudW1iZXIsIHRhcmdldElkOiBudW1iZXIsIHRhcmdldE9yaWdpbjogc3RyaW5nKSB7XG4gICAgdGhpcy5wYXlsb2FkID0ge1xuICAgICAgc2NyaXB0VXJsLFxuICAgICAgaW50ZXJmYWNlOiBjbGllbnRJbnRlcmZhY2UsXG4gICAgICBzb3VyY2VJZCxcbiAgICAgIHRhcmdldElkLFxuICAgICAgdGFyZ2V0T3JpZ2luLFxuICAgIH07XG4gICAgdGhpcy5pbnRlcmZhY2UgPSBjbGllbnRJbnRlcmZhY2U7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NhZ2UgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBJbmNvbWluZ0RhdGFNYXAsIFJlamVjdFBheWxvYWQgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgSW5jb21pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZWplY3RNZXNzYWdlIGltcGxlbWVudHMgSU1lc3NhZ2U8SW5jb21pbmdNZXNzYWdlVHlwZS5SRUpFQ1QsIEluY29taW5nRGF0YU1hcD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgdHlwZSA9IEluY29taW5nTWVzc2FnZVR5cGUuUkVKRUNUO1xuICBwdWJsaWMgcmVhZG9ubHkgcGF5bG9hZDogUmVqZWN0UGF5bG9hZDtcblxuICAvLyBUT09EIChzZGsgMS54IHN1cHBvcnQpOiBTREsgYm9vdHN0cmFwIDEueCBleHBlY3RzIHRoZSBgcmVhc29uYCB0byBiZSBhdCB0aGUgcm9vdCBvZiB0aGUgbWVzc2FnZXNcbiAgcHVibGljIHJlYXNvbjogc3RyaW5nO1xuICBjb25zdHJ1Y3RvcihyZWFzb246IHN0cmluZykge1xuICAgIHRoaXMucGF5bG9hZCA9IHtcbiAgICAgIHJlYXNvbixcbiAgICB9O1xuICAgIHRoaXMucmVhc29uID0gcmVhc29uO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IENsaWVudEluZm8sIElNZXNzYWdlT2JzZXJ2ZXIgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBPdXRnb2luZ0RhdGFNYXAsIENvbm5lY3RQYXlsb2FkIH0gZnJvbSAnQHNkay9ib290c3RyYXAnO1xuaW1wb3J0IHsgT3V0Z29pbmdNZXNzYWdlVHlwZSB9IGZyb20gJ0BzZGsvYm9vdHN0cmFwJztcblxuLyoqXG4gKiBBbiBvYnNlcnZlciB0aGF0IHJlY2VpdmVzIGBDb25uZWN0UGF5bG9hZGAgb2JqZWN0cyBpbiBpdHMgYG9uQ29ubmVjdGlvblJlY2VpdmVkYCBjYWxsYmFja1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElDb25uZWN0T2JzZXJ2ZXI8VCBleHRlbmRzIENsaWVudEluZm8+IHtcbiAgb25Db25uZWN0aW9uUmVjZWl2ZWQoY29ubmVjdDogQ29ubmVjdFBheWxvYWQsIGNsaWVudEluZm86IFQpOiB2b2lkO1xufVxuXG4vKipcbiAqIEFuIGFkYXB0b3IgdG8gbWFrZSBhbiBgSUNvbm5lY3RPYnNlcnZlcmAgbG9vayBsaWtlIGFuIGBJTWVzc2FnZU9ic2VydmVyYCAod2l0aCBhIGBub3RpZnlgIGZ1bmN0aW9uKVxuICogQ2FsbHMgdGhlIGlucHV0IG9iamVjdCdzIGBvbkNvbm5lY3Rpb25SZWNlaXZlZGAgd2hlbiBhIGBDT05ORUNUYCBtZXNzYWdlIGlzIHJlY2VpdmVkIG9uIHRoZSBgSU1lc3NlbmdlcmAgdGhpcyBpcyByZWdpc3RlcmVkIHdpdGguXG4gKi9cbmV4cG9ydCBjbGFzcyBDb25uZWN0TWVzc2FnZU9ic2VydmVyPFQgZXh0ZW5kcyBDbGllbnRJbmZvPiBpbXBsZW1lbnRzIElNZXNzYWdlT2JzZXJ2ZXI8T3V0Z29pbmdNZXNzYWdlVHlwZS5DT05ORUNULCBPdXRnb2luZ0RhdGFNYXAsIFQ+IHtcbiAgcHVibGljIHJlYWRvbmx5IG1lc3NhZ2VUeXBlID0gT3V0Z29pbmdNZXNzYWdlVHlwZS5DT05ORUNUO1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlY2VpdmVyOiBJQ29ubmVjdE9ic2VydmVyPFQ+KSB7fVxuXG4gIHB1YmxpYyBub3RpZnkoY29ubmVjdDogQ29ubmVjdFBheWxvYWQsIGNsaWVudEluZm86IFQpOiB2b2lkIHtcbiAgICB0aGlzLnJlY2VpdmVyLm9uQ29ubmVjdGlvblJlY2VpdmVkKGNvbm5lY3QsIGNsaWVudEluZm8pO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9